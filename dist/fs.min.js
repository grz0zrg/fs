var WUI_Dialog=new function(){"use strict";var e=this,t={},n=null,i=null,r=null,o=0,l=0,s=0,a=0,c=null,u=[],d="wui-dialog",f="wui-dialog-content",h="wui-dialog-btn",p="wui-dialog-close",g="wui-dialog-detach",m="wui-dialog-minimized",v="wui-dialog-minimize",y="wui-dialog-maximize",w="wui-dialog-header",b="wui-dialog-open",x="wui-dialog-closed",L="wui-dialog-draggable",C="wui-dialog-transition",S="wui-dialog-dim-transition",k="wui-dialog-modal",E="wui-dialog-status-bar",T={title:"",width:"80%",height:"40%",open:!0,closable:!0,minimizable:!1,draggable:!1,resizable:!1,detachable:!1,min_width:"title",min_height:32,status_bar:!1,status_bar_content:"",keep_align_when_resized:!1,halign:"left",valign:"top",top:0,left:0,modal:!1,minimized:!1,on_close:null,on_detach:null,on_resize:null};Element.prototype._addEventListener||(Element.prototype._addEventListener=Element.prototype.addEventListener,Element.prototype.addEventListener=function(e,t,n){this._addEventListener(e,t,n),this.eventListenerList||(this.eventListenerList={}),this.eventListenerList[e]||(this.eventListenerList[e]=[]),this.eventListenerList[e].push(t)},Element.prototype._removeEventListener=Element.prototype.removeEventListener,Element.prototype.removeEventListener=function(e,t,n){if(this.eventListenerList){var i,r=this.eventListenerList[e];if(r)for(i=0;i<r.length;i+=1)if(r[i]===t){r.splice(i,1);break}}this._removeEventListener(e,t,n)});var _=function(e,n,i,r){var o,l,s,a,c=t[e.id];if(c){if(n&&c.detachable_ref&&(c.detachable_ref.closed||c.detachable_ref.close(),function(e){for(var t=0;t<u.length;t+=1)if(u[t]===e.detachable_ref){u.splice(t,1);break}}(c)),r&&c.modal_element)for(document.body.removeChild(c.modal_element),l=0;l<u.length;l+=1)for(o=(a=u[l]).document.body.getElementsByClassName(k),s=0;s<o.length;s+=1)a.document.body.removeChild(o[s]);c.dialog.classList.contains(b)&&(e.classList.add(x),e.classList.remove(b),i&&null!==c.opts.on_close&&c.opts.on_close())}},M=function(e){var n=null,i=null,r=t[e.id];if(!r.opts.modal){for(var o in t)t.hasOwnProperty(o)&&(n=t[o].dialog,isNaN(n.style.zIndex)||parseInt(n.style.zIndex,10)>100&&(n.style.zIndex=100));for(i=r.dialog.parentElement;null!==i;)i.classList.contains(d)&&(i.style.zIndex=101),i=i.parentElement;e.style.zIndex=101}},A=function(e){var t=document.createElement("div");return t.className="wui-dialog-modal",t.addEventListener("click",function(t){t.preventDefault(),_(e,!0,!0,!0)}),t.style.zIndex=16777270,t},N=function(e){var n=t[e.id].opts,i=e.parentElement.offsetWidth,r=e.parentElement.offsetHeight,o=e.offsetWidth,l=e.offsetHeight;"center"===n.halign?e.style.left=Math.round((i-o)/2+n.left)+"px":"right"===n.halign?e.style.left=i-o+n.left+"px":e.style.left=n.left+"px","center"===n.valign?e.style.top=Math.round((r-l)/2+n.top)+"px":"bottom"===n.valign?e.style.top=r-l+n.top+"px":e.style.top=n.top+"px"},W=function(e,n){var i=t[n.id],r=i.resize_handler;i.dialog!==n&&W(i.header_minimaxi_btn,i.dialog),e.classList.toggle(v),e.classList.toggle(y),n.classList.toggle(m),n.classList.contains(m)?(n.style.borderStyle="solid",n.style.borderColor="#808080",n.style.borderWidth="1px"):(n.style.borderStyle="",n.style.borderColor="",n.style.borderWidth=""),r&&r.classList.toggle(b),i.status_bar&&i.status_bar.classList.toggle(b)},D=function(e){null===c&&(c=setTimeout(function(){c=null;var n,i,r,o,l,s,a=document;if(e)for(n=(a=e.document).getElementsByClassName(f),s=0;s<n.length;s+=1)o=(r=n[s]).parentElement,i=t[o.id],o.getElementsByClassName(E).length>0?r.style.height=e.innerHeight-32+"px":r.style.height=e.innerHeight+"px",l=r.getBoundingClientRect(),i.opts.on_resize&&i.opts.on_resize(l.width,l.height);else for(n=a.getElementsByClassName(f),s=0;s<n.length;s+=1)(o=(r=n[s]).parentElement).getElementsByClassName(E).length>0?r.style.height=o.offsetHeight-64+"px":r.style.height=o.offsetHeight-32+"px",N(o),l=r.getBoundingClientRect(),(i=t[o.id]).opts.on_resize&&i.opts.on_resize(l.width,l.height)},125))},O=function(e,t){var n,i;do{if(1==e.nodeType&&e.eventListenerList)for(n in e.eventListenerList)if("length"!==n&&e.eventListenerList.hasOwnProperty(n))for(i=0;i<e.eventListenerList[n].length;i+=1)t.addEventListener(n,e.eventListenerList[n][i],!1);e.hasChildNodes()&&O(e.firstChild,t.firstChild),e=e.nextSibling,t=t.nextSibling}while(e&&t)},I=function(e){var n,i,r,o,l,s,a,c=t[e.id],d=e.firstElementChild.firstElementChild.firstElementChild,f=d.textContent||d.innerText||"",h=c.detachable_ref,p=e.getBoundingClientRect();for(e.classList.contains(m)?(n=parseInt(e.style.width,10),i=parseInt(e.style.height,10)-32):(n=p.width,i=p.height-32),r=void 0!==window.screenLeft?window.screenLeft:screen.left,o=void 0!==window.screenTop?window.screenTop:screen.top,_(e,!0,!1,!1),h=window.open("",f,["toolbar=no","location=no","directories=no","status=no","menubar=no","scrollbars=yes","resizable=yes","width="+n,"height="+i,"top="+(p.top+o+32),"left="+(p.left+r)].join(",")),c.detachable_ref=h,s="",l=document.head.getElementsByTagName("link"),a=0;a<l.length;a+=1)"text/css"===l[a].type&&"stylesheet"===l[a].rel&&(s+=l[a].outerHTML);for(l=document.head.getElementsByTagName("style"),a=0;a<l.length;a+=1)s+=l[a].outerHTML;h.document.open(),h.document.write(["<html>","<head>","<title>"+f+"</title>",s,"</head>",'<body id="'+e.id+'" class="wui-dialog-detach-window-body" onload="parent.opener.WUI_Dialog.childWindowLoaded(document.body.id)">',"</body>","</html>"].join("")),h.document.close(),h.document.body.appendChild(e.children[1].cloneNode(!0));var g=e.getElementsByClassName(E);if(g.length>0){var v=g[0].cloneNode(!0);v.classList.add(b),h.document.body.appendChild(v)}h.addEventListener("keyup",function(t){27===t.keyCode&&_(e,!0,!0,!0)},!1),h.addEventListener("resize",function(){D(h)},!1),h.addEventListener("beforeunload",function(){_(e,!0,!0,!0)},!1),u.push(h)},H=function(e){e.preventDefault();var t=e.target,n=null;t.classList.contains(p)?(n=t.parentElement.parentElement,_(n,!1,!0,!0)):t.classList.contains(y)||t.classList.contains(v)?(n=t.parentElement.parentElement,W(t,n)):t.classList.contains(g)&&(n=t.parentElement.parentElement,I(n))},z=function(e){if(n){e.preventDefault();var i,s,a,c=t[n.id],u=e.clientX,d=e.clientY,f=e.changedTouches;if(f)for(i=0;i<f.length;i+=1)if(f[i].identifier===r){u=f[i].clientX,d=f[i].clientY;break}s=u-o,a=d-l,n.style.left=s+"px",n.style.top=a+"px",c.dialog!==n&&(c.dialog.style.left=s+"px",c.dialog.style.top=a+"px")}},P=function(e){if(n){var t,i=e.changedTouches,o=n.ownerDocument,l=o.defaultView||o.parentWindow;if(i){for(t=0;t<i.length;t+=1)if(i[t].identifier===r){n=null,o.body.style.cursor="default",l.removeEventListener("touchmove",z,!1),l.removeEventListener("touchend",P,!1);break}}else n=null,o.body.style.cursor="default",l.removeEventListener("mousemove",z,!1),l.removeEventListener("mouseup",P,!1)}},B=function(e){var t,i,s,a,c,u=e.clientX,d=e.clientY,f=e.changedTouches;if(e.preventDefault(),null===n)if(f)r=f[0].identifier,u=f[0].clientX,d=f[0].clientY;else if(0!==e.button)return;!(c=e.target.parentElement).classList.contains(y)&&c.classList.contains(L)&&(a=(s=(n=c).ownerDocument).defaultView||s.parentWindow,M(n),s.body.style.cursor="move",t=parseInt(n.style.left,10),i=parseInt(n.style.top,10),o=u-t,l=d-i,a.addEventListener("mousemove",z,!1),a.addEventListener("touchmove",z,!1),a.addEventListener("mouseup",P,!1),a.addEventListener("touchend",P,!1))},R=function(e){e.preventDefault(),e.stopPropagation();var t=e.target.parentElement,n=t.offsetLeft,o=t.offsetTop,l=e.changedTouches,c=t.ownerDocument,u=c.defaultView||c.parentWindow;l&&(r=l[0].identifier),s=n,a=o,t.classList.remove(S),u.addEventListener("mousemove",F,!1),u.addEventListener("touchmove",F,!1),u.addEventListener("mouseup",U,!1),u.addEventListener("touchend",U,!1),i=t},F=function(e){e.preventDefault();var n,o,l,c,u=e.clientX,d=e.clientY,h=e.changedTouches,p=t[i.id],g=0,v=0;if(h)for(g=0;g<h.length;g+=1)if(h[g].identifier===r){u=h[g].clientX,d=h[g].clientY;break}for(l=u-s,c=d-a,o=i.firstElementChild.firstElementChild.firstElementChild.offsetWidth+148,"title"===p.opts.min_width&&l<o?l=o:l<p.opts.min_width&&(l=p.opts.min_width),p.opts.status_bar&&(v=32),c<p.opts.min_height+v&&(c=p.opts.min_height+v),i.style.width=l+"px",i.classList.contains(m)||(i.style.height=c+"px"),n=i.getElementsByClassName(f),g=0;g<n.length;g+=1){var y,w=n[g],b=t[w.parentElement.id];w.style.height=i.offsetHeight-32-v+"px",y=w.getBoundingClientRect(),b.opts.on_resize&&b.opts.on_resize(y.width,y.height),p.opts.keep_align_when_resized&&N(i)}},U=function(e){var t=i.ownerDocument,n=t.defaultView||t.parentWindow;e.preventDefault(),i.classList.add(S),n.removeEventListener("mousemove",F,!1),n.removeEventListener("touchmove",F,!1),n.removeEventListener("mouseup",U,!1),n.removeEventListener("touchend",U,!1),i=null},G=function(){for(var e in t)t.hasOwnProperty(e)&&_(t[e].dialog,!0,!1,!0)};this.create=function(e,n){var i,r={};if(void 0===t[e]){for(i in T)T.hasOwnProperty(i)&&(r[i]=T[i]);if(void 0!==n)for(i in n)n.hasOwnProperty(i)&&void 0!==T[i]&&(r[i]=n[i]);var o=document.getElementById(e),l=document.createElement("div"),s=null,a=null,c=null,u=null,m=null,y=null,k=null;if(null!==o){var _=o.firstElementChild;return null===_&&(_=document.createElement("div"),o.appendChild(_)),o.style.width=r.width,o.style.height=r.height,o.classList.add(d),_.classList.add(f),l.className=w,r.status_bar?_.style.height=o.offsetHeight-64+"px":_.style.height=o.offsetHeight-32+"px",y=document.createElement("div"),m=document.createElement("div"),y.style.display="inline-block",m.className="wui-dialog-title",y.innerHTML=r.title,m.appendChild(y),l.appendChild(m),r.open?o.classList.add(b):o.classList.add(x),r.draggable&&(o.classList.toggle(L),l.addEventListener("mousedown",B,!1),l.addEventListener("touchstart",B,!1)),r.closable&&((c=document.createElement("div")).className=h+" "+p,c.title="Close",l.appendChild(c)),r.minimizable&&((u=document.createElement("div")).className=h+" "+v,r.minimized&&W(u,o),l.appendChild(u)),r.detachable&&((a=document.createElement("div")).className=h+" "+g,a.title="Detach",l.appendChild(a)),r.status_bar&&((k=document.createElement("div")).classList.add(E),k.classList.add(C),k.classList.add(b),k.innerHTML=r.status_bar_content,o.appendChild(k)),l.addEventListener("click",H,!1),l.addEventListener("touchstart",H,!1),window.addEventListener("resize",function(){D(!1)},!1),window.addEventListener("beforeunload",G,!1),o.classList.add(C),o.classList.add(S),o.insertBefore(l,_),r.resizable&&((s=document.createElement("div")).addEventListener("mousedown",R,!1),s.addEventListener("touchstart",R,!1),s.classList.add("wui-dialog-resize"),s.classList.add(C),s.classList.add(b),o.appendChild(s)),t[e]={dialog:o,minimized_id:-1,resize_handler:s,header_minimaxi_btn:u,opts:r,detachable_ref:null,modal_element:null,status_bar:k},N(o),M(o),e}"undefined"!=typeof console&&console.log('WUI dialog create, unknow element with id "'+e+'".')}else console.log("WUI_Dialog id '"+e+"' already created, aborting.")},this.setStatusBarContent=function(e,n){var i,r,o=t[e];void 0!==o?o.status_bar&&(o.status_bar.innerHTML=n,(r=o.detachable_ref)&&(r.closed||(i=r.document.body.getElementsByClassName(E)).length>0&&(i[0].innerHTML=n))):"undefined"!=typeof console&&console.log('Cannot setStatusBarContent of WUI dialog "'+e+'".')},this.open=function(e,n){var i,r,o,l=t[e];if(void 0!==l)if(!l.detachable_ref||l.detachable_ref.closed){if(o=l.dialog,l.opts.modal)for(i=A(o),l.dialog.style.zIndex=16777271,l.modal_element=i,document.body.appendChild(i),r=0;r<u.length;r+=1)i=A(o),u[r].document.body.appendChild(i);n?I(o):(o.classList.remove(x),o.classList.add(b),M(o))}else l.detachable_ref.focus();else"undefined"!=typeof console&&console.log('Cannot open WUI dialog "'+e+'".')},this.focus=function(e){var n=t[e];void 0!==n?M(n.dialog):"undefined"!=typeof console&&console.log('Cannot focus WUI dialog "'+e+'".')},this.close=function(e,n){var i=t[e];void 0!==i?_(i.dialog,!0,n,!0):"undefined"!=typeof console&&console.log('Cannot close WUI dialog "'+e+'".')},this.destroy=function(e){var n,i=t[e];void 0!==i?(_(i.dialog,!0,!1,!0),(n=i.dialog).parentElement.removeChild(n),delete t[e]):console.log("Element id '"+e+"' is not a WUI_Dialog, destroying aborted.")},this.childWindowLoaded=function(e){var n=t[e],i=n.detachable_ref;i&&(i.document.body.firstElementChild?(O(n.dialog.children[1],i.document.body.firstElementChild),n.opts.on_detach&&n.opts.on_detach(i)):window.setTimeout(function(){WUI_Dialog.childWindowLoaded(e)},500))},document.addEventListener("keyup",function(n){var i,r;if(27===n.keyCode)for(i in t)if(t.hasOwnProperty(i)&&(r=t[i]).opts.closable&&"101"===r.dialog.style.zIndex&&r.dialog.classList.contains(b))return void e.close(i,!0)},!1)},WUI_DropDown=new function(){"use strict";var e={},t="wui-dropdown",n="wui-dropdown-item",i="wui-dropdown-content",r="wui-dropdown-selected",o="wui-dropdown-open",l="wui-dropdown-on",s={width:"auto",height:24,ms_before_hiding:2e3,vertical:!1,vspacing:0,selected_id:0,on_item_selected:null},a=function(e,t,n){t.classList.remove(l),n.floating_content&&n.floating_content.parentElement===e.body&&e.body.removeChild(n.floating_content),n.floating_content=null,n.close_timeout=null},c=function(n){n.preventDefault(),n.stopPropagation();var i=n.target,r=null,l=null;i.classList.contains(t)&&((l=(r=e[i.id]).floating_content)?l.classList.contains(o)&&a(n.target.ownerDocument,i,r):d(n))},u=function(t){t.preventDefault(),t.stopPropagation();var i,o,l=t.target,s=null,c=null;if(l.classList.contains(n)){for(s=l.parentElement,i=e[s.dataset.linkedto],c=s.getElementsByTagName("div"),o=0;o<c.length;o+=1)c[o].classList.remove(r);l.classList.add(r),i.selected_id=parseInt(l.dataset.index,10),i.target_element.lastElementChild.innerHTML=l.textContent,i.element!==i.target_element&&(i.element.lastElementChild.innerHTML=l.textContent),void 0!==i.opts.on_item_selected&&i.opts.on_item_selected(l.dataset.index),a(l.ownerDocument,i.target_element,i)}},d=function(s){s.preventDefault(),s.stopPropagation();var a=s.target,c=null,h=null,p=null,g=a.ownerDocument,m=g.defaultView||g.parentWindow;if(a.classList.contains(t))null===(c=e[a.id]).floating_content&&(a.classList.add(l),function(e,t){var o,l=e.createElement("div"),s=null,a="";for(o=0;o<t.content_array.length;o+=1)a=t.content_array[o],s=e.createElement("div"),t.opts.vertical||s.classList.add("wui-dropdown-horizontal"),s.classList.add(n),s.innerHTML=a,s.dataset.index=o,l.appendChild(s),s.addEventListener("click",u,!1),a===t.content_array[t.selected_id]&&s.classList.add(r);l.addEventListener("mouseover",d,!1),l.classList.add(i),l.dataset.linkedto=t.element.id,e.body.appendChild(l),t.floating_content=l}(g,c),p=c.floating_content,h=function(e){var t=e.ownerDocument,n=e.getBoundingClientRect(),i=t.body,r=t.documentElement,o=t.defaultView||t.parentWindow,l=o.pageYOffset||r.scrollTop||i.scrollTop,s=o.pageXOffset||r.scrollLeft||i.scrollLeft,a=r.clientTop||i.clientTop||0,c=r.clientLeft||i.clientLeft||0,u=n.top+l-a,d=n.left+s-c;return{top:Math.round(u),left:Math.round(d)}}(a),p.style.top=h.top-p.offsetHeight-c.opts.vspacing+"px",p.style.left=h.left+"px",p.classList.add(o),c.target_element=a);else if(a.classList.contains(i))c=e[a.dataset.linkedto];else{if(!a.classList.contains(n))return;c=e[a.parentElement.dataset.linkedto]}m.clearTimeout(c.close_timeout),a.addEventListener("mouseleave",f,!1)},f=function(t){t.preventDefault();var r=t.target,o=null,l=r.ownerDocument,s=l.defaultView||l.parentWindow;(o=r.classList.contains(i)?e[r.dataset.linkedto]:r.classList.contains(n)?e[r.parentElement.dataset.linkedto]:e[r.id]).close_timeout=s.setTimeout(a,o.opts.ms_before_hiding,l,o.target_element,o),r.removeEventListener("mouseleave",f,!1)};this.create=function(n,i,r){var o,l=document.getElementById(n),a={};if(void 0===e[n]){for(o in s)s.hasOwnProperty(o)&&(a[o]=s[o]);if(void 0!==i)for(o in i)i.hasOwnProperty(o)&&void 0!==s[o]&&(a[o]=i[o]);l.classList.add(t),l.style.width=a.width,l.style.height=a.height;var u=document.createElement("div");u.classList.add("wui-dropdown-icon"),l.appendChild(u);var f=document.createElement("div");f.classList.add("wui-dropdown-text"),0!==r.length&&(f.innerHTML=r[a.selected_id]),l.appendChild(f),l.addEventListener("click",c,!1),l.addEventListener("mouseover",d,!1);var h={element:l,floating_content:null,selected_id:a.selected_id,content_array:r,opts:a,button_item:f,hover_count:0,target_element:null,close_timeout:null};return e[n]=h,n}console.log("WUI_DropDown id '"+n+"' already created, aborting.")},this.destroy=function(t){var n,i=e[t];void 0!==i?(n=i.element,a(document,n,i),n.parentElement.removeChild(n),delete e[t]):console.log("Element id '"+t+"' is not a WUI_DropDown, destroying aborted.")}},WUI_RangeSlider=new function(){"use strict";var e={},t=null,n=null,i=null,r=null,o="wui-rangeslider-hook",l="wui-rangeslider-bar",s="wui-rangeslider-filler",a="wui-rangeslider-hook-focus",c="wui-rangeslider-input",u={width:148,height:8,title:"",title_min_width:0,value_min_width:0,min:0,max:1,step:.01,scroll_step:.01,vertical:!1,title_on_top:!1,on_change:null,default_value:.5,configurable:null},d={min:0,max:0,step:0,scroll_step:0},f=function(e){var t=e.ownerDocument,n=e.getBoundingClientRect(),i=t.body,r=t.documentElement,o=t.defaultView||t.parentWindow,l=o.pageYOffset||r.scrollTop||i.scrollTop,s=o.pageXOffset||r.scrollLeft||i.scrollLeft,a=r.clientTop||i.clientTop||0,c=r.clientLeft||i.clientLeft||0,u=n.top+l-a,d=n.left+s-c;return{top:Math.round(u),left:Math.round(d)}},h=function(e,t){null!==e&&e(t)},p=function(e,t){var n=e.toString(),i=n.indexOf("."),r=-1==i?n.length:1+i+t,o=n.substr(0,r),l=isNaN(o)?0:o;return parseFloat(l)},g=function(e){return e.classList.contains(o)?e:e.classList.contains(s)?e.firstElementChild:e.firstElementChild.firstElementChild},m=function(t,n,i){var r=t,o=e[r.id],s=r.getElementsByClassName(l)[0],a=s.firstElementChild,c=a.firstElementChild,u=s.nextElementSibling,d=n.opts.width,f=n.opts.height,h=Math.abs((i-n.opts.min)/n.opts.range);i=p(i,4),n.opts.vertical?(h=Math.round(h*s.offsetHeight),a.style.position="absolute",a.style.bottom="0",a.style.width="100%",a.style.height=h+"px",c.style.marginTop=-d+"px",c.style.marginLeft=-d/2-1+"px",c.style.width=2*d+"px",c.style.height=2*d+"px",u.style.marginTop="13px",o.element!==r&&(o.filler.style.position="absolute",o.filler.style.bottom="0",o.filler.style.width="100%",o.filler.style.height=h+"px",o.hook.style.marginTop=-d+"px",o.hook.style.marginLeft=-d/2-1+"px",o.hook.style.width=2*d+"px",o.hook.style.height=2*d+"px",o.value_input.style.marginTop="13px")):(h=Math.round(h*d),a.style.width=h+"px",a.style.height="100%",c.style.left=h+"px",c.style.marginTop=-f/2+"px",c.style.marginLeft=-f+"px",c.style.width=2*f+"px",c.style.height=2*f+"px",o.element!==r&&(o.filler.style.width=h+"px",o.filler.style.height="100%",o.hook.style.left=h+"px",o.hook.style.marginTop=-f/2+"px",o.hook.style.marginLeft=-f+"px",o.hook.style.width=2*f+"px",o.hook.style.height=2*f+"px")),o.value_input.value=i,u.value=i,n.value=i},v=function(e){if(e.preventDefault(),null!==i){var o,l,s=i.parentElement,a=s.parentElement,c=a.nextElementSibling,u=f(a),d=a.offsetWidth,g=0,m=e.clientX,v=e.clientY,y=e.changedTouches;if(y)for(o=0;o<y.length;o+=1)if(y[o].identifier===r){m=y[o].clientX,v=y[o].clientY;break}if(n.opts.vertical?(d=a.offsetHeight,g=Math.round((u.top+a.offsetHeight-v)/n.opts.step)*n.opts.step):g=Math.round((m-u.left)/n.opts.step)*n.opts.step,g>d?(g=d,t=n.opts.max):g<0?(g=0,t=n.opts.min):t=Math.round((n.opts.min+g/d*n.opts.range)/n.opts.step)*n.opts.step,n.value===t)return;n.value=t,l=p(t,4),c.value=l,n.value_input.value=l,n.opts.vertical?(s.style.height=g+"px",n.filler.style.height=g+"px"):(s.style.width=g+"px",n.filler.style.width=g+"px",i.style.left=g+"px",n.hook.style.left=g+"px"),h(n.opts.on_change,t)}},y=function(e){if(i){e.preventDefault();var t,o=e.changedTouches,l=!1,s=i.ownerDocument,c=s.defaultView||s.parentWindow;if(o){for(t=0;t<o.length;t+=1)if(o[t].identifier===r){l=!0,c.removeEventListener("touchend",y,!1),c.removeEventListener("touchmove",v,!1);break}}else l=!0,c.removeEventListener("mouseup",y,!1),c.removeEventListener("mousemove",v,!1);l&&(i.classList.remove(a),i=null,n=null,s.body.style.cursor="default")}},w=function(t){t.preventDefault(),t.stopPropagation();var o,l,s=null,c=!1,u=t.changedTouches;null===n&&u&&(r=u[0].identifier,c=!0),0===t.button&&(c=!0),c&&((i=g(t.target)).classList.add(a),s=i.parentElement.parentElement.parentElement,n=e[s.id],l=(o=s.ownerDocument).defaultView||o.parentWindow,o.body.style.cursor="pointer",v(t),l.addEventListener("mousemove",v,!1),l.addEventListener("touchmove",v,!1),l.addEventListener("mouseup",y,!1),l.addEventListener("touchend",y,!1))},b=function(t){t.preventDefault(),t.stopPropagation();var n=t.target.parentElement.parentElement.parentElement,i=e[n.id],r=i.opts.default_value;m(n,i,r),h(i.opts.on_change,r)},x=function(t){t.preventDefault(),t.stopPropagation();var n=g(t.target).parentElement.parentElement.parentElement,i=e[n.id],r=t.wheelDelta?t.wheelDelta/40:t.detail?-t.detail:0,o=i.value;r>=0?o+=i.opts.scroll_step:o-=i.opts.scroll_step,o>i.opts.max?o=i.opts.max:o<i.opts.min&&(o=i.opts.min),m(n,i,o),h(i.opts.on_change,o)},L=function(t){if(!t.target.validity||t.target.validity.valid){var n=t.target.parentElement.childNodes[1];if(void 0!==n){var i=g(n).parentElement.parentElement.parentElement,r=e[i.id];m(i,r,t.target.value),h(r.opts.on_change,t.target.value)}}},C=function(e,t,n){return function(e){var i=e.target,r=t.opts;i.validity&&!i.validity.valid||("min"===n?(r.min=p(i.value,4),t.value_input.min=r.min,r.range=r.max-r.min):"max"===n?(r.max=p(i.value,4),t.value_input.max=r.max,r.range=r.max-r.min):"step"===n?(r.step=p(i.value,4),t.value_input.step=r.step):"scroll_step"===n&&(r.scroll_step=p(i.value,4)),void 0!==r.configurable[n]&&(r.configurable[n].val=i.value))}},S=function(t){t.preventDefault(),t.stopPropagation();var n,i,r,o,l,s,a,u=t.target,h=u.parentElement,p=e[h.id],g=p.opts,m=u.ownerDocument,v=p.element.id+"_wui_container",y=1;if(document.getElementById(v)||(p.configure_panel_open=!1),!0!==p.configure_panel_open){for(i in(o=m.createElement("div")).className="wui-rangeslider-configure-container",(a=m.createElement("div")).className="wui-rangeslider-configure-close",n=function(e){p.configure_panel_open=!1;var t=document.getElementById(v),n=e.target.ownerDocument.getElementById(v);t&&t.parentElement&&t.parentElement.removeChild(t),n&&n.parentElement&&n.parentElement.removeChild(n)},a.addEventListener("click",n,!1),a.addEventListener("touchstart",n,!1),o.id=v,o.appendChild(a),g.configurable)g.configurable.hasOwnProperty(i)&&void 0!==d[i]&&(r=g.configurable[i],(l=m.createElement("div")).style.display="inline-block",l.style.marginRight="8px",l.style.width="80px",l.style.textAlign="right",l.innerHTML=i.replace("_"," ")+" : ",(s=m.createElement("input")).className=c,o.appendChild(l),o.appendChild(s),y%2==0&&o.appendChild(m.createElement("div")),s.setAttribute("type","number"),void 0!==r&&(void 0!==r.min&&(s.setAttribute("min",r.min),s.title=s.title+" min: "+r.min),void 0!==r.max&&(s.setAttribute("max",r.max),s.title=s.title+" max: "+r.max),void 0!==r.val?s.setAttribute("value",r.val):"min"===i?s.setAttribute("value",g.min):"max"===i?s.setAttribute("value",g.max):"step"===i?s.setAttribute("value",g.step):"scroll_step"===i&&s.setAttribute("value",g.scroll_step)),s.addEventListener("input",C(0,p,i),!1),y+=1);f(u),h.insertBefore(o,u),p.configure_panel_open=!0}};this.create=function(t,n){var i,r=document.getElementById(t),a={};if(void 0===e[t]){for(i in u)u.hasOwnProperty(i)&&(a[i]=u[i]);if(void 0!==n){for(i in n)n.hasOwnProperty(i)&&void 0!==u[i]&&(a[i]=n[i]);void 0!==n.max&&(a.range=n.max),void 0!==n.step&&(a.step=n.step,void 0===n.scroll_step&&(a.scroll_step=a.step)),void 0!==n.title_on_top?a.title_on_top=n.title_on_top:a.vertical&&(a.title_on_top=!0),void 0!==n.default_value?a.default_value=n.default_value:void 0!==n.min&&void 0!==n.max&&(a.default_value=a.min+a.max/2)}a.min<0&&(a.range=a.max-a.min),e[t]=null,r.classList.add("wui-rangeslider"),a.title_on_top&&r.classList.add("wui-rangeslider-title-ontop");var f=document.createElement("div"),h=document.createElement("div"),p=document.createElement("div"),g=document.createElement("div"),v=document.createElement("div"),y=document.createElement("input"),C={element:r,opts:a,bar:h,filler:p,hook:g,value_input:y,value:a.default_value};if(f.innerHTML=a.title,y.setAttribute("value",a.default_value),y.setAttribute("type","number"),y.setAttribute("min",a.min),y.setAttribute("max",a.max),y.setAttribute("step",a.step),y.classList.add(c),v.classList.add("wui-rangeslider-value"),f.classList.add("wui-rangeslider-title"),h.classList.add(l),p.classList.add(s),g.classList.add(o),a.vertical&&(f.style.textAlign="center"),f.style.minWidth=a.title_min_width+"px",v.style.minWidth=a.value_min_width+"px",y.style.minWidth=a.value_min_width+"px",h.style.width=a.width+"px",h.style.height=a.height+"px",h.appendChild(p),p.appendChild(g),r.appendChild(f),r.appendChild(h),r.appendChild(y),a.configurable){var k=0;for(i in a.configurable)a.configurable.hasOwnProperty(i)&&void 0!==d[i]&&(k+=1);if(k>0){var E=document.createElement("div");E.classList.add("wui-rangeslider-configurable-btn"),E.addEventListener("click",S,!1),E.addEventListener("touchstart",S,!1),a.title_on_top&&!a.vertical?(E.style.bottom="0",f.style.marginBottom="4px"):a.title_on_top&&a.vertical?(f.style.marginLeft="16px",f.style.marginRight="16px",E.style.top="0"):(f.style.marginLeft="16px",E.style.top="0"),a.vertical?r.appendChild(E):r.insertBefore(E,f)}}return h.addEventListener("mousedown",w,!1),h.addEventListener("touchstart",w,!1),g.addEventListener("dblclick",b,!1),y.addEventListener("input",L,!1),h.addEventListener("mousewheel",x,!1),h.addEventListener("DOMMouseScroll",x,!1),e[t]=C,m(r,C,a.default_value),t}console.log("WUI_RangeSlider id '"+t+"' already created, aborting.")},this.destroy=function(t){var n,i,r,o=e[t];void 0!==o?((n=o.element).parentElement.removeChild(n),(r=(i=n.ownerDocument).getElementById(t+"_wui_container"))&&i.removeChild(r),delete e[t]):console.log("Element id '"+t+"' is not a WUI_RangeSlider, destroying aborted.")}},WUI_Tabs=new function(){"use strict";var e={},t="wui-tab-enabled",n="wui-tab-disabled",i="wui-tab-display-none",r="wui-tabs",o="wui-tabs-content",l="wui-tab-content",s="wui-tabs-underline",a={on_tab_click:null,height:"calc(100% - 30px)"},c=function(r){r.preventDefault(),r.stopPropagation();var o=r.target,l=o.parentElement,s=l.nextElementSibling.nextElementSibling,a=l.parentElement.id,c=e[a],u=0,d=null,f=0;for(f=0;f<l.childElementCount;f+=1)(d=l.children[f]).classList.remove(t),d.classList.add(n),c.tabs[f].classList.remove(t),c.tabs[f].classList.add(n),d===o&&(u=f);for(f=0;f<s.childElementCount;f+=1)(d=s.children[f]).classList.remove(i),c.contents[f].classList.remove(i),u!==f&&(d.classList.add(i),c.contents[f].classList.add(i));c.tabs[u].classList.remove(n),c.tabs[u].classList.add(t),r.target.classList.remove(n),r.target.classList.add(t),c.opts.on_tab_click&&c.opts.on_tab_click(u)};this.create=function(o,s){var u,d=document.getElementById(o),f=d.firstElementChild,h=document.createElement("div"),p=f.nextElementSibling,g=f.children[0],m={},v=0;if(void 0===e[o]){for(u in a)a.hasOwnProperty(u)&&(m[u]=a[u]);if(void 0!==s)for(u in s)s.hasOwnProperty(u)&&void 0!==a[u]&&(m[u]=s[u]);d.style.overflow="hidden",h.className="wui-tabs-underline",d.insertBefore(h,p),f.classList.add(r);var y=f.childElementCount,w=[];for(v=0;v<y;v+=1){var b=f.children[v];b.classList.add("wui-tab"),b!==g&&b.classList.add(n),b.addEventListener("click",c,!1),b.addEventListener("touchstart",c,!1),w.push(b)}g.classList.add(t),g.classList.add("wui-first-tab"),p.classList.add("wui-tabs-content");var x=p.childElementCount,L=[p.children[0]];for(p.style.height=m.height,p.children[0].classList.add(l),v=1;v<x;v+=1){var C=p.children[v];C.classList.add(l),C.classList.add(i),L.push(C)}return e[o]={element:d,tabs:w,contents:L,opts:m},o}console.log("WUI_Tabs id '"+o+"' already created, aborting.")},this.getContentElement=function(e,t){return document.getElementById(e).firstElementChild.nextElementSibling.nextElementSibling.children[t]},this.getTabName=function(e,t){return this.getContentElement(e,t).getAttribute("data-group-name")},this.destroy=function(t){var n,i,l,a,c,u=e[t];if(void 0!==u){if((n=u.element).classList.contains("wui-dialog-content"))for(i=n.getElementsByClassName(r),l=n.getElementsByClassName(s),a=n.getElementsByClassName(o),c=0;c<i.length;c+=1)n.removeChild(i[c]),n.removeChild(l[c]),n.removeChild(a[c]);else n.parentElement.removeChild(n);delete e[t]}else console.log("Element id '"+t+"' is not a WUI_Tabs, destroying aborted.")}},WUI_ToolBar=new function(){"use strict";var e={},t="wui-toolbar-minimize-icon",n="wui-toolbar-maximize-icon",i="wui-toolbar-button",r="wui-toolbar-minimize-group",o="wui-toolbar-minimize-group-vertical",l="wui-toolbar-toggle",s="wui-toolbar-toggle-on",a="wui-toolbar-item",c="wui-toolbar-group",u="wui-toolbar-group-vertical",d="wui-toolbar",f="wui-toolbar-dropdown-content",h="wui-toolbar-dropdown-item",p="wui-toolbar-dropdown-open",g={item_hmargin:null,item_vmargin:null,item_width:32,item_height:32,icon_width:32,icon_height:32,allow_groups_minimize:!1,vertical:!1},m=function(t){var n=e[t];return void 0===n?("undefined"!=typeof console&&console.log('_getWidget failed, the element id "'+t+'" is not a WUI_ToolBar.'),null):n},v=function(i,r){return void 0!==r?e[r]:i.classList.contains(d)?e[i.id]:i.classList.contains(t)||i.classList.contains(n)||i.classList.contains(u)||i.classList.contains(c)?e[i.parentElement.id]:e[i.parentElement.parentElement.id]},y=function(e,t,n){if(void 0!==e.on_click&&null!==e.on_click){var i={id:e.id,type:t};void 0!==n&&(i.state=n),e.on_click(i)}},w=function(e,t,n){var i,r,o,l,c=!1,u=0;o=(i=v(e,t)).element,e.parentElement&&e.parentElement.parentElement&&(o=e.parentElement.parentElement);var d=i.tools[parseInt(e.dataset.tool_id,10)];if("1"===d.element.dataset.on?(d.element.dataset.on=0,e.dataset.on=0,d.element.title=d.tooltip,e.title=d.tooltip,void 0!==d.icon&&(d.element.classList.add(d.icon),d.element.classList.remove(d.toggled_icon),e.classList.add(d.icon),e.classList.remove(d.toggled_icon))):(d.element.dataset.on=1,e.dataset.on=1,void 0!==d.tooltip_toggled&&(d.element.title=d.tooltip_toggled,e.title=d.tooltip_toggled),void 0!==d.toggled_icon&&(d.element.classList.add(d.toggled_icon),d.element.classList.remove(d.icon),e.classList.add(d.toggled_icon),e.classList.remove(d.icon)),c=!0),"none"!==d.toggled_style&&(e.classList.contains(s)?(d.element.classList.remove(s),e.classList.remove(s)):(d.element.classList.add(s),e.classList.add(s))),void 0!==(r=e.dataset.toggle_group))for(l=o.getElementsByClassName(a),u=0;u<l.length;u+=1){var f=l[u],h=i.tools[parseInt(f.dataset.tool_id,10)];if(r===f.dataset.toggle_group&&f.dataset.tool_id!==e.dataset.tool_id){if("0"===f.dataset.on)continue;f.dataset.on="0",h.element.dataset.on="0",f.classList.remove(s),h.element.classList.remove(s),void 0!==d.toggled_icon&&(f.classList.remove(h.toggled_icon),h.element.classList.remove(h.toggled_icon)),void 0!==d.icon&&(f.classList.add(h.icon),h.element.classList.add(h.icon)),(n||void 0===n)&&y(h,"toggle",!1)}}!0!==n&&void 0!==n||y(d,"toggle",c)},b=function(t){t.preventDefault(),t.stopPropagation();var n=t.target,i=n.ownerDocument,r=n.parentElement,o=e[r.dataset.linkedto_tb],l=parseInt(r.dataset.linkedto_tool_index,10),c=o.tools[l],u=parseInt(n.dataset.index,10),d=c.items[u],f=i.getElementById(r.dataset.linkedto_tb).getElementsByClassName(a)[l];void 0!==d.on_click&&(d.on_click(),f.classList.remove(s),c.element.classList.remove(s),x(c,f))},x=function(e,t){var n,i,r=t.ownerDocument.body.getElementsByClassName(f);for(i=0;i<r.length;i+=1)(n=r[i]).removeEventListener("click",b,!1),n.parentElement.removeChild(n);e.element.classList.remove(s),t.classList.remove(s)},L=function(e){e.preventDefault(),e.stopPropagation();var t=e.target;if(t.classList.contains(r)||t.classList.contains(o))C(t);else if(t.classList.contains(l))w(t);else if(!(t.classList.contains(d)||t.classList.contains(c)||t.classList.contains(u))){var n,i,a=null,g=null,m=t.ownerDocument,L=m.defaultView||m.parentWindow;if("dropdown"===(n=(i=v(t)).tools[t.dataset.tool_id]).type){if(t.classList.contains(s))return void x(n,t);a=function(e,t,n){var i,r=e.createElement("div");if(void 0!==t.items)for(i=0;i<t.items.length;i+=1){var o=t.items[i],l=e.createElement("div");t.vertical||l.classList.add("wui-toolbar-dropdown-horizontal"),l.classList.add(h),l.innerHTML=o.title,l.dataset.index=i,r.appendChild(l)}return r.addEventListener("click",b,!1),r.style.width=n.dd_items_width+"px",r.classList.add(f),r.dataset.linkedto_tb=n.element.id,r.dataset.linkedto_tool_index=t.id,e.body.appendChild(r),r}(m,n,i);var S=n.element;t.classList.add(s),S.classList.add(s),g=function(e){var t=e.ownerDocument,n=e.getBoundingClientRect(),i=t.body,r=t.documentElement,o=t.defaultView||t.parentWindow,l=o.pageYOffset||r.scrollTop||i.scrollTop,s=o.pageXOffset||r.scrollLeft||i.scrollLeft,a=r.clientTop||i.clientTop||0,c=r.clientLeft||i.clientLeft||0,u=n.top+l-a,d=n.left+s-c;return{top:Math.round(u),left:Math.round(d)}}(t),"tb_item"===n.dd_items_width&&(a.style.width=t.offsetWidth+"px"),"s"===n.orientation?(a.style.top=g.top+t.offsetHeight+"px",a.style.left=g.left+"px"):"sw"===n.orientation?(a.style.top=g.top+t.offsetHeight+"px",a.style.left=g.left-a.offsetWidth+"px"):"nw"===n.orientation?(a.style.top=g.top-a.offsetHeight+t.offsetHeight+"px",a.style.left=g.left-a.offsetWidth+"px"):"se"===n.orientation?(a.style.top=g.top+t.offsetHeight+"px",a.style.left=g.left+t.offsetWidth+"px"):"ne"===n.orientation?(a.style.top=g.top-a.offsetHeight+t.offsetHeight+"px",a.style.left=g.left+t.offsetWidth+"px"):(a.style.top=g.top-a.offsetHeight+"px",a.style.left=g.left+"px"),a.classList.add(p),e.stopPropagation&&e.stopPropagation(),L.addEventListener("click",function(e,t){var n=function(){var i=t.ownerDocument,r=i.defaultView||i.parentWindow;x(e,t),r.removeEventListener("click",n)};return n}(n,t),!1)}else y(n,"click")}},C=function(e){var i=e.nextSibling;e.classList.contains(t)?(e.classList.add(n),e.classList.remove(t),e.title="Maximize group",i.style.display="none"):(e.classList.add(t),e.classList.remove(n),e.title="Minimize group",i.style.display="")};this.create=function(n,s,f){var h,p=document.getElementById(n),m=null,v=null,y=null,b=null,x={};if(void 0===e[n]){for(h in g)g.hasOwnProperty(h)&&(x[h]=g[h]);if(void 0!==s)for(h in s)s.hasOwnProperty(h)&&void 0!==g[h]&&(x[h]=s[h]);e[n]={element:p,tools:[],opts:x},p.classList.add(d);var C,S=c,k=a,E="wui-toolbar-spacer",T=r;for(y in x.vertical?(p.classList.add("wui-toolbar-vertical"),S=u,k+=" wui-toolbar-item-vertical",E="wui-toolbar-spacer-vertical",T=o,p.style.maxWidth=x.item_width+4+"px",null===x.item_hmargin&&(x.item_hmargin=3),null===x.item_vmargin&&(x.item_vmargin=8)):(p.style.maxHeight=x.item_height+4+"px",null===x.item_hmargin&&(x.item_hmargin=3),null===x.item_vmargin&&(x.item_vmargin=0)),T=i+" "+t+" "+T,p.addEventListener("click",L,!1),f)if(f.hasOwnProperty(y)){null!==b&&((v=document.createElement("div")).className=E,p.appendChild(v)),x.allow_groups_minimize&&((v=document.createElement("div")).className=T,v.title="Minimize group",p.appendChild(v)),m=f[y];var _=document.createElement("div");for(_.className=S,x.vertical?_.style.maxWidth=x.item_width+"px":_.style.maxHeight=x.item_height+"px",C=0;C<m.length;C+=1){var M,A=m[C],N=document.createElement("div"),W=e[n].tools.length,D={element:N,on_click:A.on_click,icon:A.icon,items:[],tooltip:"",type:A.type,dd_items_width:A.dropdown_items_width,orientation:A.orientation,id:W};if(N.className=k,N.style.minWidth=x.item_width+"px",N.style.minHeight=x.item_height+"px",N.style.marginLeft=x.item_hmargin+"px",N.style.marginRight=x.item_hmargin+"px",N.style.marginTop=x.item_vmargin+"px",N.style.marginBottom=x.item_vmargin+"px",N.style.backgroundSize=x.icon_width-4+"px "+(x.icon_height-4)+"px",_.appendChild(N),e[n].tools.push(D),N.dataset.tool_id=W,D.tooltip=A.tooltip,void 0!==A.tooltip&&(N.title=A.tooltip),void 0!==A.text&&(N.innerHTML=A.text,N.style.lineHeight=x.item_height+"px",N.classList.add("wui-toolbar-text"),void 0!==A.icon&&(N.style.paddingLeft=x.icon_width+2+"px",N.style.backgroundPosition="left center")),void 0!==A.icon&&N.classList.add(A.icon),"toggle"===A.type)N.classList.add(l),D.toggled_icon=A.toggled_icon,D.tooltip_toggled=A.tooltip_toggled,D.toggled_style=A.toggled_style,void 0!==A.toggle_group&&(N.dataset.toggle_group=A.toggle_group),A.toggle_state&&(N.dataset.on="1");else if("dropdown"===A.type){if(N.classList.add(i),void 0!==A.items)for(M=0;M<A.items.length;M+=1){var O=A.items[M];D.items.push({title:O.title,on_click:O.on_click})}}else N.classList.add(i)}p.appendChild(_),b=m}var I=p.getElementsByClassName(a);for(C=0;C<I.length;C+=1){var H=I[C];"1"===H.dataset.on&&(H.dataset.on="0",w(H,n,!0))}return n}console.log("WUI_Toolbar id '"+n+"' already created, aborting.")},this.hideGroup=function(e,t){var n,i,l,s=m(e);if(s){if(0===(n=s.opts.vertical?s.element.getElementsByClassName(u):s.element.getElementsByClassName(c)).length)return;((l=(i=n[t]).previousElementSibling).classList.contains(r)||l.classList.contains(o))&&(l.style.display="none"),i.style.display="none"}},this.showGroup=function(e,t){var n,i,l=m(e);if(l){if(0===(n=l.opts.vertical?l.element.getElementsByClassName(u):l.element.getElementsByClassName(c)).length)return;((i=n[t].previousElementSibling).classList.contains(r)||i.classList.contains(o))&&(i.style.display=""),n[t].style.display=""}},this.toggle=function(e,t,n){var i=m(e);i&&w(i.tools[t].element,e,n)},this.getItemElement=function(e,t){var n=m(e);if(n)return n.tools[t].element},this.destroy=function(t){var n,i,r,o,l,s,a=e[t];if(void 0!==a){for(n=a.toolbar,i=a.tools,n.parentElement.removeChild(n),s=0;s<i.length;s+=1)"dropdown"===(r=i[s]).type&&(o=r.items).length>0&&(l=o[0].element).parentElement.removeChild(l);delete e[t]}else console.log("Element id '"+t+"' is not a WUI_ToolBar, destroying aborted.")}},WUI_CircularMenu=new function(){"use strict";var e=[],t=0,n="wui-circularmenu-item",i="wui-circularmenu-show",r={x:null,y:null,rx:64,ry:48,item_width:32,item_height:32,window:null,element:null},o=function(t){var n,i;for(i=0;i<e.length;i+=1)n=e[i],t.body.removeChild(n);e=[]},l=function(e,t,n){return function(e){e.preventDefault(),n(),o(t)}},s=function(r,s,a,c,u,d){o(c);var f,h,p,g=-Math.PI/2,m=s.length,v=2*Math.PI/m;for(p=0;p<m;p+=1)h=s[p],(f=document.createElement("div")).classList.add(n),f.style.width=r.item_width+"px",f.style.height=r.item_height+"px",f.style.backgroundSize=r.item_width-4+"px "+(r.item_height-4)+"px",f.style.left=u+r.rx*Math.cos(g)+"px",f.style.top=d+r.ry*Math.sin(g)+"px",f.classList.add(h.icon),h.tooltip&&(f.title=h.tooltip),c.body.appendChild(f),a.getComputedStyle(f).width,e.push(f),h.on_click&&f.addEventListener("click",l(0,c,h.on_click)),f.classList.add(i),g+=v;var y=function(e,i){var r=function(l){l.preventDefault(),(new Date).getTime()-t<=500||l.target.classList.contains(n)||(o(i),e.removeEventListener("click",r),e.removeEventListener("mousedown",r))};return r}(a,c);a.addEventListener("click",y),t=(new Date).getTime(),a.addEventListener("mousedown",y)};this.create=function(e,t){var n,i,o,l,a,c={},u=document,d=window;for(n in r)r.hasOwnProperty(n)&&(c[n]=r[n]);if(void 0!==e)for(n in e)e.hasOwnProperty(n)&&void 0!==r[n]&&(c[n]=e[n]);null!==(l=c.element)?(a=l.getBoundingClientRect(),d=(u=l.ownerDocument).defaultView||u.parentWindow,i=a.left+(a.width-c.item_width)/2,o=a.top+(a.height-c.item_height)/2,s(c,t,d,u,i,o)):null!==i&&null!==o&&(null!==c.window&&(u=(d=c.window).document),i=c.x-c.item_width/2,o=c.y-c.item_height/2,s(c,t,d,u,i,o))}},WUI=new function(){"use strict";var e="wui-display-none",t="wui-hide-fi-500",n="wui-show-fi-500",i="wui-draggable",r=[],o=null,l=null,s=0,a=0,c=function(e){e.preventDefault();var t=e.clientX,n=e.clientY,r=e.changedTouches;if(e.target.classList.contains(i)){if(null===o)if(r)l=r[0].identifier,t=r[0].clientX,n=r[0].clientY;else if(0!==e.button)return;o=e.target,document.body.style.cursor="move",s=t-parseInt(o.style.left,10),a=n-parseInt(o.style.top,10),window.addEventListener("mousemove",u,!1),window.addEventListener("touchmove",u,!1),window.addEventListener("mouseup",d,!1),window.addEventListener("touchend",d,!1)}},u=function(e){e.preventDefault();var t,n=e.clientX,i=e.clientY,c=e.changedTouches,u=r[parseInt(o.dataset.wui_draggable_id,10)],d=u.x,f=u.y;if(c)for(t=0;t<c.length;t+=1)if(c[t].identifier===l){n=c[t].clientX,i=c[t].clientY;break}0!==u.axisLock&&(d=n-s,o.style.left=d+"px",u.x=d),1!==u.axisLock&&(f=i-a,o.style.top=f+"px",u.y=f),u&&void 0!==u.cb&&u.cb(o,d,f)},d=function(e){e.preventDefault();var t,n=e.changedTouches;if(0!==r.length)if(n){for(t=0;t<n.length;t+=1)if(n[t].identifier===l){o=null,document.body.style.cursor="default",window.removeEventListener("touchmove",u,!1),window.removeEventListener("touchend",d,!1);break}}else o=null,document.body.style.cursor="default",window.removeEventListener("mousemove",u,!1),window.removeEventListener("mouseup",d,!1)};this.fadeOut=function(i,r,o,l){void 0!==r&&null!==r||(r=500),void 0===i.style.WebkitTransition?i.style.transition="visibility 0s ease-in-out "+r+"ms, opacity "+r+"ms ease-in-out":i.style.WebkitTransition="visibility 0s ease-in-out "+r+"ms, opacity "+r+"ms ease-in-out",i.addEventListener("transitionend",function(t,n,i){var r=function(){i&&t.classList.add(e),n&&n(),t.removeEventListener("transitionend",r)};return r}(i,o,l),!1),i.classList.add(t),i.classList.remove(n)},this.fadeIn=function(i,r){void 0!==r&&null!==r||(r=500),void 0===i.style.WebkitTransition?i.style.transition="visibility 0s ease-in-out 0s, opacity "+r+"ms ease-in-out":i.style.WebkitTransition="visibility 0s ease-in-out 0s, opacity "+r+"ms ease-in-out",i.classList.remove(t),i.classList.add(n),i.classList.remove(e)},this.draggable=function(e,t,n){if(t){if(e.classList.contains(i))return;e.classList.add(i),e.addEventListener("mousedown",c,!1),e.addEventListener("touchstart",c,!1),e.dataset.wui_draggable_id=r.length,r.push({cb:n,element:e,axisLock:null,x:parseInt(e.style.left,10),y:parseInt(e.style.top,10)})}else{if(!e.classList.contains(i))return;e.classList.remove(i),e.removeEventListener("mousedown",c,!1),e.removeEventListener("touchstart",c,!1);var o,l=parseInt(e.dataset.wui_draggable_id,10);for(r.splice(l,1),o=0;o<r.length;o+=1){r[o].element.dataset.wui_draggable_id=o}}},this.lockDraggable=function(e,t){if(e.classList.contains(i)){var n=r[parseInt(e.dataset.wui_draggable_id,10)];n.axisLock="x"===t?0:"y"===t?1:null}}};!function(e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else{if("function"==typeof define&&define.amd)return define([],e);this.CodeMirror=e()}}(function(){"use strict";var e=/gecko\/\d/i.test(navigator.userAgent),t=/MSIE \d/.test(navigator.userAgent),n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),i=t||n,r=i&&(t?document.documentMode||6:n[1]),o=/WebKit\//.test(navigator.userAgent),l=o&&/Qt\/\d+\.\d+/.test(navigator.userAgent),s=/Chrome\//.test(navigator.userAgent),a=/Opera\//.test(navigator.userAgent),c=/Apple Computer/.test(navigator.vendor),u=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),d=/PhantomJS/.test(navigator.userAgent),f=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),h=f||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),p=f||/Mac/.test(navigator.platform),g=/win/i.test(navigator.platform),m=a&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);m&&(m=Number(m[1])),m&&m>=15&&(a=!1,o=!0);var v=p&&(l||a&&(null==m||m<12.11)),y=e||i&&r>=9,w=!1,b=!1;function x(t,n){if(!(this instanceof x))return new x(t,n);this.options=n=n?co(n):{},co(Gn,n,!1),W(n);var l=n.value;"string"==typeof l&&(l=new sr(l,n.mode)),this.doc=l;var s=new x.inputStyles[n.inputStyle](this),u=this.display=new function(t,n,l){var s=this;this.input=l,s.scrollbarFiller=wo("div",null,"CodeMirror-scrollbar-filler"),s.scrollbarFiller.setAttribute("cm-not-content","true"),s.gutterFiller=wo("div",null,"CodeMirror-gutter-filler"),s.gutterFiller.setAttribute("cm-not-content","true"),s.lineDiv=wo("div",null,"CodeMirror-code"),s.selectionDiv=wo("div",null,null,"position: relative; z-index: 1"),s.cursorDiv=wo("div",null,"CodeMirror-cursors"),s.measure=wo("div",null,"CodeMirror-measure"),s.lineMeasure=wo("div",null,"CodeMirror-measure"),s.lineSpace=wo("div",[s.measure,s.lineMeasure,s.selectionDiv,s.cursorDiv,s.lineDiv],null,"position: relative; outline: none"),s.mover=wo("div",[wo("div",[s.lineSpace],"CodeMirror-lines")],null,"position: relative"),s.sizer=wo("div",[s.mover],"CodeMirror-sizer"),s.sizerWidth=null,s.heightForcer=wo("div",null,null,"position: absolute; height: "+Yr+"px; width: 1px;"),s.gutters=wo("div",null,"CodeMirror-gutters"),s.lineGutter=null,s.scroller=wo("div",[s.sizer,s.heightForcer,s.gutters],"CodeMirror-scroll"),s.scroller.setAttribute("tabIndex","-1"),s.wrapper=wo("div",[s.scrollbarFiller,s.gutterFiller,s.scroller],"CodeMirror"),i&&r<8&&(s.gutters.style.zIndex=-1,s.scroller.style.paddingRight=0);o||e&&h||(s.scroller.draggable=!0);t&&(t.appendChild?t.appendChild(s.wrapper):t(s.wrapper));s.viewFrom=s.viewTo=n.first,s.reportedViewFrom=s.reportedViewTo=n.first,s.view=[],s.renderedView=null,s.externalMeasured=null,s.viewOffset=0,s.lastWrapHeight=s.lastWrapWidth=0,s.updateLineNumbers=null,s.nativeBarWidth=s.barHeight=s.barWidth=0,s.scrollbarsClipped=!1,s.lineNumWidth=s.lineNumInnerWidth=s.lineNumChars=null,s.alignWidgets=!1,s.cachedCharWidth=s.cachedTextHeight=s.cachedPaddingH=null,s.maxLine=null,s.maxLineLength=0,s.maxLineChanged=!1,s.wheelDX=s.wheelDY=s.wheelStartX=s.wheelStartY=null,s.shift=!1,s.selForContextMenu=null,s.activeTouch=null,l.init(s)}(t,l,s);u.wrapper.CodeMirror=this,_(this),E(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!h&&u.input.focus(),H(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new Qr,keySeq:null,specialChars:null};var d=this;for(var f in i&&r<11&&setTimeout(function(){d.display.input.reset(!0)},20),function(e){var t=e.display;zr(t.scroller,"mousedown",Rt(e,en)),zr(t.scroller,"dblclick",i&&r<11?Rt(e,function(t){if(!Gr(e,t)){var n=Jt(e,t);if(n&&!nn(e,t)&&!Qt(e.display,t)){Nr(t);var i=e.findWordAt(n);Ie(e.doc,i.anchor,i.head)}}}):function(t){Gr(e,t)||Nr(t)});y||zr(t.scroller,"contextmenu",function(t){Ln(e,t)});var n,o={end:0};function l(){t.activeTouch&&(n=setTimeout(function(){t.activeTouch=null},1e3),(o=t.activeTouch).end=+new Date)}function s(e,t){if(null==t.left)return!0;var n=t.left-e.left,i=t.top-e.top;return n*n+i*i>400}zr(t.scroller,"touchstart",function(e){if(!function(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}(e)){clearTimeout(n);var i=+new Date;t.activeTouch={start:i,moved:!1,prev:i-o.end<=300?o:null},1==e.touches.length&&(t.activeTouch.left=e.touches[0].pageX,t.activeTouch.top=e.touches[0].pageY)}}),zr(t.scroller,"touchmove",function(){t.activeTouch&&(t.activeTouch.moved=!0)}),zr(t.scroller,"touchend",function(n){var i=t.activeTouch;if(i&&!Qt(t,n)&&null!=i.left&&!i.moved&&new Date-i.start<300){var r,o=e.coordsChar(t.activeTouch,"page");r=!i.prev||s(i,i.prev)?new _e(o,o):!i.prev.prev||s(i,i.prev.prev)?e.findWordAt(o):new _e(ce(o.line,0),We(e.doc,ce(o.line+1,0))),e.setSelection(r.anchor,r.head),e.focus(),Nr(n)}l()}),zr(t.scroller,"touchcancel",l),zr(t.scroller,"scroll",function(){t.scroller.clientHeight&&(ln(e,t.scroller.scrollTop),sn(e,t.scroller.scrollLeft,!0),Br(e,"scroll",e))}),zr(t.scroller,"mousewheel",function(t){dn(e,t)}),zr(t.scroller,"DOMMouseScroll",function(t){dn(e,t)}),zr(t.wrapper,"scroll",function(){t.wrapper.scrollTop=t.wrapper.scrollLeft=0}),t.dragFunctions={simple:function(t){Gr(e,t)||Or(t)},start:function(t){!function(e,t){if(i&&(!e.state.draggingText||+new Date-rn<100))return void Or(t);if(Gr(e,t)||Qt(e.display,t))return;if(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!c){var n=wo("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),a&&n.parentNode.removeChild(n)}}(e,t)},drop:Rt(e,on)};var u=t.input.getField();zr(u,"keyup",function(t){yn.call(e,t)}),zr(u,"keydown",Rt(e,vn)),zr(u,"keypress",Rt(e,wn)),zr(u,"focus",uo(bn,e)),zr(u,"blur",uo(xn,e))}(this),function(){if(Mo)return;zr(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,_o(Zt)},100))}),zr(window,"blur",function(){_o(xn)}),Mo=!0;var e}(),Dt(this),this.curOp.forceUpdate=!0,dr(this,l),n.autofocus&&!h||d.hasFocus()?setTimeout(uo(bn,this),20):xn(this),Vn)Vn.hasOwnProperty(f)&&Vn[f](this,n[f],Xn);F(this),n.finishInit&&n.finishInit(this);for(var p=0;p<$n.length;++p)$n[p](this);Ot(this),o&&n.lineWrapping&&"optimizelegibility"==getComputedStyle(u.lineDiv).textRendering&&(u.lineDiv.style.textRendering="auto")}function L(e){e.doc.mode=x.getMode(e.options,e.doc.modeOption),C(e)}function C(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,Ze(e,100),e.state.modeGen++,e.curOp&&jt(e)}function S(e){var t=Tt(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/_t(e.display)-3);return function(r){if(Wi(e.doc,r))return 0;var o=0;if(r.widgets)for(var l=0;l<r.widgets.length;l++)r.widgets[l].height&&(o+=r.widgets[l].height);return n?o+(Math.ceil(r.text.length/i)||1)*t:o+t}}function k(e){var t=e.doc,n=S(e);t.iter(function(e){var t=n(e);t!=e.height&&gr(e,t)})}function E(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),mt(e)}function T(e){_(e),jt(e),setTimeout(function(){R(e)},20)}function _(e){var t=e.display.gutters,n=e.options.gutters;bo(t);for(var i=0;i<n.length;++i){var r=n[i],o=t.appendChild(wo("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=i?"":"none",M(e)}function M(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function A(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=Ei(i);){i=(r=t.find(0,!0)).from.line,n+=r.from.ch-r.to.ch}for(i=e;t=Ti(i);){var r=t.find(0,!0);n-=i.text.length-r.from.ch,n+=(i=r.to.line).text.length-r.to.ch}return n}function N(e){var t=e.display,n=e.doc;t.maxLine=fr(n,n.first),t.maxLineLength=A(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=A(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function W(e){var t=oo(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function D(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+tt(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+it(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function O(e,t,n){this.cm=n;var o=this.vert=wo("div",[wo("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),l=this.horiz=wo("div",[wo("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(o),e(l),zr(o,"scroll",function(){o.clientHeight&&t(o.scrollTop,"vertical")}),zr(l,"scroll",function(){l.clientWidth&&t(l.scrollLeft,"horizontal")}),this.checkedOverlay=!1,i&&r<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function I(){}function H(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&ko(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new x.scrollbarModel[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),zr(t,"mousedown",function(){e.state.focused&&setTimeout(function(){e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,n){"horizontal"==n?sn(e,t):ln(e,t)},e),e.display.scrollbars.addClass&&Eo(e.display.wrapper,e.display.scrollbars.addClass)}function z(e,t){t||(t=D(e));var n=e.display.barWidth,i=e.display.barHeight;P(e,t);for(var r=0;r<4&&n!=e.display.barWidth||i!=e.display.barHeight;r++)n!=e.display.barWidth&&e.options.lineWrapping&&q(e),P(e,D(e)),n=e.display.barWidth,i=e.display.barHeight}function P(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function B(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-et(e));var r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,o=vr(t,i),l=vr(t,r);if(n&&n.ensure){var s=n.ensure.from.line,a=n.ensure.to.line;s<o?(o=s,l=vr(t,yr(fr(t,s))+e.wrapper.clientHeight)):Math.min(a,t.lastLine())>=l&&(o=vr(t,yr(fr(t,a))-e.wrapper.clientHeight),l=a)}return{from:o,to:Math.max(l,o+1)}}function R(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=G(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=i+"px",l=0;l<n.length;l++)if(!n[l].hidden){e.options.fixedGutter&&n[l].gutter&&(n[l].gutter.style.left=o);var s=n[l].alignable;if(s)for(var a=0;a<s.length;a++)s[a].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function F(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=U(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var r=i.measure.appendChild(wo("div",[wo("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,l=r.offsetWidth-o;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(o,i.lineGutter.offsetWidth-l)+1,i.lineNumWidth=i.lineNumInnerWidth+l,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",M(e),!0}return!1}function U(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function G(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function V(e,t,n){var i=e.display;this.viewport=t,this.visible=B(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=rt(e),this.force=n,this.dims=Z(e),this.events=[]}function j(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return Yt(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==$t(e))return!1;F(e)&&(Yt(e),t.dims=Z(e));var r=i.first+i.size,l=Math.max(t.visible.from-e.options.viewportMargin,i.first),s=Math.min(r,t.visible.to+e.options.viewportMargin);n.viewFrom<l&&l-n.viewFrom<20&&(l=Math.max(i.first,n.viewFrom)),n.viewTo>s&&n.viewTo-s<20&&(s=Math.min(r,n.viewTo)),b&&(l=Ai(e.doc,l),s=Ni(e.doc,s));var a=l!=n.viewFrom||s!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;!function(e,t,n){var i=e.display;0==i.view.length||t>=i.viewTo||n<=i.viewFrom?(i.view=Vt(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=Vt(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(Kt(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(Vt(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,Kt(e,n))));i.viewTo=n}(e,l,s),n.viewOffset=yr(fr(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var c=$t(e);if(!a&&0==c&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var u=Co();return c>4&&(n.lineDiv.style.display="none"),function(e,t,n){var i=e.display,r=e.options.lineNumbers,l=i.lineDiv,s=l.firstChild;function a(t){var n=t.nextSibling;return o&&p&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var c=i.view,u=i.viewFrom,d=0;d<c.length;d++){var f=c[d];if(f.hidden);else if(f.node&&f.node.parentNode==l){for(;s!=f.node;)s=a(s);var h=r&&null!=t&&t<=u&&f.lineNumber;f.changes&&(oo(f.changes,"gutter")>-1&&(h=!1),Q(e,f,u,n)),h&&(bo(f.lineNumber),f.lineNumber.appendChild(document.createTextNode(U(e.options,u)))),s=f.node.nextSibling}else{var g=oe(e,f,u,n);l.insertBefore(g,s)}u+=f.size}for(;s;)s=a(s)}(e,n.updateLineNumbers,t.dims),c>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,u&&Co()!=u&&u.offsetHeight&&u.focus(),bo(n.cursorDiv),bo(n.selectionDiv),n.gutters.style.height=0,a&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,Ze(e,400)),n.updateLineNumbers=null,!0}function X(e,t){t.force;for(var n=t.viewport,i=!0;;i=!1){if(i&&e.options.lineWrapping&&t.oldDisplayWidth!=rt(e))!0;else if(!1,n&&null!=n.top&&(n={top:Math.min(e.doc.height+tt(e.display)-ot(e),n.top)}),t.visible=B(e.display,e.doc,n),t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)break;if(!j(e,t))break;q(e);var r=D(e);Xe(e),K(e,r),z(e,r)}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Y(e,t){var n=new V(e,t);if(j(e,n)){q(e),X(e,n);var i=D(e);Xe(e),K(e,i),z(e,i),n.finish()}}function K(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";var n=t.docHeight+e.display.barHeight;e.display.heightForcer.style.top=n+"px",e.display.gutters.style.height=Math.max(n+it(e),t.clientHeight)+"px"}function q(e){for(var t=e.display,n=t.lineDiv.offsetTop,o=0;o<t.view.length;o++){var l,s=t.view[o];if(!s.hidden){if(i&&r<8){var a=s.node.offsetTop+s.node.offsetHeight;l=a-n,n=a}else{var c=s.node.getBoundingClientRect();l=c.bottom-c.top}var u=s.line.height-l;if(l<2&&(l=Tt(t)),(u>.001||u<-.001)&&(gr(s.line,l),$(s.line),s.rest))for(var d=0;d<s.rest.length;d++)$(s.rest[d])}}}function $(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.offsetHeight}function Z(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,o=t.gutters.firstChild,l=0;o;o=o.nextSibling,++l)n[e.options.gutters[l]]=o.offsetLeft+o.clientLeft+r,i[e.options.gutters[l]]=o.clientWidth;return{fixedPos:G(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function Q(e,t,n,i){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?te(e,t):"gutter"==o?ie(e,t,n,i):"class"==o?ne(t):"widget"==o&&re(e,t,i)}t.changes=null}function J(e){return e.node==e.text&&(e.node=wo("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),i&&r<8&&(e.node.style.zIndex=2)),e.node}function ee(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):$i(e,t)}function te(e,t){var n=t.text.className,i=ee(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,ne(t)):n&&(t.text.className=n)}function ne(e){!function(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=J(e);e.background=n.insertBefore(wo("div",null,t),n.firstChild)}}(e),e.line.wrapClass?J(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function ie(e,t,n,i){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null);var r=t.line.gutterMarkers;if(e.options.lineNumbers||r){var o=J(t),l=t.gutter=wo("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px");if(e.display.input.setUneditable(l),o.insertBefore(l,t.text),t.line.gutterClass&&(l.className+=" "+t.line.gutterClass),!e.options.lineNumbers||r&&r["CodeMirror-linenumbers"]||(t.lineNumber=l.appendChild(wo("div",U(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),r)for(var s=0;s<e.options.gutters.length;++s){var a=e.options.gutters[s],c=r.hasOwnProperty(a)&&r[a];c&&l.appendChild(wo("div",[c],"CodeMirror-gutter-elt","left: "+i.gutterLeft[a]+"px; width: "+i.gutterWidth[a]+"px"))}}}function re(e,t,n){t.alignable&&(t.alignable=null);for(var i=t.node.firstChild;i;i=r){var r=i.nextSibling;"CodeMirror-linewidget"==i.className&&t.node.removeChild(i)}le(e,t,n)}function oe(e,t,n,i){var r=ee(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),ne(t),ie(e,t,n,i),le(e,t,i),t.node}function le(e,t,n){if(se(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)se(e,t.rest[i],t,n,!1)}function se(e,t,n,i,r){if(t.widgets)for(var o=J(n),l=0,s=t.widgets;l<s.length;++l){var a=s[l],c=wo("div",[a.node],"CodeMirror-linewidget");a.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),ae(a,c,n,i),e.display.input.setUneditable(c),r&&a.above?o.insertBefore(c,n.gutter||n.text):o.appendChild(c),Fr(a,"redraw")}}function ae(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var r=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(r-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}O.prototype=co({update:function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var r=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?i:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedOverlay&&e.clientHeight>0&&(0==i&&this.overlayHack(),this.checkedOverlay=!0),{right:n?i:0,bottom:t?i:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e)},overlayHack:function(){var e=p&&!u?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=e;var t=this,n=function(e){Ir(e)!=t.vert&&Ir(e)!=t.horiz&&Rt(t.cm,en)(e)};zr(this.vert,"mousedown",n),zr(this.horiz,"mousedown",n)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},O.prototype),I.prototype=co({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},I.prototype),x.scrollbarModel={native:O,null:I},V.prototype.signal=function(e,t){jr(e,t)&&this.events.push(arguments)},V.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Br.apply(null,this.events[e])};var ce=x.Pos=function(e,t){if(!(this instanceof ce))return new ce(e,t);this.line=e,this.ch=t},ue=x.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch};function de(e){return ce(e.line,e.ch)}function fe(e,t){return ue(e,t)<0?t:e}function he(e,t){return ue(e,t)<0?e:t}function pe(e){e.state.focused||(e.display.input.focus(),bn(e))}function ge(e){return e.options.readOnly||e.doc.cantEdit}var me=null;function ve(e,t,n,i,r){var o=e.doc;e.display.shift=!1,i||(i=o.sel);var l=Ho(t),s=null;e.state.pasteIncoming&&i.ranges.length>1&&(me&&me.join("\n")==t?s=i.ranges.length%me.length==0&&lo(me,Ho):l.length==i.ranges.length&&(s=lo(l,function(e){return[e]})));for(var a=i.ranges.length-1;a>=0;a--){var c=i.ranges[a],u=c.from(),d=c.to();c.empty()&&(n&&n>0?u=ce(u.line,u.ch-n):e.state.overwrite&&!e.state.pasteIncoming&&(d=ce(d.line,Math.min(fr(o,d.line).text.length,d.ch+io(l).length))));var f=e.curOp.updateInput,h={from:u,to:d,text:s?s[a%s.length]:l,origin:r||(e.state.pasteIncoming?"paste":e.state.cutIncoming?"cut":"+input")};if(_n(e.doc,h),Fr(e,"inputRead",e,h),t&&!e.state.pasteIncoming&&e.options.electricChars&&e.options.smartIndent&&c.head.ch<100&&(!a||i.ranges[a-1].head.line!=c.head.line)){var p=e.getModeAt(c.head),g=Cn(h),m=!1;if(p.electricChars){for(var v=0;v<p.electricChars.length;v++)if(t.indexOf(p.electricChars.charAt(v))>-1){m=Pn(e,g.line,"smart");break}}else p.electricInput&&p.electricInput.test(fr(o,g.line).text.slice(0,g.ch))&&(m=Pn(e,g.line,"smart"));m&&Fr(e,"electricInput",e,g.line)}}Hn(e),e.curOp.updateInput=f,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function ye(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,o={anchor:ce(r,0),head:ce(r+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}}function we(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function be(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Qr,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function xe(){var e=wo("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=wo("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return o?e.style.width="1000px":e.setAttribute("wrap","off"),f&&(e.style.border="1px solid black"),we(e),t}function Le(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Qr,this.gracePeriod=!1}function Ce(e,t){var n=at(e,t.line);if(!n||n.hidden)return null;var i=fr(e.doc,t.line),r=lt(n,i,t.line),o=wr(i);o&&qo(o,t.ch);var l=ht(r.map,t.ch,"left");return l.offset="right"==l.collapse?l.end:l.start,l}function Se(e,t){return t&&(e.bad=!0),e}function ke(e,t,n){var i;if(t==e.display.lineDiv){if(!(i=e.display.lineDiv.childNodes[n]))return Se(e.clipPos(ce(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var o=e.display.view[r];if(o.node==i)return Ee(o,t,n)}}function Ee(e,t,n){var i=e.text.firstChild,r=!1;if(!t||!Lo(i,t))return Se(ce(mr(e.line),0),!0);if(t==i&&(r=!0,t=i.childNodes[n],n=0,!t)){var o=e.rest?io(e.rest):e.line;return Se(ce(mr(o),o.text.length),r)}var l=3==t.nodeType?t:null,s=t;for(l||1!=t.childNodes.length||3!=t.firstChild.nodeType||(l=t.firstChild,n&&(n=l.nodeValue.length));s.parentNode!=i;)s=s.parentNode;var a=e.measure,c=a.maps;function u(t,n,i){for(var r=-1;r<(c?c.length:0);r++)for(var o=r<0?a.map:c[r],l=0;l<o.length;l+=3){var s=o[l+2];if(s==t||s==n){var u=mr(r<0?e.line:e.rest[r]),d=o[l]+i;return(i<0||s!=t)&&(d=o[l+(i?1:0)]),ce(u,d)}}}var d=u(l,s,n);if(d)return Se(d,r);for(var f=s.nextSibling,h=l?l.nodeValue.length-n:0;f;f=f.nextSibling){if(d=u(f,f.firstChild,0))return Se(ce(d.line,d.ch-h),r);h+=f.textContent.length}var p=s.previousSibling;for(h=n;p;p=p.previousSibling){if(d=u(p,p.firstChild,-1))return Se(ce(d.line,d.ch+h),r);h+=f.textContent.length}}function Te(e,t){this.ranges=e,this.primIndex=t}function _e(e,t){this.anchor=e,this.head=t}function Me(e,t){var n=e[t];e.sort(function(e,t){return ue(e.from(),t.from())}),t=oo(e,n);for(var i=1;i<e.length;i++){var r=e[i],o=e[i-1];if(ue(o.to(),r.from())>=0){var l=he(o.from(),r.from()),s=fe(o.to(),r.to()),a=o.empty()?r.from()==r.head:o.from()==o.head;i<=t&&--t,e.splice(--i,2,new _e(a?s:l,a?l:s))}}return new Te(e,t)}function Ae(e,t){return new Te([new _e(e,t||e)],0)}function Ne(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function We(e,t){if(t.line<e.first)return ce(e.first,0);var n=e.first+e.size-1;return t.line>n?ce(n,fr(e,n).text.length):function(e,t){var n=e.ch;return null==n||n>t?ce(e.line,t):n<0?ce(e.line,0):e}(t,fr(e,t.line).text.length)}function De(e,t){return t>=e.first&&t<e.first+e.size}function Oe(e,t,n,i){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(i){var o=ue(n,r)<0;o!=ue(i,r)<0?(r=n,n=i):o!=ue(n,i)<0&&(n=i)}return new _e(r,n)}return new _e(i||n,n)}function Ie(e,t,n,i){Re(e,new Te([Oe(e,e.sel.primary(),t,n)],0),i)}function He(e,t,n){for(var i=[],r=0;r<e.sel.ranges.length;r++)i[r]=Oe(e,e.sel.ranges[r],t[r],null);Re(e,Me(i,e.sel.primIndex),n)}function ze(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,Re(e,Me(r,e.sel.primIndex),i)}function Pe(e,t,n,i){Re(e,Ae(t,n),i)}function Be(e,t,n){var i=e.history.done,r=io(i);r&&r.ranges?(i[i.length-1]=t,Fe(e,t,n)):Re(e,t,n)}function Re(e,t,n){Fe(e,t,n),function(e,t,n,i){var r=e.history,o=i&&i.origin;n==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||function(e,t,n,i){var r=t.charAt(0);return"*"==r||"+"==r&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}(e,o,io(r.done),t))?r.done[r.done.length-1]=t:Sr(t,r.done);r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=n,i&&!1!==i.clearRedo&&Lr(r.undone)}(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Fe(e,t,n){(jr(e,"beforeSelectionChange")||e.cm&&jr(e.cm,"beforeSelectionChange"))&&(t=function(e,t){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new _e(We(e,t[n].anchor),We(e,t[n].head))}};return Br(e,"beforeSelectionChange",e,n),e.cm&&Br(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?Me(n.ranges,n.ranges.length-1):t}(e,t)),Ue(e,Ve(e,t,n&&n.bias||(ue(t.primary().head,e.sel.primary().head)<0?-1:1),!0)),n&&!1===n.scroll||!e.cm||Hn(e.cm)}function Ue(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Vr(e.cm)),Fr(e,"cursorActivity",e))}function Ge(e){Ue(e,Ve(e,e.sel,null,!1))}function Ve(e,t,n,i){for(var r,o=0;o<t.ranges.length;o++){var l=t.ranges[o],s=je(e,l.anchor,n,i),a=je(e,l.head,n,i);(r||s!=l.anchor||a!=l.head)&&(r||(r=t.ranges.slice(0,o)),r[o]=new _e(s,a))}return r?Me(r,t.primIndex):t}function je(e,t,n,i){var r=!1,o=t,l=n||1;e.cantEdit=!1;e:for(;;){var s=fr(e,o.line);if(s.markedSpans)for(var a=0;a<s.markedSpans.length;++a){var c=s.markedSpans[a],u=c.marker;if((null==c.from||(u.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(u.inclusiveRight?c.to>=o.ch:c.to>o.ch))){if(i&&(Br(u,"beforeCursorEnter"),u.explicitlyCleared)){if(s.markedSpans){--a;continue}break}if(!u.atomic)continue;var d=u.find(l<0?-1:1);if(0==ue(d,o)&&(d.ch+=l,d.ch<0?d=d.line>e.first?We(e,ce(d.line-1)):null:d.ch>s.text.length&&(d=d.line<e.first+e.size-1?ce(d.line+1,0):null),!d)){if(r)return i?(e.cantEdit=!0,ce(e.first,0)):je(e,t,n,!0);r=!0,d=t,l=-l}o=d;continue e}}return o}}function Xe(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Ye(e,t){for(var n=e.doc,i={},r=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),l=0;l<n.sel.ranges.length;l++)if(!1!==t||l!=n.sel.primIndex){var s=n.sel.ranges[l],a=s.empty();(a||e.options.showCursorWhenSelecting)&&Ke(e,s,r),a||qe(e,s,o)}return i}function Ke(e,t,n){var i=Lt(e,t.head,"div",null,null,!e.options.singleCursorHeightPerLine),r=n.appendChild(wo("div","","CodeMirror-cursor"));if(r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",i.other){var o=n.appendChild(wo("div","","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=i.other.left+"px",o.style.top=i.other.top+"px",o.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function qe(e,t,n){var i=e.display,r=e.doc,o=document.createDocumentFragment(),l=nt(e.display),s=l.left,a=Math.max(i.sizerWidth,rt(e)-i.sizer.offsetLeft)-l.right;function c(e,t,n,i){t<0&&(t=0),t=Math.round(t),i=Math.round(i),o.appendChild(wo("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?a-e:n)+"px; height: "+(i-t)+"px"))}function u(t,n,i){var o,l,u=fr(r,t),d=u.text.length;function f(n,i){return xt(e,ce(t,n),"div",u,i)}return function(e,t,n,i){if(!e)return i(t,n,"ltr");for(var r=!1,o=0;o<e.length;++o){var l=e[o];(l.from<n&&l.to>t||t==n&&l.to==t)&&(i(Math.max(l.from,t),Math.min(l.to,n),1==l.level?"rtl":"ltr"),r=!0)}r||i(t,n,"ltr")}(wr(u),n||0,null==i?d:i,function(e,t,r){var u,h,p,g=f(e,"left");if(e==t)u=g,h=p=g.left;else{if(u=f(t-1,"right"),"rtl"==r){var m=g;g=u,u=m}h=g.left,p=u.right}null==n&&0==e&&(h=s),u.top-g.top>3&&(c(h,g.top,null,g.bottom),h=s,g.bottom<u.top&&c(h,g.bottom,null,u.top)),null==i&&t==d&&(p=a),(!o||g.top<o.top||g.top==o.top&&g.left<o.left)&&(o=g),(!l||u.bottom>l.bottom||u.bottom==l.bottom&&u.right>l.right)&&(l=u),h<s+1&&(h=s),c(h,u.top,p-h,u.bottom)}),{start:o,end:l}}var d=t.from(),f=t.to();if(d.line==f.line)u(d.line,d.ch,f.ch);else{var h=fr(r,d.line),p=fr(r,f.line),g=Mi(h)==Mi(p),m=u(d.line,d.ch,g?h.text.length+1:null).end,v=u(f.line,g?0:null,f.ch).start;g&&(m.top<v.top-2?(c(m.right,m.top,null,m.bottom),c(s,v.top,v.left,v.bottom)):c(m.right,m.top,v.left-m.right,m.bottom)),m.bottom<v.top&&c(s,m.bottom,null,v.top)}n.appendChild(o)}function $e(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Ze(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,uo(Qe,e))}function Qe(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=Qn(t.mode,Je(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var l=o.styles,s=Vi(e,o,i,!0);o.styles=s.styles;var a=o.styleClasses,c=s.classes;c?o.styleClasses=c:a&&(o.styleClasses=null);for(var u=!l||l.length!=o.styles.length||a!=c&&(!a||!c||a.bgClass!=c.bgClass||a.textClass!=c.textClass),d=0;!u&&d<l.length;++d)u=l[d]!=o.styles[d];u&&r.push(t.frontier),o.stateAfter=Qn(t.mode,i)}else Xi(e,o.text,i),o.stateAfter=t.frontier%5==0?Qn(t.mode,i):null;if(++t.frontier,+new Date>n)return Ze(e,e.options.workDelay),!0}),r.length&&Bt(e,function(){for(var t=0;t<r.length;t++)Xt(e,r[t],"text")})}}function Je(e,t,n){var i=e.doc,r=e.display;if(!i.mode.startState)return!0;var o=function(e,t,n){for(var i,r,o=e.doc,l=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>l;--s){if(s<=o.first)return o.first;var a=fr(o,s-1);if(a.stateAfter&&(!n||s<=o.frontier))return s;var c=Jr(a.text,null,e.options.tabSize);(null==r||i>c)&&(r=s-1,i=c)}return r}(e,t,n),l=o>i.first&&fr(i,o-1).stateAfter;return l=l?Qn(i.mode,l):Jn(i.mode),i.iter(o,t,function(n){Xi(e,n.text,l);var s=o==t-1||o%5==0||o>=r.viewFrom&&o<r.viewTo;n.stateAfter=s?Qn(i.mode,l):null,++o}),n&&(i.frontier=o),l}function et(e){return e.lineSpace.offsetTop}function tt(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function nt(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=xo(e.measure,wo("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function it(e){return Yr-e.display.nativeBarWidth}function rt(e){return e.display.scroller.clientWidth-it(e)-e.display.barWidth}function ot(e){return e.display.scroller.clientHeight-it(e)-e.display.barHeight}function lt(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(i=0;i<e.rest.length;i++)if(mr(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function st(e,t,n,i){return ut(e,ct(e,t),n,i)}function at(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Kt(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function ct(e,t){var n=mr(t),i=at(e,n);i&&!i.text?i=null:i&&i.changes&&Q(e,i,n,Z(e)),i||(i=function(e,t){var n=mr(t=Mi(t)),i=e.display.externalMeasured=new Gt(e.doc,t,n);i.lineN=n;var r=i.built=$i(e,i);return i.text=r.pre,xo(e.display.lineMeasure,r.pre),i}(e,t));var r=lt(i,t,n);return{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function ut(e,t,n,o,l){t.before&&(n=-1);var s,a=n+(o||"");return t.cache.hasOwnProperty(a)?s=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(!function(e,t,n){var i=e.options.lineWrapping,r=i&&rt(e);if(!t.measure.heights||i&&t.measure.width!=r){var o=t.measure.heights=[];if(i){t.measure.width=r;for(var l=t.text.firstChild.getClientRects(),s=0;s<l.length-1;s++){var a=l[s],c=l[s+1];Math.abs(a.bottom-c.bottom)>2&&o.push((a.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}(e,t.view,t.rect),t.hasHeights=!0),(s=function(e,t,n,o){var l,s=ht(t.map,n,o),a=s.node,c=s.start,u=s.end,d=s.collapse;if(3==a.nodeType){for(var f=0;f<4;f++){for(;c&&yo(t.line.text.charAt(s.coverStart+c));)--c;for(;s.coverStart+u<s.coverEnd&&yo(t.line.text.charAt(s.coverStart+u));)++u;if(i&&r<9&&0==c&&u==s.coverEnd-s.coverStart)l=a.parentNode.getBoundingClientRect();else if(i&&e.options.lineWrapping){var h=mo(a,c,u).getClientRects();l=h.length?h["right"==o?h.length-1:0]:ft}else l=mo(a,c,u).getBoundingClientRect()||ft;if(l.left||l.right||0==c)break;u=c,c-=1,d="right"}i&&r<11&&(l=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=Bo)return Bo;var t=xo(e,wo("span","x")),n=t.getBoundingClientRect(),i=mo(t,0,1).getBoundingClientRect();return Bo=Math.abs(n.left-i.left)>1}(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}(e.display.measure,l))}else{c>0&&(d=o="right"),l=e.options.lineWrapping&&(h=a.getClientRects()).length>1?h["right"==o?h.length-1:0]:a.getBoundingClientRect()}if(i&&r<9&&!c&&(!l||!l.left&&!l.right)){var p=a.parentNode.getClientRects()[0];l=p?{left:p.left,right:p.left+_t(e.display),top:p.top,bottom:p.bottom}:ft}for(var g=l.top-t.rect.top,m=l.bottom-t.rect.top,v=(g+m)/2,y=t.view.measure.heights,f=0;f<y.length-1&&!(v<y[f]);f++);var w=f?y[f-1]:0,b=y[f],x={left:("right"==d?l.right:l.left)-t.rect.left,right:("left"==d?l.left:l.right)-t.rect.left,top:w,bottom:b};l.left||l.right||(x.bogus=!0);e.options.singleCursorHeightPerLine||(x.rtop=g,x.rbottom=m);return x}(e,t,n,o)).bogus||(t.cache[a]=s)),{left:s.left,right:s.right,top:l?s.rtop:s.top,bottom:l?s.rbottom:s.bottom}}be.prototype=co({init:function(e){var t=this,n=this.cm,l=this.wrapper=xe(),s=this.textarea=l.firstChild;function a(e){if(n.somethingSelected())me=n.getSelections(),t.inaccurateSelection&&(t.prevInput="",t.inaccurateSelection=!1,s.value=me.join("\n"),ro(s));else{if(!n.options.lineWiseCopyCut)return;var i=ye(n);me=i.text,"cut"==e.type?n.setSelections(i.ranges,null,qr):(t.prevInput="",s.value=i.text.join("\n"),ro(s))}"cut"==e.type&&(n.state.cutIncoming=!0)}e.wrapper.insertBefore(l,e.wrapper.firstChild),f&&(s.style.width="0px"),zr(s,"input",function(){i&&r>=9&&t.hasSelection&&(t.hasSelection=null),t.poll()}),zr(s,"paste",function(){if(o&&!n.state.fakedLastChar&&!(new Date-n.state.lastMiddleDown<200)){var e=s.selectionStart,i=s.selectionEnd;s.value+="$",s.selectionEnd=i,s.selectionStart=e,n.state.fakedLastChar=!0}n.state.pasteIncoming=!0,t.fastPoll()}),zr(s,"cut",a),zr(s,"copy",a),zr(e.scroller,"paste",function(i){Qt(e,i)||(n.state.pasteIncoming=!0,t.focus())}),zr(e.lineSpace,"selectstart",function(t){Qt(e,t)||Nr(t)}),zr(s,"compositionstart",function(){var e=n.getCursor("from");t.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),zr(s,"compositionend",function(){t.composing&&(t.poll(),t.composing.range.clear(),t.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,n=e.doc,i=Ye(e);if(e.options.moveInputWithCursor){var r=Lt(e,n.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),l=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+l.top-o.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+l.left-o.left))}return i},showSelection:function(e){var t=this.cm.display;xo(t.cursorDiv,e.cursors),xo(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,n,o=this.cm,l=o.doc;if(o.somethingSelected()){this.prevInput="";var s=l.sel.primary(),a=(t=Po&&(s.to().line-s.from().line>100||(n=o.getSelection()).length>1e3))?"-":n||o.getSelection();this.textarea.value=a,o.state.focused&&ro(this.textarea),i&&r>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",i&&r>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!h||Co()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,function n(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,n))})},poll:function(){var e=this.cm,t=this.textarea,n=this.prevInput;if(!e.state.focused||zo(t)&&!n||ge(e)||e.options.disableInput||e.state.keySeq)return!1;e.state.pasteIncoming&&e.state.fakedLastChar&&(t.value=t.value.substring(0,t.value.length-1),e.state.fakedLastChar=!1);var o=t.value;if(o==n&&!e.somethingSelected())return!1;if(i&&r>=9&&this.hasSelection===o||p&&/[\uf700-\uf7ff]/.test(o))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var l=o.charCodeAt(0);if(8203!=l||n||(n=""),8666==l)return this.reset(),this.cm.execCommand("undo")}for(var s=0,a=Math.min(n.length,o.length);s<a&&n.charCodeAt(s)==o.charCodeAt(s);)++s;var c=this;return Bt(e,function(){ve(e,o.slice(s),n.length-s,null,c.composing?"*compose":null),o.length>1e3||o.indexOf("\n")>-1?t.value=c.prevInput="":c.prevInput=o,c.composing&&(c.composing.range.clear(),c.composing.range=e.markText(c.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){i&&r>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){var t=this,n=t.cm,l=n.display,s=t.textarea,c=Jt(n,e),u=l.scroller.scrollTop;if(c&&!a){n.options.resetSelectionOnContextMenu&&-1==n.doc.sel.contains(c)&&Rt(n,Re)(n.doc,Ae(c),qr);var d=s.style.cssText;if(t.wrapper.style.position="absolute",s.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(i?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",o)var f=window.scrollY;if(l.input.focus(),o&&window.scrollTo(null,f),l.input.reset(),n.somethingSelected()||(s.value=t.prevInput=" "),t.contextMenuPending=!0,l.selForContextMenu=n.doc.sel,clearTimeout(l.detectingSelectAll),i&&r>=9&&p(),y){Or(e);var h=function(){Pr(window,"mouseup",h),setTimeout(g,20)};zr(window,"mouseup",h)}else setTimeout(g,50)}function p(){if(null!=s.selectionStart){var e=n.somethingSelected(),i=""+(e?s.value:"");s.value="",s.value=i,t.prevInput=e?"":"",s.selectionStart=1,s.selectionEnd=i.length,l.selForContextMenu=n.doc.sel}}function g(){if(t.contextMenuPending=!1,t.wrapper.style.position="relative",s.style.cssText=d,i&&r<9&&l.scrollbars.setScrollTop(l.scroller.scrollTop=u),null!=s.selectionStart){(!i||i&&r<9)&&p();var e=0,o=function(){l.selForContextMenu==n.doc.sel&&0==s.selectionStart&&s.selectionEnd>0&&""==t.prevInput?Rt(n,ei.selectAll)(n):e++<10?l.detectingSelectAll=setTimeout(o,500):l.input.reset()};l.detectingSelectAll=setTimeout(o,200)}}},setUneditable:so,needsContentAttribute:!1},be.prototype),Le.prototype=co({init:function(e){var t=this,n=t.cm,i=t.div=e.lineDiv;function r(e){if(n.somethingSelected())me=n.getSelections(),"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=ye(n);me=t.text,"cut"==e.type&&n.operation(function(){n.setSelections(t.ranges,0,qr),n.replaceSelection("",null,"cut")})}if(e.clipboardData&&!f)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",me.join("\n"));else{var i=xe(),r=i.firstChild;n.display.lineSpace.insertBefore(i,n.display.lineSpace.firstChild),r.value=me.join("\n");var o=document.activeElement;ro(r),setTimeout(function(){n.display.lineSpace.removeChild(i),o.focus()},50)}}i.contentEditable="true",we(i),zr(i,"paste",function(e){var t=e.clipboardData&&e.clipboardData.getData("text/plain");t&&(e.preventDefault(),n.replaceSelection(t,null,"paste"))}),zr(i,"compositionstart",function(e){var i=e.data;if(t.composing={sel:n.doc.sel,data:i,startData:i},i){var r=n.doc.sel.primary(),o=n.getLine(r.head.line).indexOf(i,Math.max(0,r.head.ch-i.length));o>-1&&o<=r.head.ch&&(t.composing.sel=Ae(ce(r.head.line,o),ce(r.head.line,o+i.length)))}}),zr(i,"compositionupdate",function(e){t.composing.data=e.data}),zr(i,"compositionend",function(e){var n=t.composing;n&&(e.data==n.startData||/\u200b/.test(e.data)||(n.data=e.data),setTimeout(function(){n.handled||t.applyComposition(n),t.composing==n&&(t.composing=null)},50))}),zr(i,"touchstart",function(){t.forceCompositionEnd()}),zr(i,"input",function(){t.composing||t.pollContent()||Bt(t.cm,function(){jt(n)})}),zr(i,"copy",r),zr(i,"cut",r)},prepareSelection:function(){var e=Ye(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e){e&&this.cm.display.view.length&&(e.focus&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var t=window.getSelection(),n=this.cm.doc.sel.primary(),i=ke(this.cm,t.anchorNode,t.anchorOffset),r=ke(this.cm,t.focusNode,t.focusOffset);if(!i||i.bad||!r||r.bad||0!=ue(he(i,r),n.from())||0!=ue(fe(i,r),n.to())){var o=Ce(this.cm,n.from()),l=Ce(this.cm,n.to());if(o||l){var s=this.cm.display.view,a=t.rangeCount&&t.getRangeAt(0);if(o){if(!l){var c=s[s.length-1].measure,u=c.maps?c.maps[c.maps.length-1]:c.map;l={node:u[u.length-1],offset:u[u.length-2]-u[u.length-3]}}}else o={node:s[0].measure.map[2],offset:0};try{var d=mo(o.node,o.offset,l.offset,l.node)}catch(e){}d&&(t.removeAllRanges(),t.addRange(d),a&&null==t.anchorNode?t.addRange(a):e&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){xo(this.cm.display.cursorDiv,e.cursors),xo(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Lo(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){var e=this;this.selectionInEditor()?this.pollSelection():Bt(this.cm,function(){e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))})},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var n=ke(t,e.anchorNode,e.anchorOffset),i=ke(t,e.focusNode,e.focusOffset);n&&i&&Bt(t,function(){Re(t.doc,Ae(n,i),qr),(n.bad||i.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e,t=this.cm,n=t.display,i=t.doc.sel.primary(),r=i.from(),o=i.to();if(r.line<n.viewFrom||o.line>n.viewTo-1)return!1;if(r.line==n.viewFrom||0==(e=Kt(t,r.line)))var l=mr(n.view[0].line),s=n.view[0].node;else l=mr(n.view[e].line),s=n.view[e-1].node.nextSibling;var a=Kt(t,o.line);if(a==n.view.length-1)var c=n.viewTo-1,u=n.view[a].node;else c=mr(n.view[a+1].line)-1,u=n.view[a+1].node.previousSibling;for(var d=Ho(function(e,t,n,i,r){var o="",l=!1;function s(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(null!=n)return""==n&&(n=t.textContent.replace(/\u200b/g,"")),void(o+=n);var a,c=t.getAttribute("cm-marker");if(c){var u=e.findMarks(ce(i,0),ce(r+1,0),(h=+c,function(e){return e.id==h}));return void(u.length&&(a=u[0].find())&&(o+=hr(e.doc,a.from,a.to).join("\n")))}if("false"==t.getAttribute("contenteditable"))return;for(var d=0;d<t.childNodes.length;d++)s(t.childNodes[d]);/^(pre|div|p)$/i.test(t.nodeName)&&(l=!0)}else if(3==t.nodeType){var f=t.nodeValue;if(!f)return;l&&(o+="\n",l=!1),o+=f}var h}for(;s(t),t!=n;)t=t.nextSibling;return o}(t,s,u,l,c)),f=hr(t.doc,ce(l,0),ce(c,fr(t.doc,c).text.length));d.length>1&&f.length>1;)if(io(d)==io(f))d.pop(),f.pop(),c--;else{if(d[0]!=f[0])break;d.shift(),f.shift(),l++}for(var h=0,p=0,g=d[0],m=f[0],v=Math.min(g.length,m.length);h<v&&g.charCodeAt(h)==m.charCodeAt(h);)++h;for(var y=io(d),w=io(f),b=Math.min(y.length-(1==d.length?h:0),w.length-(1==f.length?h:0));p<b&&y.charCodeAt(y.length-p-1)==w.charCodeAt(w.length-p-1);)++p;d[d.length-1]=y.slice(0,y.length-p),d[0]=d[0].slice(h);var x=ce(l,h),L=ce(c,f.length?io(f).length-p:0);return d.length>1||d[0]||ue(x,L)?(Dn(t.doc,d,x,L,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){e.data&&e.data!=e.startData&&Rt(this.cm,ve)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.setAttribute("contenteditable","false")},onKeyPress:function(e){e.preventDefault(),Rt(this.cm,ve)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},onContextMenu:so,resetPosition:so,needsContentAttribute:!0},Le.prototype),x.inputStyles={textarea:be,contenteditable:Le},Te.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],i=e.ranges[t];if(0!=ue(n.anchor,i.anchor)||0!=ue(n.head,i.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new _e(de(this.ranges[t].anchor),de(this.ranges[t].head));return new Te(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if(ue(t,i.from())>=0&&ue(e,i.to())<=0)return n}return-1}},_e.prototype={from:function(){return he(this.anchor,this.head)},to:function(){return fe(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var dt,ft={left:0,right:0,top:0,bottom:0};function ht(e,t,n){for(var i,r,o,l,s=0;s<e.length;s+=3){var a=e[s],c=e[s+1];if(t<a?(r=0,o=1,l="left"):t<c?o=(r=t-a)+1:(s==e.length-3||t==c&&e[s+3]>t)&&(r=(o=c-a)-1,t>=c&&(l="right")),null!=r){if(i=e[s+2],a==c&&n==(i.insertLeft?"left":"right")&&(l=n),"left"==n&&0==r)for(;s&&e[s-2]==e[s-3]&&e[s-1].insertLeft;)i=e[2+(s-=3)],l="left";if("right"==n&&r==c-a)for(;s<e.length-3&&e[s+3]==e[s+4]&&!e[s+5].insertLeft;)i=e[(s+=3)+2],l="right";break}}return{node:i,start:r,end:o,collapse:l,coverStart:a,coverEnd:c}}function pt(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function gt(e){e.display.externalMeasure=null,bo(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)pt(e.display.view[t])}function mt(e){gt(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function vt(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function yt(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function wt(e,t,n,i){if(t.widgets)for(var r=0;r<t.widgets.length;++r)if(t.widgets[r].above){var o=Hi(t.widgets[r]);n.top+=o,n.bottom+=o}if("line"==i)return n;i||(i="local");var l=yr(t);if("local"==i?l+=et(e.display):l-=e.display.viewOffset,"page"==i||"window"==i){var s=e.display.lineSpace.getBoundingClientRect();l+=s.top+("window"==i?0:yt());var a=s.left+("window"==i?0:vt());n.left+=a,n.right+=a}return n.top+=l,n.bottom+=l,n}function bt(e,t,n){if("div"==n)return t;var i=t.left,r=t.top;if("page"==n)i-=vt(),r-=yt();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();i+=o.left,r+=o.top}var l=e.display.lineSpace.getBoundingClientRect();return{left:i-l.left,top:r-l.top}}function xt(e,t,n,i,r){return i||(i=fr(e.doc,t.line)),wt(e,i,st(e,i,t.ch,r),n)}function Lt(e,t,n,i,r,o){function l(t,l){var s=ut(e,r,t,l?"right":"left",o);return l?s.left=s.right:s.right=s.left,wt(e,i,s,n)}function s(e,t){var n=a[t],i=n.level%2;return e==Uo(n)&&t&&n.level<a[t-1].level?(e=Go(n=a[--t])-(n.level%2?0:1),i=!0):e==Go(n)&&t<a.length-1&&n.level<a[t+1].level&&(e=Uo(n=a[++t])-n.level%2,i=!1),i&&e==n.to&&e>n.from?l(e-1):l(e,i)}i=i||fr(e.doc,t.line),r||(r=ct(e,i));var a=wr(i),c=t.ch;if(!a)return l(c);var u=s(c,qo(a,c));return null!=Ro&&(u.other=s(c,Ro)),u}function Ct(e,t){var n=0;t=We(e.doc,t);e.options.lineWrapping||(n=_t(e.display)*t.ch);var i=fr(e.doc,t.line),r=yr(i)+et(e.display);return{left:n,right:n,top:r,bottom:r+i.height}}function St(e,t,n,i){var r=ce(e,t);return r.xRel=i,n&&(r.outside=!0),r}function kt(e,t,n){var i=e.doc;if((n+=e.display.viewOffset)<0)return St(i.first,0,!0,-1);var r=vr(i,n),o=i.first+i.size-1;if(r>o)return St(i.first+i.size-1,fr(i,o).text.length,!0,1);t<0&&(t=0);for(var l=fr(i,r);;){var s=Et(e,l,r,t,n),a=Ti(l),c=a&&a.find(0,!0);if(!a||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;r=mr(l=c.to.line)}}function Et(e,t,n,i,r){var o=r-yr(t),l=!1,s=2*e.display.wrapper.clientWidth,a=ct(e,t);function c(i){var r=Lt(e,ce(n,i),"line",t,a);return l=!0,o>r.bottom?r.left-s:o<r.top?r.left+s:(l=!1,r.left)}var u=wr(t),d=t.text.length,f=Vo(t),h=jo(t),p=c(f),g=l,m=c(h),v=l;if(i>m)return St(n,h,v,1);for(;;){if(u?h==f||h==Zo(t,f,1):h-f<=1){for(var y=i<p||i-p<=m-i?f:h,w=i-(y==f?p:m);yo(t.text.charAt(y));)++y;return St(n,y,y==f?g:v,w<-1?-1:w>1?1:0)}var b=Math.ceil(d/2),x=f+b;if(u){x=f;for(var L=0;L<b;++L)x=Zo(t,x,1)}var C=c(x);C>i?(h=x,m=C,(v=l)&&(m+=1e3),d=b):(f=x,p=C,g=l,d-=b)}}function Tt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==dt){dt=wo("pre");for(var t=0;t<49;++t)dt.appendChild(document.createTextNode("x")),dt.appendChild(wo("br"));dt.appendChild(document.createTextNode("x"))}xo(e.measure,dt);var n=dt.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),bo(e.measure),n||1}function _t(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=wo("span","xxxxxxxxxx"),n=wo("pre",[t]);xo(e.measure,n);var i=t.getBoundingClientRect(),r=(i.right-i.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}var Mt,At,Nt=null,Wt=0;function Dt(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Wt},Nt?Nt.ops.push(e.curOp):e.curOp.ownsGroup=Nt={ops:[e.curOp],delayedCallbacks:[]}}function Ot(e){var t=e.curOp.ownsGroup;if(t)try{!function(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n]();for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++](r.cm)}}while(n<t.length)}(t)}finally{Nt=null;for(var n=0;n<t.ops.length;n++)t.ops[n].cm.curOp=null;!function(e){for(var t=e.ops,n=0;n<t.length;n++)It(t[n]);for(var n=0;n<t.length;n++)i=t[n],i.updatedDisplay=i.mustUpdate&&j(i.cm,i.update);var i;for(var n=0;n<t.length;n++)Ht(t[n]);for(var n=0;n<t.length;n++)zt(t[n]);for(var n=0;n<t.length;n++)Pt(t[n])}(t)}}function It(e){var t=e.cm,n=t.display;!function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=it(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=it(e)+"px",t.scrollbarsClipped=!0)}(t),e.updateMaxLine&&N(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new V(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function Ht(e){var t=e.cm,n=t.display;e.updatedDisplay&&q(t),e.barMeasure=D(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=st(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+it(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-rt(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}function zt(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&sn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.preparedSelection&&t.display.input.showSelection(e.preparedSelection),e.updatedDisplay&&K(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&z(t,e.barMeasure),e.selectionChanged&&$e(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),e.focus&&e.focus==Co()&&pe(e.cm)}function Pt(e){var t=e.cm,n=t.display,i=t.doc;if(e.updatedDisplay&&X(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==e.scrollTop||n.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(i.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop)),n.scrollbars.setScrollTop(i.scrollTop),n.scroller.scrollTop=i.scrollTop),null==e.scrollLeft||n.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(i.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-rt(t),e.scrollLeft)),n.scrollbars.setScrollLeft(i.scrollLeft),n.scroller.scrollLeft=i.scrollLeft,R(t)),e.scrollToPos){var r=function(e,t,n,i){null==i&&(i=0);for(var r=0;r<5;r++){var o=!1,l=Lt(e,t),s=n&&n!=t?Lt(e,n):l,a=On(e,Math.min(l.left,s.left),Math.min(l.top,s.top)-i,Math.max(l.left,s.left),Math.max(l.bottom,s.bottom)+i),c=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=a.scrollTop&&(ln(e,a.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(o=!0)),null!=a.scrollLeft&&(sn(e,a.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(o=!0)),!o)break}return l}(t,We(i,e.scrollToPos.from),We(i,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&function(e,t){if(Gr(e,"scrollCursorIntoView"))return;var n=e.display,i=n.sizer.getBoundingClientRect(),r=null;t.top+i.top<0?r=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1);if(null!=r&&!d){var o=wo("div","",null,"position: absolute; top: "+(t.top-n.viewOffset-et(e.display))+"px; height: "+(t.bottom-t.top+it(e)+n.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(r),e.display.lineSpace.removeChild(o)}}(t,r)}var o=e.maybeHiddenMarkers,l=e.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||Br(o[s],"hide");if(l)for(s=0;s<l.length;++s)l[s].lines.length&&Br(l[s],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Br(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Bt(e,t){if(e.curOp)return t();Dt(e);try{return t()}finally{Ot(e)}}function Rt(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Dt(e);try{return t.apply(e,arguments)}finally{Ot(e)}}}function Ft(e){return function(){if(this.curOp)return e.apply(this,arguments);Dt(this);try{return e.apply(this,arguments)}finally{Ot(this)}}}function Ut(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);Dt(t);try{return e.apply(this,arguments)}finally{Ot(t)}}}function Gt(e,t,n){this.line=t,this.rest=function(e){var t,n;for(;t=Ti(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}(t),this.size=this.rest?mr(io(this.rest))-n+1:1,this.node=this.text=null,this.hidden=Wi(e,t)}function Vt(e,t,n){for(var i,r=[],o=t;o<n;o=i){var l=new Gt(e.doc,fr(e.doc,o),o);i=o+l.size,r.push(l)}return r}function jt(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var r=e.display;if(i&&n<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)b&&Ai(e.doc,t)<r.viewTo&&Yt(e);else if(n<=r.viewFrom)b&&Ni(e.doc,n+i)>r.viewFrom?Yt(e):(r.viewFrom+=i,r.viewTo+=i);else if(t<=r.viewFrom&&n>=r.viewTo)Yt(e);else if(t<=r.viewFrom){(o=qt(e,n,n+i,1))?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=i):Yt(e)}else if(n>=r.viewTo){var o;(o=qt(e,t,t,-1))?(r.view=r.view.slice(0,o.index),r.viewTo=o.lineN):Yt(e)}else{var l=qt(e,t,t,-1),s=qt(e,n,n+i,1);l&&s?(r.view=r.view.slice(0,l.index).concat(Vt(e,l.lineN,s.lineN)).concat(r.view.slice(s.index)),r.viewTo+=i):Yt(e)}var a=r.externalMeasured;a&&(n<a.lineN?a.lineN+=i:t<a.lineN+a.size&&(r.externalMeasured=null))}function Xt(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var o=i.view[Kt(e,t)];if(null!=o.node){var l=o.changes||(o.changes=[]);-1==oo(l,n)&&l.push(n)}}}function Yt(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Kt(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,i=0;i<n.length;i++)if((t-=n[i].size)<0)return i}function qt(e,t,n,i){var r,o=Kt(e,t),l=e.display.view;if(!b||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=0,a=e.display.viewFrom;s<o;s++)a+=l[s].size;if(a!=t){if(i>0){if(o==l.length-1)return null;r=a+l[o].size-t,o++}else r=a-t;t+=r,n+=r}for(;Ai(e.doc,n)!=n;){if(o==(i<0?0:l.length-1))return null;n+=i*l[o-(i<0?1:0)].size,o+=i}return{index:o,lineN:n}}function $t(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function Zt(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function Qt(e,t){for(var n=Ir(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function Jt(e,t,n,i){var r=e.display;if(!n&&"true"==Ir(t).getAttribute("cm-not-content"))return null;var o,l,s=r.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,l=t.clientY-s.top}catch(t){return null}var a,c=kt(e,o,l);if(i&&1==c.xRel&&(a=fr(e.doc,c.line).text).length==c.ch){var u=Jr(a,a.length,e.options.tabSize)-a.length;c=ce(c.line,Math.max(0,Math.round((o-nt(e.display).left)/_t(e.display))-u))}return c}function en(e){var t=this,n=t.display;if(!(n.activeTouch&&n.input.supportsTouch()||Gr(t,e)))if(n.shift=e.shiftKey,Qt(n,e))o||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100));else if(!nn(t,e)){var l=Jt(t,e);switch(window.focus(),Hr(e)){case 1:l?function(e,t,n){i?setTimeout(uo(pe,e),0):e.curOp.focus=Co();var l,s=+new Date;At&&At.time>s-400&&0==ue(At.pos,n)?l="triple":Mt&&Mt.time>s-400&&0==ue(Mt.pos,n)?(l="double",At={time:s,pos:n}):(l="single",Mt={time:s,pos:n});var a,c=e.doc.sel,u=p?t.metaKey:t.ctrlKey;e.options.dragDrop&&Wo&&!ge(e)&&"single"==l&&(a=c.contains(n))>-1&&!c.ranges[a].empty()?function(e,t,n,l){var s=e.display,a=+new Date,c=Rt(e,function(u){o&&(s.scroller.draggable=!1),e.state.draggingText=!1,Pr(document,"mouseup",c),Pr(s.scroller,"drop",c),Math.abs(t.clientX-u.clientX)+Math.abs(t.clientY-u.clientY)<10&&(Nr(u),!l&&+new Date-200<a&&Ie(e.doc,n),o||i&&9==r?setTimeout(function(){document.body.focus(),s.input.focus()},20):s.input.focus())});o&&(s.scroller.draggable=!0);e.state.draggingText=c,s.scroller.dragDrop&&s.scroller.dragDrop();zr(document,"mouseup",c),zr(s.scroller,"drop",c)}(e,t,n,u):function(e,t,n,i,r){var o=e.display,l=e.doc;Nr(t);var s,a,c=l.sel,u=c.ranges;r&&!t.shiftKey?(a=l.sel.contains(n),s=a>-1?u[a]:new _e(n,n)):(s=l.sel.primary(),a=l.sel.primIndex);if(t.altKey)i="rect",r||(s=new _e(n,n)),n=Jt(e,t,!0,!0),a=-1;else if("double"==i){var d=e.findWordAt(n);s=e.display.shift||l.extend?Oe(l,s,d.anchor,d.head):d}else if("triple"==i){var f=new _e(ce(n.line,0),We(l,ce(n.line+1,0)));s=e.display.shift||l.extend?Oe(l,s,f.anchor,f.head):f}else s=Oe(l,s,n);r?-1==a?(a=u.length,Re(l,Me(u.concat([s]),a),{scroll:!1,origin:"*mouse"})):u.length>1&&u[a].empty()&&"single"==i&&!t.shiftKey?(Re(l,Me(u.slice(0,a).concat(u.slice(a+1)),0)),c=l.sel):ze(l,a,s,$r):(a=0,Re(l,new Te([s],0),$r),c=l.sel);var h=n;var p=o.wrapper.getBoundingClientRect(),g=0;function m(t){var r=++g,u=Jt(e,t,!0,"rect"==i);if(u)if(0!=ue(u,h)){e.curOp.focus=Co(),function(t){if(0==ue(h,t))return;if(h=t,"rect"==i){for(var r=[],o=e.options.tabSize,u=Jr(fr(l,n.line).text,n.ch,o),d=Jr(fr(l,t.line).text,t.ch,o),f=Math.min(u,d),p=Math.max(u,d),g=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));g<=m;g++){var v=fr(l,g).text,y=eo(v,f,o);f==p?r.push(new _e(ce(g,y),ce(g,y))):v.length>y&&r.push(new _e(ce(g,y),ce(g,eo(v,p,o))))}r.length||r.push(new _e(n,n)),Re(l,Me(c.ranges.slice(0,a).concat(r),a),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var w=s,b=w.anchor,x=t;if("single"!=i){if("double"==i)var L=e.findWordAt(t);else var L=new _e(ce(t.line,0),We(l,ce(t.line+1,0)));ue(L.anchor,b)>0?(x=L.head,b=he(w.from(),L.anchor)):(x=L.anchor,b=fe(w.to(),L.head))}var r=c.ranges.slice(0);r[a]=new _e(We(l,b),x),Re(l,Me(r,a),$r)}}(u);var d=B(o,l);(u.line>=d.to||u.line<d.from)&&setTimeout(Rt(e,function(){g==r&&m(t)}),150)}else{var f=t.clientY<p.top?-20:t.clientY>p.bottom?20:0;f&&setTimeout(Rt(e,function(){g==r&&(o.scroller.scrollTop+=f,m(t))}),50)}}function v(e){g=1/0,Nr(e),o.input.focus(),Pr(document,"mousemove",y),Pr(document,"mouseup",w),l.history.lastSelOrigin=null}var y=Rt(e,function(e){Hr(e)?m(e):v(e)}),w=Rt(e,v);zr(document,"mousemove",y),zr(document,"mouseup",w)}(e,t,n,l,u)}(t,e,l):Ir(e)==n.scroller&&Nr(e);break;case 2:o&&(t.state.lastMiddleDown=+new Date),l&&Ie(t.doc,l),setTimeout(function(){n.input.focus()},20),Nr(e);break;case 3:y?Ln(t,e):function(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,xn(e))},100)}(t)}}}function tn(e,t,n,i,r){try{var o=t.clientX,l=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Nr(t);var s=e.display,a=s.lineDiv.getBoundingClientRect();if(l>a.bottom||!jr(e,n))return Dr(t);l-=a.top-s.viewOffset;for(var c=0;c<e.options.gutters.length;++c){var u=s.gutters.childNodes[c];if(u&&u.getBoundingClientRect().right>=o)return r(e,n,e,vr(e.doc,l),e.options.gutters[c],t),Dr(t)}}function nn(e,t){return tn(e,t,"gutterClick",!0,Fr)}var rn=0;function on(e){var t=this;if(!Gr(t,e)&&!Qt(t.display,e)){Nr(e),i&&(rn=+new Date);var n=Jt(t,e,!0),r=e.dataTransfer.files;if(n&&!ge(t))if(r&&r.length&&window.FileReader&&window.File)for(var o=r.length,l=Array(o),s=0,a=function(e,i){var r=new FileReader;r.onload=Rt(t,function(){if(l[i]=r.result,++s==o){var e={from:n=We(t.doc,n),to:n,text:Ho(l.join("\n")),origin:"paste"};_n(t.doc,e),Be(t.doc,Ae(n,Cn(e)))}}),r.readAsText(e)},c=0;c<o;++c)a(r[c],c);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(function(){t.display.input.focus()},20);try{if(l=e.dataTransfer.getData("Text")){if(t.state.draggingText&&!(p?e.altKey:e.ctrlKey))var u=t.listSelections();if(Fe(t.doc,Ae(n,n)),u)for(c=0;c<u.length;++c)Dn(t.doc,"",u[c].anchor,u[c].head,"drag");t.replaceSelection(l,"around","paste"),t.display.input.focus()}}catch(e){}}}}function ln(t,n){Math.abs(t.doc.scrollTop-n)<2||(t.doc.scrollTop=n,e||Y(t,{top:n}),t.display.scroller.scrollTop!=n&&(t.display.scroller.scrollTop=n),t.display.scrollbars.setScrollTop(n),e&&Y(t),Ze(t,100))}function sn(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,R(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}var an=0,cn=null;i?cn=-.53:e?cn=15:s?cn=-.7:c&&(cn=-1/3);var un=function(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}};function dn(t,n){var i=un(n),r=i.x,l=i.y,s=t.display,c=s.scroller;if(r&&c.scrollWidth>c.clientWidth||l&&c.scrollHeight>c.clientHeight){if(l&&p&&o)e:for(var u=n.target,d=s.view;u!=c;u=u.parentNode)for(var f=0;f<d.length;f++)if(d[f].node==u){t.display.currentWheelTarget=u;break e}if(r&&!e&&!a&&null!=cn)return l&&ln(t,Math.max(0,Math.min(c.scrollTop+l*cn,c.scrollHeight-c.clientHeight))),sn(t,Math.max(0,Math.min(c.scrollLeft+r*cn,c.scrollWidth-c.clientWidth))),Nr(n),void(s.wheelStartX=null);if(l&&null!=cn){var h=l*cn,g=t.doc.scrollTop,m=g+s.wrapper.clientHeight;h<0?g=Math.max(0,g+h-50):m=Math.min(t.doc.height,m+h+50),Y(t,{top:g,bottom:m})}an<20&&(null==s.wheelStartX?(s.wheelStartX=c.scrollLeft,s.wheelStartY=c.scrollTop,s.wheelDX=r,s.wheelDY=l,setTimeout(function(){if(null!=s.wheelStartX){var e=c.scrollLeft-s.wheelStartX,t=c.scrollTop-s.wheelStartY,n=t&&s.wheelDY&&t/s.wheelDY||e&&s.wheelDX&&e/s.wheelDX;s.wheelStartX=s.wheelStartY=null,n&&(cn=(cn*an+n)/(an+1),++an)}},200)):(s.wheelDX+=r,s.wheelDY+=l))}}function fn(e,t,n){if("string"==typeof t&&!(t=ei[t]))return!1;e.display.input.ensurePolled();var i=e.display.shift,r=!1;try{ge(e)&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=Kr}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}x.wheelEventPixels=function(e){var t=un(e);return t.x*=cn,t.y*=cn,t};var hn=new Qr;function pn(e,t,n,i){var r=e.state.keySeq;if(r){if(ri(t))return"handled";hn.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),t=r+" "+t}var o=function(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var r=ii(t,e.state.keyMaps[i],n,e);if(r)return r}return e.options.extraKeys&&ii(t,e.options.extraKeys,n,e)||ii(t,e.options.keyMap,n,e)}(e,t,i);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&Fr(e,"keyHandled",e,t,n),"handled"!=o&&"multi"!=o||(Nr(n),$e(e)),r&&!o&&/\'$/.test(t)?(Nr(n),!0):!!o}function gn(e,t){var n=oi(t,!0);return!!n&&(t.shiftKey&&!e.state.keySeq?pn(e,"Shift-"+n,t,function(t){return fn(e,t,!0)})||pn(e,n,t,function(t){if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return fn(e,t)}):pn(e,n,t,function(t){return fn(e,t)}))}var mn=null;function vn(e){var t=this;if(t.curOp.focus=Co(),!Gr(t,e)){i&&r<11&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var o=gn(t,e);a&&(mn=o?n:null,!o&&88==n&&!Po&&(p?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){var t=e.display.lineDiv;function n(e){18!=e.keyCode&&e.altKey||(ko(t,"CodeMirror-crosshair"),Pr(document,"keyup",n),Pr(document,"mouseover",n))}Eo(t,"CodeMirror-crosshair"),zr(document,"keyup",n),zr(document,"mouseover",n)}(t)}}function yn(e){16==e.keyCode&&(this.doc.sel.shift=!1),Gr(this,e)}function wn(e){var t=this;if(!(Qt(t.display,e)||Gr(t,e)||e.ctrlKey&&!e.altKey||p&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(a&&n==mn)return mn=null,void Nr(e);if(!a||e.which&&!(e.which<10)||!gn(t,e))(function(e,t,n){return pn(e,"'"+n+"'",t,function(t){return fn(e,t,!0)})})(t,e,String.fromCharCode(null==i?n:i))||t.display.input.onKeyPress(e)}}function bn(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Br(e,"focus",e),e.state.focused=!0,Eo(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),o&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),$e(e))}function xn(e){e.state.delayingBlurEvent||(e.state.focused&&(Br(e,"blur",e),e.state.focused=!1,ko(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Ln(e,t){Qt(e.display,t)||function(e,t){return!!jr(e,"gutterContextMenu")&&tn(e,t,"gutterContextMenu",!1,Br)}(e,t)||e.display.input.onContextMenu(t)}var Cn=x.changeEnd=function(e){return e.text?ce(e.from.line+e.text.length-1,io(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};function Sn(e,t){if(ue(e,t.from)<0)return e;if(ue(e,t.to)<=0)return Cn(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=Cn(t).ch-t.to.ch),ce(n,i)}function kn(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new _e(Sn(r.anchor,t),Sn(r.head,t)))}return Me(n,e.sel.primIndex)}function En(e,t,n){return e.line==t.line?ce(n.line,e.ch-t.ch+n.ch):ce(n.line+(e.line-t.line),e.ch)}function Tn(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(i.update=function(t,n,i,r){t&&(this.from=We(e,t)),n&&(this.to=We(e,n)),i&&(this.text=i),void 0!==r&&(this.origin=r)}),Br(e,"beforeChange",e,i),e.cm&&Br(e.cm,"beforeChange",e.cm,i),i.canceled?null:{from:i.from,to:i.to,text:i.text,origin:i.origin}}function _n(e,t,n){if(e.cm){if(!e.cm.curOp)return Rt(e.cm,_n)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(jr(e,"beforeChange")||e.cm&&jr(e.cm,"beforeChange"))||(t=Tn(e,t,!0))){var i=w&&!n&&function(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=oo(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var r=[{from:t,to:n}],o=0;o<i.length;++o)for(var l=i[o],s=l.find(0),a=0;a<r.length;++a){var c=r[a];if(!(ue(c.to,s.from)<0||ue(c.from,s.to)>0)){var u=[a,1],d=ue(c.from,s.from),f=ue(c.to,s.to);(d<0||!l.inclusiveLeft&&!d)&&u.push({from:c.from,to:s.from}),(f>0||!l.inclusiveRight&&!f)&&u.push({from:s.to,to:c.to}),r.splice.apply(r,u),a+=u.length-1}}return r}(e,t.from,t.to);if(i)for(var r=i.length-1;r>=0;--r)Mn(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text});else Mn(e,t)}}function Mn(e,t){if(1!=t.text.length||""!=t.text[0]||0!=ue(t.from,t.to)){var n=kn(e,t);Cr(e,t,n,e.cm?e.cm.curOp.id:NaN),Wn(e,t,n,vi(e,t));var i=[];ur(e,function(e,n){n||-1!=oo(i,e.history)||(Ar(e.history,t),i.push(e.history)),Wn(e,t,null,vi(e,t))})}}function An(e,t,n){if(!e.cm||!e.cm.state.suppressEdits){for(var i,r=e.history,o=e.sel,l="undo"==t?r.done:r.undone,s="undo"==t?r.undone:r.done,a=0;a<l.length&&(i=l[a],n?!i.ranges||i.equals(e.sel):i.ranges);a++);if(a!=l.length){for(r.lastOrigin=r.lastSelOrigin=null;(i=l.pop()).ranges;){if(Sr(i,s),n&&!i.equals(e.sel))return void Re(e,i,{clearRedo:!1});o=i}var c=[];Sr(o,s),s.push({changes:c,generation:r.generation}),r.generation=i.generation||++r.maxGeneration;var u=jr(e,"beforeChange")||e.cm&&jr(e.cm,"beforeChange");for(a=i.changes.length-1;a>=0;--a){var d=i.changes[a];if(d.origin=t,u&&!Tn(e,d,!1))return void(l.length=0);c.push(xr(e,d));var f=a?kn(e,d):io(l);Wn(e,d,f,wi(e,d)),!a&&e.cm&&e.cm.scrollIntoView({from:d.from,to:Cn(d)});var h=[];ur(e,function(e,t){t||-1!=oo(h,e.history)||(Ar(e.history,d),h.push(e.history)),Wn(e,d,null,wi(e,d))})}}}}function Nn(e,t){if(0!=t&&(e.first+=t,e.sel=new Te(lo(e.sel.ranges,function(e){return new _e(ce(e.anchor.line+t,e.anchor.ch),ce(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){jt(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)Xt(e.cm,i,"gutter")}}function Wn(e,t,n,i){if(e.cm&&!e.cm.curOp)return Rt(e.cm,Wn)(e,t,n,i);if(t.to.line<e.first)Nn(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);Nn(e,r),t={from:ce(e.first,0),to:ce(t.to.line+r,t.to.ch),text:[io(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:ce(o,fr(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=hr(e,t.from,t.to),n||(n=kn(e,t)),e.cm?function(e,t,n){var i=e.doc,r=e.display,o=t.from,l=t.to,s=!1,a=o.line;e.options.lineWrapping||(a=mr(Mi(fr(i,o.line))),i.iter(a,l.line+1,function(e){if(e==r.maxLine)return s=!0,!0}));i.sel.contains(t.from,t.to)>-1&&Vr(e);ir(i,t,n,S(e)),e.options.lineWrapping||(i.iter(a,o.line+t.text.length,function(e){var t=A(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,s=!1)}),s&&(e.curOp.updateMaxLine=!0));i.frontier=Math.min(i.frontier,o.line),Ze(e,400);var c=t.text.length-(l.line-o.line)-1;t.full?jt(e):o.line!=l.line||1!=t.text.length||nr(e.doc,t)?jt(e,o.line,l.line+1,c):Xt(e,o.line,"text");var u=jr(e,"changes"),d=jr(e,"change");if(d||u){var f={from:o,to:l,text:t.text,removed:t.removed,origin:t.origin};d&&Fr(e,"change",e,f),u&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}(e.cm,t,i):ir(e,t,i),Fe(e,n,qr)}}function Dn(e,t,n,i,r){if(i||(i=n),ue(i,n)<0){var o=i;i=n,n=o}"string"==typeof t&&(t=Ho(t)),_n(e,{from:n,to:i,text:t,origin:r})}function On(e,t,n,i,r){var o=e.display,l=Tt(e.display);n<0&&(n=0);var s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,a=ot(e),c={};r-n>a&&(r=n+a);var u=e.doc.height+tt(o),d=n<l,f=r>u-l;if(n<s)c.scrollTop=d?0:n;else if(r>s+a){var h=Math.min(n,(f?u:r)-a);h!=s&&(c.scrollTop=h)}var p=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,g=rt(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),m=i-t>g;return m&&(i=t+g),t<10?c.scrollLeft=0:t<p?c.scrollLeft=Math.max(0,t-(m?0:10)):i>g+p-3&&(c.scrollLeft=i+(m?0:10)-g),c}function In(e,t,n){null==t&&null==n||zn(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function Hn(e){zn(e);var t=e.getCursor(),n=t,i=t;e.options.lineWrapping||(n=t.ch?ce(t.line,t.ch-1):t,i=ce(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:i,margin:e.options.cursorScrollMargin,isCursor:!0}}function zn(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=Ct(e,t.from),i=Ct(e,t.to),r=On(e,Math.min(n.left,i.left),Math.min(n.top,i.top)-t.margin,Math.max(n.right,i.right),Math.max(n.bottom,i.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function Pn(e,t,n,i){var r,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?r=Je(e,t):n="prev");var l=e.options.tabSize,s=fr(o,t),a=Jr(s.text,null,l);s.stateAfter&&(s.stateAfter=null);var c,u=s.text.match(/^\s*/)[0];if(i||/\S/.test(s.text)){if("smart"==n&&((c=o.mode.indent(r,s.text.slice(u.length),s.text))==Kr||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?Jr(fr(o,t-1).text,null,l):0:"add"==n?c=a+e.options.indentUnit:"subtract"==n?c=a-e.options.indentUnit:"number"==typeof n&&(c=a+n),c=Math.max(0,c);var d="",f=0;if(e.options.indentWithTabs)for(var h=Math.floor(c/l);h;--h)f+=l,d+="\t";if(f<c&&(d+=no(c-f)),d!=u)return Dn(o,d,ce(t,0),ce(t,u.length),"+input"),s.stateAfter=null,!0;for(h=0;h<o.sel.ranges.length;h++){var p=o.sel.ranges[h];if(p.head.line==t&&p.head.ch<u.length){ze(o,h,new _e(f=ce(t,u.length),f));break}}}function Bn(e,t,n,i){var r=t,o=t;return"number"==typeof t?o=fr(e,Ne(e,t)):r=mr(t),null==r?null:(i(o,r)&&e.cm&&Xt(e.cm,r,n),o)}function Rn(e,t){for(var n=e.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var o=t(n[r]);i.length&&ue(o.from,io(i).to)<=0;){var l=i.pop();if(ue(l.from,o.from)<0){o.from=l.from;break}}i.push(o)}Bt(e,function(){for(var t=i.length-1;t>=0;t--)Dn(e.doc,"",i[t].from,i[t].to,"+delete");Hn(e)})}function Fn(e,t,n,i,r){var o=t.line,l=t.ch,s=n,a=fr(e,o),c=!0;function u(t){var i,s=(r?Zo:Qo)(a,l,n,!0);if(null==s){if(t||!((i=o+n)<e.first||i>=e.first+e.size?c=!1:(o=i,a=fr(e,i))))return c=!1;l=r?(n<0?jo:Vo)(a):n<0?a.text.length:0}else l=s;return!0}if("char"==i)u();else if("column"==i)u(!0);else if("word"==i||"group"==i)for(var d=null,f="group"==i,h=e.cm&&e.cm.getHelper(t,"wordChars"),p=!0;!(n<0)||u(!p);p=!1){var g=a.text.charAt(l)||"\n",m=po(g,h)?"w":f&&"\n"==g?"n":!f||/\s/.test(g)?null:"p";if(!f||p||m||(m="s"),d&&d!=m){n<0&&(n=1,u());break}if(m&&(d=m),n>0&&!u(!p))break}var v=je(e,ce(o,l),s,!0);return c||(v.hitSide=!0),v}function Un(e,t,n,i){var r,o=e.doc,l=t.left;if("page"==i){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=t.top+n*(s-(n<0?1.5:.5)*Tt(e.display))}else"line"==i&&(r=n>0?t.bottom+3:t.top-3);for(;;){var a=kt(e,l,r);if(!a.outside)break;if(n<0?r<=0:r>=o.height){a.hitSide=!0;break}r+=5*n}return a}x.prototype={constructor:x,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,i=n[e];n[e]==t&&"mode"!=e||(n[e]=t,Vn.hasOwnProperty(e)&&Rt(this,Vn[e])(this,t,i))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](li(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Ft(function(e,t){var n=e.token?e:x.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:e,opaque:t&&t.opaque}),this.state.modeGen++,jt(this)}),removeOverlay:Ft(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var i=t[n].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(n,1),this.state.modeGen++,void jt(this)}}),indentLine:Ft(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),De(this.doc,e)&&Pn(this,e,t,n)}),indentSelection:Ft(function(e){for(var t=this.doc.sel.ranges,n=-1,i=0;i<t.length;i++){var r=t[i];if(r.empty())r.head.line>n&&(Pn(this,r.head.line,e,!0),n=r.head.line,i==this.doc.sel.primIndex&&Hn(this));else{var o=r.from(),l=r.to(),s=Math.max(n,o.line);n=Math.min(this.lastLine(),l.line-(l.ch?0:1))+1;for(var a=s;a<n;++a)Pn(this,a,e);var c=this.doc.sel.ranges;0==o.ch&&t.length==c.length&&c[i].from().ch>0&&ze(this.doc,i,new _e(o,c[i].to()),qr)}}}),getTokenAt:function(e,t){return Ui(this,e,t)},getLineTokens:function(e,t){return Ui(this,ce(e),t,!0)},getTokenTypeAt:function(e){e=We(this.doc,e);var t,n=ji(this,fr(this.doc,e.line)),i=0,r=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var l=i+r>>1;if((l?n[2*l-1]:0)>=o)r=l;else{if(!(n[2*l+1]<o)){t=n[2*l+2];break}i=l+1}}var s=t?t.indexOf("cm-overlay "):-1;return s<0?t:0==s?null:t.slice(0,s-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?x.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!Zn.hasOwnProperty(t))return n;var i=Zn[t],r=this.getModeAt(e);if("string"==typeof r[t])i[r[t]]&&n.push(i[r[t]]);else if(r[t])for(var o=0;o<r[t].length;o++){var l=i[r[t][o]];l&&n.push(l)}else r.helperType&&i[r.helperType]?n.push(i[r.helperType]):i[r.name]&&n.push(i[r.name]);for(o=0;o<i._global.length;o++){var s=i._global[o];s.pred(r,this)&&-1==oo(n,s.val)&&n.push(s.val)}return n},getStateAfter:function(e,t){var n=this.doc;return Je(this,(e=Ne(n,null==e?n.first+n.size-1:e))+1,t)},cursorCoords:function(e,t){var n=this.doc.sel.primary();return Lt(this,null==e?n.head:"object"==typeof e?We(this.doc,e):e?n.from():n.to(),t||"page")},charCoords:function(e,t){return xt(this,We(this.doc,e),t||"page")},coordsChar:function(e,t){return kt(this,(e=bt(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=bt(this,{top:e,left:0},t||"page").top,vr(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n,i=!1;if("number"==typeof e){var r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,i=!0),n=fr(this.doc,e)}else n=e;return wt(this,n,{top:0,left:0},t||"page").top+(i?this.doc.height-yr(n):0)},defaultTextHeight:function(){return Tt(this.display)},defaultCharWidth:function(){return _t(this.display)},setGutterMarker:Ft(function(e,t,n){return Bn(this.doc,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&go(i)&&(e.gutterMarkers=null),!0})}),clearGutter:Ft(function(e){var t=this,n=t.doc,i=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,Xt(t,i,"gutter"),go(n.gutterMarkers)&&(n.gutterMarkers=null)),++i})}),lineInfo:function(e){if("number"==typeof e){if(!De(this.doc,e))return null;var t=e;if(!(e=fr(this.doc,e)))return null}else{if(null==(t=mr(e)))return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var o,l,s,a,c,u,d=this.display,f=(e=Lt(this,We(this.doc,e))).bottom,h=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),d.sizer.appendChild(t),"over"==i)f=e.top;else if("above"==i||"near"==i){var p=Math.max(d.wrapper.clientHeight,this.doc.height),g=Math.max(d.sizer.clientWidth,d.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>p)&&e.top>t.offsetHeight?f=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=p&&(f=e.bottom),h+t.offsetWidth>g&&(h=g-t.offsetWidth)}t.style.top=f+"px",t.style.left=t.style.right="","right"==r?(h=d.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?h=0:"middle"==r&&(h=(d.sizer.clientWidth-t.offsetWidth)/2),t.style.left=h+"px"),n&&(o=this,l=h,s=f,a=h+t.offsetWidth,c=f+t.offsetHeight,null!=(u=On(o,l,s,a,c)).scrollTop&&ln(o,u.scrollTop),null!=u.scrollLeft&&sn(o,u.scrollLeft))},triggerOnKeyDown:Ft(vn),triggerOnKeyPress:Ft(wn),triggerOnKeyUp:yn,execCommand:function(e){if(ei.hasOwnProperty(e))return ei[e](this)},findPosH:function(e,t,n,i){var r=1;t<0&&(r=-1,t=-t);for(var o=0,l=We(this.doc,e);o<t&&!(l=Fn(this.doc,l,r,n,i)).hitSide;++o);return l},moveH:Ft(function(e,t){var n=this;n.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?Fn(n.doc,i.head,e,t,n.options.rtlMoveVisually):e<0?i.from():i.to()},Zr)}),deleteH:Ft(function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):Rn(this,function(n){var r=Fn(i,n.head,e,t,!1);return e<0?{from:r,to:n.head}:{from:n.head,to:r}})}),findPosV:function(e,t,n,i){var r=1,o=i;t<0&&(r=-1,t=-t);for(var l=0,s=We(this.doc,e);l<t;++l){var a=Lt(this,s,"div");if(null==o?o=a.left:a.left=o,(s=Un(this,a,r,n)).hitSide)break}return s},moveV:Ft(function(e,t){var n=this,i=this.doc,r=[],o=!n.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(l){if(o)return e<0?l.from():l.to();var s=Lt(n,l.head,"div");null!=l.goalColumn&&(s.left=l.goalColumn),r.push(s.left);var a=Un(n,s,e,t);return"page"==t&&l==i.sel.primary()&&In(n,null,xt(n,a,"div").top-s.top),a},Zr),r.length)for(var l=0;l<i.sel.ranges.length;l++)i.sel.ranges[l].goalColumn=r[l]}),findWordAt:function(e){var t=fr(this.doc,e.line).text,n=e.ch,i=e.ch;if(t){var r=this.getHelper(e,"wordChars");(e.xRel<0||i==t.length)&&n?--n:++i;for(var o=t.charAt(n),l=po(o,r)?function(e){return po(e,r)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!po(e)};n>0&&l(t.charAt(n-1));)--n;for(;i<t.length&&l(t.charAt(i));)++i}return new _e(ce(e.line,n),ce(e.line,i))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Eo(this.display.cursorDiv,"CodeMirror-overwrite"):ko(this.display.cursorDiv,"CodeMirror-overwrite"),Br(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Co()},scrollTo:Ft(function(e,t){null==e&&null==t||zn(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-it(this)-this.display.barHeight,width:e.scrollWidth-it(this)-this.display.barWidth,clientHeight:ot(this),clientWidth:rt(this)}},scrollIntoView:Ft(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:ce(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)zn(this),this.curOp.scrollToPos=e;else{var n=On(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:Ft(function(e,t){var n=this;function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}null!=e&&(n.display.wrapper.style.width=i(e)),null!=t&&(n.display.wrapper.style.height=i(t)),n.options.lineWrapping&&gt(this);var r=n.display.viewFrom;n.doc.iter(r,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Xt(n,r,"widget");break}++r}),n.curOp.forceUpdate=!0,Br(n,"refresh",this)}),operation:function(e){return Bt(this,e)},refresh:Ft(function(){var e=this.display.cachedTextHeight;jt(this),this.curOp.forceUpdate=!0,mt(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),M(this),(null==e||Math.abs(e-Tt(this.display))>.5)&&k(this),Br(this,"refresh",this)}),swapDoc:Ft(function(e){var t=this.doc;return t.cm=null,dr(this,e),mt(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,Fr(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Xr(x);var Gn=x.defaults={},Vn=x.optionHandlers={};function jn(e,t,n,i){x.defaults[e]=t,n&&(Vn[e]=i?function(e,t,i){i!=Xn&&n(e,t,i)}:n)}var Xn=x.Init={toString:function(){return"CodeMirror.Init"}};jn("value","",function(e,t){e.setValue(t)},!0),jn("mode",null,function(e,t){e.doc.modeOption=t,L(e)},!0),jn("indentUnit",2,L,!0),jn("indentWithTabs",!1),jn("smartIndent",!0),jn("tabSize",4,function(e){C(e),mt(e),jt(e)},!0),jn("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=x.Init&&e.refresh()}),jn("specialCharPlaceholder",function(e){var t=wo("span","","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t},function(e){e.refresh()},!0),jn("electricChars",!0),jn("inputStyle",h?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),jn("rtlMoveVisually",!g),jn("wholeLineUpdateBefore",!0),jn("theme","default",function(e){E(e),T(e)},!0),jn("keyMap","default",function(e,t,n){var i=li(t),r=n!=x.Init&&li(n);r&&r.detach&&r.detach(e,i),i.attach&&i.attach(e,r||null)}),jn("extraKeys",null),jn("lineWrapping",!1,function(e){e.options.lineWrapping?(Eo(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(ko(e.display.wrapper,"CodeMirror-wrap"),N(e)),k(e),jt(e),mt(e),setTimeout(function(){z(e)},100)},!0),jn("gutters",[],function(e){W(e.options),T(e)},!0),jn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?G(e.display)+"px":"0",e.refresh()},!0),jn("coverGutterNextToScrollbar",!1,function(e){z(e)},!0),jn("scrollbarStyle","native",function(e){H(e),z(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),jn("lineNumbers",!1,function(e){W(e.options),T(e)},!0),jn("firstLineNumber",1,T,!0),jn("lineNumberFormatter",function(e){return e},T,!0),jn("showCursorWhenSelecting",!1,Xe,!0),jn("resetSelectionOnContextMenu",!0),jn("lineWiseCopyCut",!0),jn("readOnly",!1,function(e,t){"nocursor"==t?(xn(e),e.display.input.blur(),e.display.disabled=!0):(e.display.disabled=!1,t||e.display.input.reset())}),jn("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),jn("dragDrop",!0,function(e,t,n){if(!t!=!(n&&n!=x.Init)){var i=e.display.dragFunctions,r=t?zr:Pr;r(e.display.scroller,"dragstart",i.start),r(e.display.scroller,"dragenter",i.simple),r(e.display.scroller,"dragover",i.simple),r(e.display.scroller,"drop",i.drop)}}),jn("cursorBlinkRate",530),jn("cursorScrollMargin",0),jn("cursorHeight",1,Xe,!0),jn("singleCursorHeightPerLine",!0,Xe,!0),jn("workTime",100),jn("workDelay",100),jn("flattenSpans",!0,C,!0),jn("addModeClass",!1,C,!0),jn("pollInterval",100),jn("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),jn("historyEventDelay",1250),jn("viewportMargin",10,function(e){e.refresh()},!0),jn("maxHighlightLength",1e4,C,!0),jn("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),jn("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),jn("autofocus",null);var Yn=x.modes={},Kn=x.mimeModes={};x.defineMode=function(e,t){x.defaults.mode||"null"==e||(x.defaults.mode=e),arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Yn[e]=t},x.defineMIME=function(e,t){Kn[e]=t},x.resolveMode=function(e){if("string"==typeof e&&Kn.hasOwnProperty(e))e=Kn[e];else if(e&&"string"==typeof e.name&&Kn.hasOwnProperty(e.name)){var t=Kn[e.name];"string"==typeof t&&(t={name:t}),(e=ao(t,e)).name=t.name}else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return x.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},x.getMode=function(e,t){t=x.resolveMode(t);var n=Yn[t.name];if(!n)return x.getMode(e,"text/plain");var i=n(e,t);if(qn.hasOwnProperty(t.name)){var r=qn[t.name];for(var o in r)r.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=r[o])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(var o in t.modeProps)i[o]=t.modeProps[o];return i},x.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),x.defineMIME("text/plain","null");var qn=x.modeExtensions={};x.extendMode=function(e,t){co(t,qn.hasOwnProperty(e)?qn[e]:qn[e]={})},x.defineExtension=function(e,t){x.prototype[e]=t},x.defineDocExtension=function(e,t){sr.prototype[e]=t},x.defineOption=jn;var $n=[];x.defineInitHook=function(e){$n.push(e)};var Zn=x.helpers={};x.registerHelper=function(e,t,n){Zn.hasOwnProperty(e)||(Zn[e]=x[e]={_global:[]}),Zn[e][t]=n},x.registerGlobalHelper=function(e,t,n,i){x.registerHelper(e,t,i),Zn[e]._global.push({pred:n,val:i})};var Qn=x.copyState=function(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var r=t[i];r instanceof Array&&(r=r.concat([])),n[i]=r}return n},Jn=x.startState=function(e,t,n){return!e.startState||e.startState(t,n)};x.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var ei=x.commands={selectAll:function(e){e.setSelection(ce(e.firstLine(),0),ce(e.lastLine()),qr)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),qr)},killLine:function(e){Rn(e,function(t){if(t.empty()){var n=fr(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:ce(t.head.line+1,0)}:{from:t.head,to:ce(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){Rn(e,function(t){return{from:ce(t.from().line,0),to:We(e.doc,ce(t.to().line+1,0))}})},delLineLeft:function(e){Rn(e,function(e){return{from:ce(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){Rn(e,function(t){var n=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:n},"div"),to:t.from()}})},delWrappedLineRight:function(e){Rn(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(ce(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(ce(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return Xo(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return Yo(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return function(e,t){var n,i=fr(e.doc,t);for(;n=Ti(i);)i=n.find(1,!0).line,t=null;var r=wr(i),o=r?r[0].level%2?Vo(i):jo(i):i.text.length;return ce(null==t?mr(i):t,o)}(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},Zr)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},Zr)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?Yo(e,t.head):i},Zr)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var o=n[r].from(),l=Jr(e.getLine(o.line),o.ch,i);t.push(new Array(i-l%i+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){Bt(e,function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var r=t[i].head,o=fr(e.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new ce(r.line,r.ch-1)),r.ch>0)r=new ce(r.line,r.ch+1),e.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),ce(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var l=fr(e.doc,r.line-1).text;l&&e.replaceRange(o.charAt(0)+"\n"+l.charAt(l.length-1),ce(r.line-1,l.length-1),ce(r.line,1),"+transpose")}n.push(new _e(r,r))}e.setSelections(n)})},newlineAndIndent:function(e){Bt(e,function(){for(var t=e.listSelections().length,n=0;n<t;n++){var i=e.listSelections()[n];e.replaceRange("\n",i.anchor,i.head,"+input"),e.indentLine(i.from().line+1,null,!0),Hn(e)}})},toggleOverwrite:function(e){e.toggleOverwrite()}},ti=x.keyMap={};function ni(e){for(var t,n,i,r,o=e.split(/-(?!$)/),l=(e=o[o.length-1],0);l<o.length-1;l++){var s=o[l];if(/^(cmd|meta|m)$/i.test(s))r=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)$/i.test(s))throw new Error("Unrecognized modifier name: "+s);i=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}ti.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ti.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ti.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},ti.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ti.default=p?ti.macDefault:ti.pcDefault,x.normalizeKeyMap=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete e[n];continue}for(var r=lo(n.split(" "),ni),o=0;o<r.length;o++){var l,s;o==r.length-1?(s=n,l=i):(s=r.slice(0,o+1).join(" "),l="...");var a=t[s];if(a){if(a!=l)throw new Error("Inconsistent bindings for "+s)}else t[s]=l}delete e[n]}for(var c in t)e[c]=t[c];return e};var ii=x.lookupKey=function(e,t,n,i){var r=(t=li(t)).call?t.call(e,i):t[e];if(!1===r)return"nothing";if("..."===r)return"multi";if(null!=r&&n(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ii(e,t.fallthrough,n,i);for(var o=0;o<t.fallthrough.length;o++){var l=ii(e,t.fallthrough[o],n,i);if(l)return l}}},ri=x.isModifierKey=function(e){var t="string"==typeof e?e:Fo[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},oi=x.keyName=function(e,t){if(a&&34==e.keyCode&&e.char)return!1;var n=Fo[e.keyCode],i=n;return null!=i&&!e.altGraphKey&&(e.altKey&&"Alt"!=n&&(i="Alt-"+i),(v?e.metaKey:e.ctrlKey)&&"Ctrl"!=n&&(i="Ctrl-"+i),(v?e.ctrlKey:e.metaKey)&&"Cmd"!=n&&(i="Cmd-"+i),!t&&e.shiftKey&&"Shift"!=n&&(i="Shift-"+i),i)};function li(e){return"string"==typeof e?ti[e]:e}x.fromTextArea=function(e,t){if((t=t?co(t):{}).value=e.value,!t.tabindex&&e.tabIndex&&(t.tabindex=e.tabIndex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder),null==t.autofocus){var n=Co();t.autofocus=n==e||null!=e.getAttribute("autofocus")&&n==document.body}function i(){e.value=s.getValue()}if(e.form&&(zr(e.form,"submit",i),!t.leaveSubmitMethodAlone)){var r=e.form,o=r.submit;try{var l=r.submit=function(){i(),r.submit=o,r.submit(),r.submit=l}}catch(e){}}t.finishInit=function(t){t.save=i,t.getTextArea=function(){return e},t.toTextArea=function(){t.toTextArea=isNaN,i(),e.parentNode.removeChild(t.getWrapperElement()),e.style.display="",e.form&&(Pr(e.form,"submit",i),"function"==typeof e.form.submit&&(e.form.submit=o))}},e.style.display="none";var s=x(function(t){e.parentNode.insertBefore(t,e.nextSibling)},t);return s};var si=x.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};si.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else n=t&&(e.test?e.test(t):e(t));if(n)return++this.pos,t},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Jr(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Jr(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Jr(this.string,null,this.tabSize)-(this.lineStart?Jr(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}var r=function(e){return n?e.toLowerCase():e};if(r(this.string.substr(this.pos,e.length))==r(e))return!1!==t&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var ai=0,ci=x.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ai};Xr(ci),ci.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&Dt(e),jr(this,"clear")){var n=this.find();n&&Fr(this,"clear",n.from,n.to)}for(var i=null,r=null,o=0;o<this.lines.length;++o){var l=this.lines[o],s=gi(l.markedSpans,this);e&&!this.collapsed?Xt(e,mr(l),"text"):e&&(null!=s.to&&(r=mr(l)),null!=s.from&&(i=mr(l))),l.markedSpans=mi(l.markedSpans,s),null==s.from&&this.collapsed&&!Wi(this.doc,l)&&e&&gr(l,Tt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(o=0;o<this.lines.length;++o){var a=Mi(this.lines[o]),c=A(a);c>e.display.maxLineLength&&(e.display.maxLine=a,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&jt(e,i,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Ge(e.doc)),e&&Fr(e,"markerCleared",e,this),t&&Ot(e),this.parent&&this.parent.clear()}},ci.prototype.find=function(e,t){var n,i;null==e&&"bookmark"==this.type&&(e=1);for(var r=0;r<this.lines.length;++r){var o=this.lines[r],l=gi(o.markedSpans,this);if(null!=l.from&&(n=ce(t?o:mr(o),l.from),-1==e))return n;if(null!=l.to&&(i=ce(t?o:mr(o),l.to),1==e))return i}return n&&{from:n,to:i}},ci.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&Bt(n,function(){var i=e.line,r=mr(e.line),o=at(n,r);if(o&&(pt(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!Wi(t.doc,i)&&null!=t.height){var l=t.height;t.height=null;var s=Hi(t)-l;s&&gr(i,i.height+s)}})},ci.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=oo(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},ci.prototype.detachLine=function(e){if(this.lines.splice(oo(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};ai=0;function ui(e,t,n,i,r){if(i&&i.shared)return function(e,t,n,i,r){(i=co(i)).shared=!1;var o=[ui(e,t,n,i,r)],l=o[0],s=i.widgetNode;return ur(e,function(e){s&&(i.widgetNode=s.cloneNode(!0)),o.push(ui(e,We(e,t),We(e,n),i,r));for(var a=0;a<e.linked.length;++a)if(e.linked[a].isParent)return;l=io(o)}),new di(o,l)}(e,t,n,i,r);if(e.cm&&!e.cm.curOp)return Rt(e.cm,ui)(e,t,n,i,r);var o=new ci(e,r),l=ue(t,n);if(i&&co(i,o,!1),l>0||0==l&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=wo("span",[o.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(_i(e,t.line,t,n,o)||t.line!=n.line&&_i(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");b=!0}o.addToHistory&&Cr(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var s,a=t.line,c=e.cm;if(e.iter(a,n.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&Mi(e)==c.display.maxLine&&(s=!0),o.collapsed&&a!=t.line&&gr(e,0),function(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}(e,new pi(o,a==t.line?t.ch:null,a==n.line?n.ch:null)),++a}),o.collapsed&&e.iter(t.line,n.line+1,function(t){Wi(e,t)&&gr(t,0)}),o.clearOnEnter&&zr(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(w=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++ai,o.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),o.collapsed)jt(c,t.line,n.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var u=t.line;u<=n.line;u++)Xt(c,u,"text");o.atomic&&Ge(c.doc),Fr(c,"markerAdded",c,o)}return o}var di=x.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};function fi(e){return e.findMarks(ce(e.first,0),e.clipPos(ce(e.lastLine())),function(e){return e.parent})}function hi(e){for(var t=0;t<e.length;t++){var n=e[t],i=[n.primary.doc];ur(n.primary.doc,function(e){i.push(e)});for(var r=0;r<n.markers.length;r++){var o=n.markers[r];-1==oo(i,o.doc)&&(o.parent=null,n.markers.splice(r--,1))}}}function pi(e,t,n){this.marker=e,this.from=t,this.to=n}function gi(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function mi(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function vi(e,t){if(t.full)return null;var n=De(e,t.from.line)&&fr(e,t.from.line).markedSpans,i=De(e,t.to.line)&&fr(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,o=t.to.ch,l=0==ue(t.from,t.to),s=function(e,t,n){if(e)for(var i,r=0;r<e.length;++r){var o=e[r],l=o.marker;if(null==o.from||(l.inclusiveLeft?o.from<=t:o.from<t)||o.from==t&&"bookmark"==l.type&&(!n||!o.marker.insertLeft)){var s=null==o.to||(l.inclusiveRight?o.to>=t:o.to>t);(i||(i=[])).push(new pi(l,o.from,s?null:o.to))}}return i}(n,r,l),a=function(e,t,n){if(e)for(var i,r=0;r<e.length;++r){var o=e[r],l=o.marker;if(null==o.to||(l.inclusiveRight?o.to>=t:o.to>t)||o.from==t&&"bookmark"==l.type&&(!n||o.marker.insertLeft)){var s=null==o.from||(l.inclusiveLeft?o.from<=t:o.from<t);(i||(i=[])).push(new pi(l,s?null:o.from-t,null==o.to?null:o.to-t))}}return i}(i,o,l),c=1==t.text.length,u=io(t.text).length+(c?r:0);if(s)for(var d=0;d<s.length;++d){if(null==(f=s[d]).to)(h=gi(a,f.marker))?c&&(f.to=null==h.to?null:h.to+u):f.to=r}if(a)for(d=0;d<a.length;++d){var f,h;if(null!=(f=a[d]).to&&(f.to+=u),null==f.from)(h=gi(s,f.marker))||(f.from=u,c&&(s||(s=[])).push(f));else f.from+=u,c&&(s||(s=[])).push(f)}s&&(s=yi(s)),a&&a!=s&&(a=yi(a));var p=[s];if(!c){var g,m=t.text.length-2;if(m>0&&s)for(d=0;d<s.length;++d)null==s[d].to&&(g||(g=[])).push(new pi(s[d].marker,null,null));for(d=0;d<m;++d)p.push(g);p.push(a)}return p}function yi(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function wi(e,t){var n=function(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=0,r=[];i<t.text.length;++i)r.push(Er(n[i]));return r}(e,t),i=vi(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var o=n[r],l=i[r];if(o&&l)e:for(var s=0;s<l.length;++s){for(var a=l[s],c=0;c<o.length;++c)if(o[c].marker==a.marker)continue e;o.push(a)}else l&&(n[r]=l)}return n}function bi(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function xi(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Li(e){return e.inclusiveLeft?-1:0}function Ci(e){return e.inclusiveRight?1:0}function Si(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),o=ue(i.from,r.from)||Li(e)-Li(t);if(o)return-o;var l=ue(i.to,r.to)||Ci(e)-Ci(t);return l||t.id-e.id}function ki(e,t){var n,i=b&&e.markedSpans;if(i)for(var r,o=0;o<i.length;++o)(r=i[o]).marker.collapsed&&null==(t?r.from:r.to)&&(!n||Si(n,r.marker)<0)&&(n=r.marker);return n}function Ei(e){return ki(e,!0)}function Ti(e){return ki(e,!1)}function _i(e,t,n,i,r){var o=fr(e,t),l=b&&o.markedSpans;if(l)for(var s=0;s<l.length;++s){var a=l[s];if(a.marker.collapsed){var c=a.marker.find(0),u=ue(c.from,n)||Li(a.marker)-Li(r),d=ue(c.to,i)||Ci(a.marker)-Ci(r);if(!(u>=0&&d<=0||u<=0&&d>=0)&&(u<=0&&(ue(c.to,n)>0||a.marker.inclusiveRight&&r.inclusiveLeft)||u>=0&&(ue(c.from,i)<0||a.marker.inclusiveLeft&&r.inclusiveRight)))return!0}}}function Mi(e){for(var t;t=Ei(e);)e=t.find(-1,!0).line;return e}function Ai(e,t){var n=fr(e,t),i=Mi(n);return n==i?t:mr(i)}function Ni(e,t){if(t>e.lastLine())return t;var n,i=fr(e,t);if(!Wi(e,i))return t;for(;n=Ti(i);)i=n.find(1,!0).line;return mr(i)+1}function Wi(e,t){var n=b&&t.markedSpans;if(n)for(var i,r=0;r<n.length;++r)if((i=n[r]).marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&Di(e,t,i))return!0}}function Di(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return Di(e,i.line,gi(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r,o=0;o<t.markedSpans.length;++o)if((r=t.markedSpans[o]).marker.collapsed&&!r.marker.widgetNode&&r.from==n.to&&(null==r.to||r.to!=n.from)&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&Di(e,t,r))return!0}Xr(di),di.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Fr(this,"clear")}},di.prototype.find=function(e,t){return this.primary.find(e,t)};var Oi=x.LineWidget=function(e,t,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.doc=e,this.node=t};function Ii(e,t,n){yr(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&In(e,null,n)}function Hi(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Lo(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),xo(t.display.measure,wo("div",[e.node],null,n))}return e.height=e.node.offsetHeight}Xr(Oi),Oi.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,i=mr(n);if(null!=i&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(n.widgets=null);var o=Hi(this);gr(n,Math.max(0,n.height-o)),e&&Bt(e,function(){Ii(e,n,-o),Xt(e,i,"widget")})}},Oi.prototype.changed=function(){var e=this.height,t=this.doc.cm,n=this.line;this.height=null;var i=Hi(this)-e;i&&(gr(n,n.height+i),t&&Bt(t,function(){t.curOp.forceUpdate=!0,Ii(t,n,i)}))};var zi=x.Line=function(e,t,n){this.text=e,xi(this,t),this.height=n?n(this):1};function Pi(e){e.parent=null,bi(e)}function Bi(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+n[2])}return e}function Ri(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){var n=x.innerMode(e,t);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function Fi(e,t,n,i){for(var r=0;r<10;r++){i&&(i[0]=x.innerMode(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}function Ui(e,t,n,i){function r(e){return{start:d.start,end:d.pos,string:d.current(),type:o||null,state:e?Qn(l.mode,u):u}}var o,l=e.doc,s=l.mode;t=We(l,t);var a,c=fr(l,t.line),u=Je(e,t.line,n),d=new si(c.text,e.options.tabSize);for(i&&(a=[]);(i||d.pos<t.ch)&&!d.eol();)d.start=d.pos,o=Fi(s,d,u),i&&a.push(r(!0));return i?a:r()}function Gi(e,t,n,i,r,o,l){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var a,c=0,u=null,d=new si(t,e.options.tabSize),f=e.options.addModeClass&&[null];for(""==t&&Bi(Ri(n,i),o);!d.eol();){if(d.pos>e.options.maxHighlightLength?(s=!1,l&&Xi(e,t,i,d.pos),d.pos=t.length,a=null):a=Bi(Fi(n,d,i,f),o),f){var h=f[0].name;h&&(a="m-"+(a?h+" "+a:h))}if(!s||u!=a){for(;c<d.start;)r(c=Math.min(d.start,c+5e4),u);u=a}d.start=d.pos}for(;c<d.pos;){var p=Math.min(d.pos,c+5e4);r(p,u),c=p}}function Vi(e,t,n,i){var r=[e.state.modeGen],o={};Gi(e,t.text,e.doc.mode,n,function(e,t){r.push(e,t)},o,i);for(var l=0;l<e.state.overlays.length;++l){var s=e.state.overlays[l],a=1,c=0;Gi(e,t.text,s.mode,!0,function(e,t){for(var n=a;c<e;){var i=r[a];i>e&&r.splice(a,1,e,r[a+1],i),a+=2,c=Math.min(e,i)}if(t)if(s.opaque)r.splice(n,a-n,e,"cm-overlay "+t),a=n+2;else for(;n<a;n+=2){var o=r[n+1];r[n+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:r,classes:o.bgClass||o.textClass?o:null}}function ji(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=Vi(e,t,t.stateAfter=Je(e,mr(t)));t.styles=i.styles,i.classes?t.styleClasses=i.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.frontier&&e.doc.frontier++}return t.styles}function Xi(e,t,n,i){var r=e.doc.mode,o=new si(t,e.options.tabSize);for(o.start=o.pos=i||0,""==t&&Ri(r,n);!o.eol()&&o.pos<=e.options.maxHighlightLength;)Fi(r,o,n),o.start=o.pos}Xr(zi),zi.prototype.lineNo=function(){return mr(this)};var Yi={},Ki={};function qi(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?Ki:Yi;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function $i(e,t){var n=wo("span",null,null,o?"padding-right: .1px":null),r={pre:wo("pre",[n]),content:n,col:0,pos:0,cm:e,splitSpaces:(i||o)&&e.getOption("lineWrapping")};t.measure={};for(var l=0;l<=(t.rest?t.rest.length:0);l++){var s,a=l?t.rest[l-1]:t.line;r.pos=0,r.addToken=Zi,Oo(e.display.measure)&&(s=wr(a))&&(r.addToken=Ji(r.addToken,s)),r.map=[],tr(a,r,ji(e,a,t!=e.display.externalMeasured&&mr(a))),a.styleClasses&&(a.styleClasses.bgClass&&(r.bgClass=To(a.styleClasses.bgClass,r.bgClass||"")),a.styleClasses.textClass&&(r.textClass=To(a.styleClasses.textClass,r.textClass||""))),0==r.map.length&&r.map.push(0,0,r.content.appendChild(Do(e.display.measure))),0==l?(t.measure.map=r.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(r.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return o&&/\bcm-tab\b/.test(r.content.lastChild.className)&&(r.content.className="cm-tab-wrap-hack"),Br(e,"renderLine",e,t.line,r.pre),r.pre.className&&(r.textClass=To(r.pre.className,r.textClass||"")),r}function Zi(e,t,n,o,l,s,a){if(t){var c=e.splitSpaces?t.replace(/ {3,}/g,Qi):t,u=e.cm.state.specialChars,d=!1;if(u.test(t)){y=document.createDocumentFragment();for(var f=0;;){u.lastIndex=f;var h=u.exec(t),p=h?h.index-f:t.length-f;if(p){var g=document.createTextNode(c.slice(f,f+p));i&&r<9?y.appendChild(wo("span",[g])):y.appendChild(g),e.map.push(e.pos,e.pos+p,g),e.col+=p,e.pos+=p}if(!h)break;if(f+=p+1,"\t"==h[0]){var m=e.cm.options.tabSize,v=m-e.col%m;(g=y.appendChild(wo("span",no(v),"cm-tab"))).setAttribute("role","presentation"),g.setAttribute("cm-text","\t"),e.col+=v}else{(g=e.cm.options.specialCharPlaceholder(h[0])).setAttribute("cm-text",h[0]),i&&r<9?y.appendChild(wo("span",[g])):y.appendChild(g),e.col+=1}e.map.push(e.pos,e.pos+1,g),e.pos++}}else{e.col+=t.length;var y=document.createTextNode(c);e.map.push(e.pos,e.pos+t.length,y),i&&r<9&&(d=!0),e.pos+=t.length}if(n||o||l||d||a){var w=n||"";o&&(w+=o),l&&(w+=l);var b=wo("span",[y],w,a);return s&&(b.title=s),e.content.appendChild(b)}e.content.appendChild(y)}}function Qi(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":"";return t+=" "}function Ji(e,t){return function(n,i,r,o,l,s,a){r=r?r+" cm-force-border":"cm-force-border";for(var c=n.pos,u=c+i.length;;){for(var d=0;d<t.length;d++){var f=t[d];if(f.to>c&&f.from<=c)break}if(f.to>=u)return e(n,i,r,o,l,s,a);e(n,i.slice(0,f.to-c),r,o,null,s,a),o=null,i=i.slice(f.to-c),c=f.to}}}function er(e,t,n,i){var r=!i&&n.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!i&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",n.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t}function tr(e,t,n){var i=e.markedSpans,r=e.text,o=0;if(i)for(var l,s,a,c,u,d,f,h=r.length,p=0,g=(S=1,""),m=0;;){if(m==p){a=c=u=d=s="",f=null,m=1/0;for(var v=[],y=0;y<i.length;++y){var w=i[y],b=w.marker;"bookmark"==b.type&&w.from==p&&b.widgetNode?v.push(b):w.from<=p&&(null==w.to||w.to>p||b.collapsed&&w.to==p&&w.from==p)?(null!=w.to&&w.to!=p&&m>w.to&&(m=w.to,c=""),b.className&&(a+=" "+b.className),b.css&&(s=b.css),b.startStyle&&w.from==p&&(u+=" "+b.startStyle),b.endStyle&&w.to==m&&(c+=" "+b.endStyle),b.title&&!d&&(d=b.title),b.collapsed&&(!f||Si(f.marker,b)<0)&&(f=w)):w.from>p&&m>w.from&&(m=w.from)}if(f&&(f.from||0)==p){if(er(t,(null==f.to?h+1:f.to)-p,f.marker,null==f.from),null==f.to)return;f.to==p&&(f=!1)}if(!f&&v.length)for(y=0;y<v.length;++y)er(t,0,v[y])}if(p>=h)break;for(var x=Math.min(h,m);;){if(g){var L=p+g.length;if(!f){var C=L>x?g.slice(0,x-p):g;t.addToken(t,C,l?l+a:a,u,p+C.length==m?c:"",d,s)}if(L>=x){g=g.slice(x-p),p=x;break}p=L,u=""}g=r.slice(o,o=n[S++]),l=qi(n[S++],t.cm.options)}}else for(var S=1;S<n.length;S+=2)t.addToken(t,r.slice(o,o=n[S]),qi(n[S+1],t.cm.options))}function nr(e,t){return 0==t.from.ch&&0==t.to.ch&&""==io(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function ir(e,t,n,i){function r(e){return n?n[e]:null}function o(e,n,r){!function(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),bi(e),xi(e,n);var r=i?i(e):1;r!=e.height&&gr(e,r)}(e,n,r,i),Fr(e,"change",e,t)}function l(e,t){for(var n=e,o=[];n<t;++n)o.push(new zi(c[n],r(n),i));return o}var s=t.from,a=t.to,c=t.text,u=fr(e,s.line),d=fr(e,a.line),f=io(c),h=r(c.length-1),p=a.line-s.line;if(t.full)e.insert(0,l(0,c.length)),e.remove(c.length,e.size-c.length);else if(nr(e,t)){var g=l(0,c.length-1);o(d,d.text,h),p&&e.remove(s.line,p),g.length&&e.insert(s.line,g)}else if(u==d){if(1==c.length)o(u,u.text.slice(0,s.ch)+f+u.text.slice(a.ch),h);else(g=l(1,c.length-1)).push(new zi(f+u.text.slice(a.ch),h,i)),o(u,u.text.slice(0,s.ch)+c[0],r(0)),e.insert(s.line+1,g)}else if(1==c.length)o(u,u.text.slice(0,s.ch)+c[0]+d.text.slice(a.ch),r(0)),e.remove(s.line+1,p);else{o(u,u.text.slice(0,s.ch)+c[0],r(0)),o(d,f+d.text.slice(a.ch),h);g=l(1,c.length-1);p>1&&e.remove(s.line+1,p-1),e.insert(s.line+1,g)}Fr(e,"change",e,t)}function rr(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function or(e){this.children=e;for(var t=0,n=0,i=0;i<e.length;++i){var r=e[i];t+=r.chunkSize(),n+=r.height,r.parent=this}this.size=t,this.height=n,this.parent=null}rr.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,i=e+t;n<i;++n){var r=this.lines[n];this.height-=r.height,Pi(r),Fr(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,n){for(var i=e+t;e<i;++e)if(n(this.lines[e]))return!0}},or.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var i=this.children[n],r=i.chunkSize();if(e<r){var o=Math.min(t,r-e),l=i.height;if(i.removeInner(e,o),this.height-=l-i.height,r==o&&(this.children.splice(n--,1),i.parent=null),0==(t-=o))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof rr))){var s=[];this.collapse(s),this.children=[new rr(s)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(e<=o){if(r.insertInner(e,t,n),r.lines&&r.lines.length>50){for(;r.lines.length>50;){var l=new rr(r.lines.splice(r.lines.length-25,25));r.height-=l.height,this.children.splice(i+1,0,l),l.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new or(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var n=oo(e.parent.children,e);e.parent.children.splice(n+1,0,t)}else{var i=new or(e.children);i.parent=e,e.children=[i,t],e=i}t.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(e<o){var l=Math.min(t,o-e);if(r.iterN(e,l,n))return!0;if(0==(t-=l))break;e=0}else e-=o}}};var lr=0,sr=x.Doc=function(e,t,n){if(!(this instanceof sr))return new sr(e,t,n);null==n&&(n=0),or.call(this,[new rr([new zi("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var i=ce(n,0);this.sel=Ae(i),this.history=new br(null),this.id=++lr,this.modeOption=t,"string"==typeof e&&(e=Ho(e)),ir(this,{from:i,to:i,text:e}),Re(this,Ae(i),qr)};sr.prototype=ao(or.prototype,{constructor:sr,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=pr(this,this.first,this.first+this.size);return!1===e?t:t.join(e||"\n")},setValue:Ut(function(e){var t=ce(this.first,0),n=this.first+this.size-1;_n(this,{from:t,to:ce(n,fr(this,n).text.length),text:Ho(e),origin:"setValue",full:!0},!0),Re(this,Ae(t))}),replaceRange:function(e,t,n,i){Dn(this,e,t=We(this,t),n=n?We(this,n):t,i)},getRange:function(e,t,n){var i=hr(this,We(this,e),We(this,t));return!1===n?i:i.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(De(this,e))return fr(this,e)},getLineNumber:function(e){return mr(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=fr(this,e)),Mi(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return We(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ut(function(e,t,n){Pe(this,We(this,"number"==typeof e?ce(e,t||0):e),null,n)}),setSelection:Ut(function(e,t,n){Pe(this,We(this,e),We(this,t||e),n)}),extendSelection:Ut(function(e,t,n){Ie(this,We(this,e),t&&We(this,t),n)}),extendSelections:Ut(function(e,t){He(this,function(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=We(e,t[i]);return n}(this,e))}),extendSelectionsBy:Ut(function(e,t){He(this,lo(this.sel.ranges,e),t)}),setSelections:Ut(function(e,t,n){if(e.length){for(var i=0,r=[];i<e.length;i++)r[i]=new _e(We(this,e[i].anchor),We(this,e[i].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Re(this,Me(r,t),n)}}),addSelection:Ut(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new _e(We(this,e),We(this,t||e))),Re(this,Me(i,i.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,i=0;i<n.length;i++){var r=hr(this,n[i].from(),n[i].to());t=t?t.concat(r):r}return!1===e?t:t.join(e||"\n")},getSelections:function(e){for(var t=[],n=this.sel.ranges,i=0;i<n.length;i++){var r=hr(this,n[i].from(),n[i].to());!1!==e&&(r=r.join(e||"\n")),t[i]=r}return t},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:Ut(function(e,t,n){for(var i=[],r=this.sel,o=0;o<r.ranges.length;o++){var l=r.ranges[o];i[o]={from:l.from(),to:l.to(),text:Ho(e[o]),origin:n}}var s=t&&"end"!=t&&function(e,t,n){for(var i=[],r=ce(e.first,0),o=r,l=0;l<t.length;l++){var s=t[l],a=En(s.from,r,o),c=En(Cn(s),r,o);if(r=s.to,o=c,"around"==n){var u=e.sel.ranges[l],d=ue(u.head,u.anchor)<0;i[l]=new _e(d?c:a,d?a:c)}else i[l]=new _e(a,a)}return new Te(i,e.sel.primIndex)}(this,i,t);for(o=i.length-1;o>=0;o--)_n(this,i[o]);s?Be(this,s):this.cm&&Hn(this.cm)}),undo:Ut(function(){An(this,"undo")}),redo:Ut(function(){An(this,"redo")}),undoSelection:Ut(function(){An(this,"undo",!0)}),redoSelection:Ut(function(){An(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new br(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Tr(this.history.done),undone:Tr(this.history.undone)}},setHistory:function(e){var t=this.history=new br(this.history.maxGeneration);t.done=Tr(e.done.slice(0),null,!0),t.undone=Tr(e.undone.slice(0),null,!0)},addLineClass:Ut(function(e,t,n){return Bn(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[i]){if(So(n).test(e[i]))return!1;e[i]+=" "+n}else e[i]=n;return!0})}),removeLineClass:Ut(function(e,t,n){return Bn(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[i];if(!r)return!1;if(null==n)e[i]=null;else{var o=r.match(So(n));if(!o)return!1;var l=o.index+o[0].length;e[i]=r.slice(0,o.index)+(o.index&&l!=r.length?" ":"")+r.slice(l)||null}return!0})}),addLineWidget:Ut(function(e,t,n){return function(e,t,n,i){var r=new Oi(e,n,i),o=e.cm;return o&&r.noHScroll&&(o.display.alignWidgets=!0),Bn(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==r.insertAt?n.push(r):n.splice(Math.min(n.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,o&&!Wi(e,t)){var i=yr(t)<e.scrollTop;gr(t,t.height+Hi(r)),i&&In(o,null,r.height),o.curOp.forceUpdate=!0}return!0}),r}(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return ui(this,We(this,e),We(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return ui(this,e=We(this,e),e,n,"bookmark")},findMarksAt:function(e){var t=[],n=fr(this,(e=We(this,e)).line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=We(this,e),t=We(this,t);var i=[],r=e.line;return this.iter(e.line,t.line+1,function(o){var l=o.markedSpans;if(l)for(var s=0;s<l.length;s++){var a=l[s];r==e.line&&e.ch>a.to||null==a.from&&r!=e.line||r==t.line&&a.from>t.ch||n&&!n(a.marker)||i.push(a.marker.parent||a.marker)}++r}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(i){var r=i.text.length+1;if(r>e)return t=e,!0;e-=r,++n}),We(this,ce(n,t))},indexFromPos:function(e){var t=(e=We(this,e)).ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new sr(pr(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new sr(pr(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),o=e.clipPos(r.from),l=e.clipPos(r.to);if(ue(o,l)){var s=ui(e,o,l,i.primary,i.primary.type);i.markers.push(s),s.parent=i}}}(i,fi(this)),i},unlinkDoc:function(e){if(e instanceof x&&(e=e.doc),this.linked)for(var t=0;t<this.linked.length;++t){if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),hi(fi(this));break}}if(e.history==this.history){var n=[e.id];ur(e,function(e){n.push(e.id)},!0),e.history=new br(null),e.history.done=Tr(this.history.done,n),e.history.undone=Tr(this.history.undone,n)}},iterLinkedDocs:function(e){ur(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),sr.prototype.eachLine=sr.prototype.iter;var ar="iter insert remove copy getEditor".split(" ");for(var cr in sr.prototype)sr.prototype.hasOwnProperty(cr)&&oo(ar,cr)<0&&(x.prototype[cr]=function(e){return function(){return e.apply(this.doc,arguments)}}(sr.prototype[cr]));function ur(e,t,n){!function e(i,r,o){if(i.linked)for(var l=0;l<i.linked.length;++l){var s=i.linked[l];if(s.doc!=r){var a=o&&s.sharedHist;n&&!a||(t(s.doc,a),e(s.doc,i,a))}}}(e,null,!0)}function dr(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,k(e),L(e),e.options.lineWrapping||N(e),e.options.mode=t.modeOption,jt(e)}function fr(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],o=r.chunkSize();if(t<o){n=r;break}t-=o}return n.lines[t]}function hr(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;r==n.line&&(o=o.slice(0,n.ch)),r==t.line&&(o=o.slice(t.ch)),i.push(o),++r}),i}function pr(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function gr(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function mr(e){if(null==e.parent)return null;for(var t=e.parent,n=oo(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function vr(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],o=r.height;if(t<o){e=r;continue e}t-=o,n+=r.chunkSize()}return n}while(!e.lines);for(i=0;i<e.lines.length;++i){var l=e.lines[i].height;if(t<l)break;t-=l}return n+i}function yr(e){for(var t=0,n=(e=Mi(e)).parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var o=n.parent;o;o=(n=o).parent)for(i=0;i<o.children.length;++i){var l=o.children[i];if(l==n)break;t+=l.height}return t}function wr(e){var t=e.order;return null==t&&(t=e.order=Jo(e.text)),t}function br(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function xr(e,t){var n={from:de(t.from),to:Cn(t),text:hr(e,t.from,t.to)};return kr(e,n,t.from.line,t.to.line+1),ur(e,function(e){kr(e,n,t.from.line,t.to.line+1)},!0),n}function Lr(e){for(;e.length;){if(!io(e).ranges)break;e.pop()}}function Cr(e,t,n,i){var r=e.history;r.undone.length=0;var o,l=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>l-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=function(e,t){return t?(Lr(e.done),io(e.done)):e.done.length&&!io(e.done).ranges?io(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),io(e.done)):void 0}(r,r.lastOp==i))){var s=io(o.changes);0==ue(t.from,t.to)&&0==ue(t.from,s.to)?s.to=Cn(t):o.changes.push(xr(e,t))}else{var a=io(r.done);for(a&&a.ranges||Sr(e.sel,r.done),o={changes:[xr(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=l,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,s||Br(e,"historyAdded")}function Sr(e,t){var n=io(t);n&&n.ranges&&n.equals(e)||t.push(e)}function kr(e,t,n,i){var r=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),function(n){n.markedSpans&&((r||(r=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function Er(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function Tr(e,t,n){for(var i=0,r=[];i<e.length;++i){var o=e[i];if(o.ranges)r.push(n?Te.prototype.deepCopy.call(o):o);else{var l=o.changes,s=[];r.push({changes:s});for(var a=0;a<l.length;++a){var c,u=l[a];if(s.push({from:u.from,to:u.to,text:u.text}),t)for(var d in u)(c=d.match(/^spans_(\d+)$/))&&oo(t,Number(c[1]))>-1&&(io(s)[d]=u[d],delete u[d])}}}return r}function _r(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function Mr(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r],l=!0;if(o.ranges){o.copied||((o=e[r]=o.deepCopy()).copied=!0);for(var s=0;s<o.ranges.length;s++)_r(o.ranges[s].anchor,t,n,i),_r(o.ranges[s].head,t,n,i)}else{for(s=0;s<o.changes.length;++s){var a=o.changes[s];if(n<a.from.line)a.from=ce(a.from.line+i,a.from.ch),a.to=ce(a.to.line+i,a.to.ch);else if(t<=a.to.line){l=!1;break}}l||(e.splice(0,r+1),r=0)}}}function Ar(e,t){var n=t.from.line,i=t.to.line,r=t.text.length-(i-n)-1;Mr(e.done,n,i,r),Mr(e.undone,n,i,r)}Xr(sr);var Nr=x.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Wr=x.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0};function Dr(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}var Or=x.e_stop=function(e){Nr(e),Wr(e)};function Ir(e){return e.target||e.srcElement}function Hr(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),p&&e.ctrlKey&&1==t&&(t=3),t}var zr=x.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={});(i[t]||(i[t]=[])).push(n)}},Pr=x.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var i=e._handlers&&e._handlers[t];if(!i)return;for(var r=0;r<i.length;++r)if(i[r]==n){i.splice(r,1);break}}},Br=x.signal=function(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)},Rr=null;function Fr(e,t){var n=e._handlers&&e._handlers[t];if(n){var i,r=Array.prototype.slice.call(arguments,2);Nt?i=Nt.delayedCallbacks:Rr?i=Rr:(i=Rr=[],setTimeout(Ur,0));for(var o=0;o<n.length;++o)i.push(l(n[o]))}function l(e){return function(){e.apply(null,r)}}}function Ur(){var e=Rr;Rr=null;for(var t=0;t<e.length;++t)e[t]()}function Gr(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Br(e,n||t.type,e,t),Dr(t)||t.codemirrorIgnore}function Vr(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==oo(n,t[i])&&n.push(t[i])}function jr(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function Xr(e){e.prototype.on=function(e,t){zr(this,e,t)},e.prototype.off=function(e,t){Pr(this,e,t)}}var Yr=30,Kr=x.Pass={toString:function(){return"CodeMirror.Pass"}},qr={scroll:!1},$r={origin:"*mouse"},Zr={origin:"+move"};function Qr(){this.id=null}Qr.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Jr=x.countColumn=function(e,t,n,i,r){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=i||0,l=r||0;;){var s=e.indexOf("\t",o);if(s<0||s>=t)return l+(t-o);l+=s-o,l+=n-l%n,o=s+1}};function eo(e,t,n){for(var i=0,r=0;;){var o=e.indexOf("\t",i);-1==o&&(o=e.length);var l=o-i;if(o==e.length||r+l>=t)return i+Math.min(l,t-r);if(r+=o-i,i=o+1,(r+=n-r%n)>=t)return i}}var to=[""];function no(e){for(;to.length<=e;)to.push(io(to)+" ");return to[e]}function io(e){return e[e.length-1]}var ro=function(e){e.select()};function oo(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function lo(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function so(){}function ao(e,t){var n;return Object.create?n=Object.create(e):(so.prototype=e,n=new so),t&&co(t,n),n}function co(e,t,n){for(var i in t||(t={}),e)!e.hasOwnProperty(i)||!1===n&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function uo(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}f?ro=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:i&&(ro=function(e){try{e.select()}catch(e){}});var fo=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,ho=x.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||fo.test(e))};function po(e,t){return t?!!(t.source.indexOf("\\w")>-1&&ho(e))||t.test(e):ho(e)}function go(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}var mo,vo=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function yo(e){return e.charCodeAt(0)>=768&&vo.test(e)}function wo(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function bo(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function xo(e,t){return bo(e).appendChild(t)}mo=document.createRange?function(e,t,n,i){var r=document.createRange();return r.setEnd(i||e,n),r.setStart(e,t),r}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(e){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var Lo=x.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)};function Co(){return document.activeElement}function So(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}i&&r<11&&(Co=function(){try{return document.activeElement}catch(e){return document.body}});var ko=x.rmClass=function(e,t){var n=e.className,i=So(t).exec(n);if(i){var r=n.slice(i.index+i[0].length);e.className=n.slice(0,i.index)+(r?i[1]+r:"")}},Eo=x.addClass=function(e,t){var n=e.className;So(t).test(n)||(e.className+=(n?" ":"")+t)};function To(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!So(n[i]).test(t)&&(t+=" "+n[i]);return t}function _o(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&e(i)}}var Mo=!1;var Ao,No,Wo=function(){if(i&&r<9)return!1;var e=wo("div");return"draggable"in e||"dragDrop"in e}();function Do(e){if(null==Ao){var t=wo("span","");xo(e,wo("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ao=t.offsetWidth<=1&&t.offsetHeight>2&&!(i&&r<8))}var n=Ao?wo("span",""):wo("span","",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Oo(e){if(null!=No)return No;var t=xo(e,document.createTextNode("AA")),n=mo(t,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var i=mo(t,1,2).getBoundingClientRect();return No=i.right-n.right<3}var Io,Ho=x.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;t<=i;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),l=o.indexOf("\r");-1!=l?(n.push(o.slice(0,l)),t+=l+1):(n.push(o),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},zo=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Po="oncopy"in(Io=wo("div"))||(Io.setAttribute("oncopy","return;"),"function"==typeof Io.oncopy),Bo=null;var Ro,Fo={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};function Uo(e){return e.level%2?e.to:e.from}function Go(e){return e.level%2?e.from:e.to}function Vo(e){var t=wr(e);return t?Uo(t[0]):0}function jo(e){var t=wr(e);return t?Go(io(t)):e.text.length}function Xo(e,t){var n=fr(e.doc,t),i=Mi(n);i!=n&&(t=mr(i));var r=wr(i),o=r?r[0].level%2?jo(i):Vo(i):0;return ce(t,o)}function Yo(e,t){var n=Xo(e,t.line),i=fr(e.doc,n.line),r=wr(i);if(!r||0==r[0].level){var o=Math.max(0,i.text.search(/\S/)),l=t.line==n.line&&t.ch<=o&&t.ch;return ce(n.line,l?0:o)}return n}function Ko(e,t,n){var i=e[0].level;return t==i||n!=i&&t<n}function qo(e,t){Ro=null;for(var n,i=0;i<e.length;++i){var r=e[i];if(r.from<t&&r.to>t)return i;if(r.from==t||r.to==t){if(null!=n)return Ko(e,r.level,e[n].level)?(r.from!=r.to&&(Ro=n),i):(r.from!=r.to&&(Ro=i),n);n=i}}return n}function $o(e,t,n,i){if(!i)return t+n;do{t+=n}while(t>0&&yo(e.text.charAt(t)));return t}function Zo(e,t,n,i){var r=wr(e);if(!r)return Qo(e,t,n,i);for(var o=qo(r,t),l=r[o],s=$o(e,t,l.level%2?-n:n,i);;){if(s>l.from&&s<l.to)return s;if(s==l.from||s==l.to)return qo(r,s)==o?s:n>0==(l=r[o+=n]).level%2?l.to:l.from;if(!(l=r[o+=n]))return null;s=n>0==l.level%2?$o(e,l.to,-1,i):$o(e,l.from,1,i)}}function Qo(e,t,n,i){var r=t+n;if(i)for(;r>0&&yo(e.text.charAt(r));)r+=n;return r<0||r>e.text.length?null:r}x.keyNames=Fo,function(){for(var e=0;e<10;e++)Fo[e+48]=Fo[e+96]=String(e);for(e=65;e<=90;e++)Fo[e]=String.fromCharCode(e);for(e=1;e<=12;e++)Fo[e+111]=Fo[e+63235]="F"+e}();var Jo=function(){var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",t="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";var n=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,r=/[LRr]/,o=/[Lb1n]/,l=/[1n]/;function s(e,t,n){this.level=e,this.from=t,this.to=n}return function(a){if(!n.test(a))return!1;for(var c,u=a.length,d=[],f=0;f<u;++f)d.push(y=(c=a.charCodeAt(f))<=247?e.charAt(c):1424<=c&&c<=1524?"R":1536<=c&&c<=1773?t.charAt(c-1536):1774<=c&&c<=2220?"r":8192<=c&&c<=8203?"w":8204==c?"b":"L");f=0;for(var h="L";f<u;++f){"m"==(y=d[f])?d[f]=h:h=y}f=0;for(var p="L";f<u;++f){"1"==(y=d[f])&&"r"==p?d[f]="n":r.test(y)&&(p=y,"r"==y&&(d[f]="R"))}for(f=1,h=d[0];f<u-1;++f){"+"==(y=d[f])&&"1"==h&&"1"==d[f+1]?d[f]="1":","!=y||h!=d[f+1]||"1"!=h&&"n"!=h||(d[f]=h),h=y}for(f=0;f<u;++f){if(","==(y=d[f]))d[f]="N";else if("%"==y){for(var g=f+1;g<u&&"%"==d[g];++g);for(var m=f&&"!"==d[f-1]||g<u&&"1"==d[g]?"1":"N",v=f;v<g;++v)d[v]=m;f=g-1}}for(f=0,p="L";f<u;++f){var y=d[f];"L"==p&&"1"==y?d[f]="L":r.test(y)&&(p=y)}for(f=0;f<u;++f)if(i.test(d[f])){for(g=f+1;g<u&&i.test(d[g]);++g);var w="L"==(f?d[f-1]:"L"),b="L"==(g<u?d[g]:"L");for(m=w||b?"L":"R",v=f;v<g;++v)d[v]=m;f=g-1}var x,L=[];for(f=0;f<u;)if(o.test(d[f])){var C=f;for(++f;f<u&&o.test(d[f]);++f);L.push(new s(0,C,f))}else{var S=f,k=L.length;for(++f;f<u&&"L"!=d[f];++f);for(v=S;v<f;)if(l.test(d[v])){S<v&&L.splice(k,0,new s(1,S,v));var E=v;for(++v;v<f&&l.test(d[v]);++v);L.splice(k,0,new s(2,E,v)),S=v}else++v;S<f&&L.splice(k,0,new s(1,S,f))}return 1==L[0].level&&(x=a.match(/^\s+/))&&(L[0].from=x[0].length,L.unshift(new s(0,0,x[0].length))),1==io(L).level&&(x=a.match(/\s+$/))&&(io(L).to-=x[0].length,L.push(new s(0,u-x[0].length,u))),2==L[0].level&&L.unshift(new s(1,L[0].to,L[0].to)),L[0].level!=io(L).level&&L.push(new s(L[0].level,u,u)),L}}();return x.version="5.2.0",x}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var t=e.Pos;function n(e,n,r,o){if(this.atOccurrence=!1,this.doc=e,null==o&&"string"==typeof n&&(o=!1),r=r?e.clipPos(r):t(0,0),this.pos={from:r,to:r},"string"!=typeof n)n.global||(n=new RegExp(n.source,n.ignoreCase?"ig":"g")),this.matches=function(i,r){if(i){n.lastIndex=0;for(var o=e.getLine(r.line).slice(0,r.ch),l=0;;){n.lastIndex=l;var s=n.exec(o);if(!s)break;if(c=(a=s).index,(l=a.index+(a[0].length||1))==o.length)break}(u=a&&a[0].length||0)||(0==c&&0==o.length?a=void 0:c!=e.getLine(r.line).length&&u++)}else{n.lastIndex=r.ch;o=e.getLine(r.line);var a,c,u=(a=n.exec(o))&&a[0].length||0;(c=a&&a.index)+u==o.length||u||(u=1)}if(a&&u)return{from:t(r.line,c),to:t(r.line,c+u),match:a}};else{var l=n;o&&(n=n.toLowerCase());var s=o?function(e){return e.toLowerCase()}:function(e){return e},a=n.split("\n");if(1==a.length)n.length?this.matches=function(r,o){if(r){var a=e.getLine(o.line).slice(0,o.ch);if((u=(c=s(a)).lastIndexOf(n))>-1)return u=i(a,c,u),{from:t(o.line,u),to:t(o.line,u+l.length)}}else{var c,u;a=e.getLine(o.line).slice(o.ch);if((u=(c=s(a)).indexOf(n))>-1)return u=i(a,c,u)+o.ch,{from:t(o.line,u),to:t(o.line,u+l.length)}}}:this.matches=function(){};else{var c=l.split("\n");this.matches=function(n,i){var r=a.length-1;if(n){if(i.line-(a.length-1)<e.firstLine())return;if(s(e.getLine(i.line).slice(0,c[r].length))!=a[a.length-1])return;for(var o=t(i.line,c[r].length),l=i.line-1,u=r-1;u>=1;--u,--l)if(a[u]!=s(e.getLine(l)))return;var d=(f=e.getLine(l)).length-c[0].length;if(s(f.slice(d))!=a[0])return;return{from:t(l,d),to:o}}if(!(i.line+(a.length-1)>e.lastLine())){var f;d=(f=e.getLine(i.line)).length-c[0].length;if(s(f.slice(d))==a[0]){var h=t(i.line,d);for(l=i.line+1,u=1;u<r;++u,++l)if(a[u]!=s(e.getLine(l)))return;if(s(e.getLine(l).slice(0,c[r].length))==a[r])return{from:h,to:t(l,c[r].length)}}}}}}}function i(e,t,n){if(e.length==t.length)return n;for(var i=Math.min(n,e.length);;){var r=e.slice(0,i).toLowerCase().length;if(r<n)++i;else{if(!(r>n))return i;--i}}}n.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){var n=this,i=this.doc.clipPos(e?this.pos.from:this.pos.to);function r(e){var i=t(e,0);return n.pos={from:i,to:i},n.atOccurrence=!1,!1}for(;;){if(this.pos=this.matches(e,i))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!i.line)return r(0);i=t(i.line-1,this.doc.getLine(i.line-1).length)}else{var o=this.doc.lineCount();if(i.line==o-1)return r(o);i=t(i.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(n,i){if(this.atOccurrence){var r=e.splitLines(n);this.doc.replaceRange(r,this.pos.from,this.pos.to,i),this.pos.to=t(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,t,i){return new n(this.doc,e,t,i)}),e.defineDocExtension("getSearchCursor",function(e,t,i){return new n(this,e,t,i)}),e.defineExtension("selectMatches",function(t,n){for(var i=[],r=this.getSearchCursor(t,this.getCursor("from"),n);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)i.push({anchor:r.from(),head:r.to()});i.length&&this.setSelections(i,0)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var t=2,n="matchhighlight",i=100,r=!1;function o(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout),t.timeout=setTimeout(function(){l(e)},t.delay)}function l(e){e.operation(function(){var t=e.state.matchHighlighter;if(t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null),e.somethingSelected()||!t.showToken){var n=e.getCursor("from"),i=e.getCursor("to");if(n.line==i.line&&(!t.wordsOnly||function(e,t,n){if(null!==e.getRange(t,n).match(/^\w+$/)){if(t.ch>0){var i={line:t.line,ch:t.ch-1},r=e.getRange(i,t);if(null===r.match(/\W/))return!1}if(n.ch<e.getLine(t.line).length){var i={line:n.line,ch:n.ch+1},r=e.getRange(n,i);if(null===r.match(/\W/))return!1}return!0}return!1}(e,n,i))){var r=e.getRange(n,i).replace(/^\s+|\s+$/g,"");r.length>=t.minChars&&e.addOverlay(t.overlay=s(r,!1,t.style))}}else{for(var o=!0===t.showToken?/[\w$]/:t.showToken,l=e.getCursor(),a=e.getLine(l.line),c=l.ch,u=c;c&&o.test(a.charAt(c-1));)--c;for(;u<a.length&&o.test(a.charAt(u));)++u;c<u&&e.addOverlay(t.overlay=s(a.slice(c,u),o,t.style))}})}function s(e,t,n){return{token:function(i){if(i.match(e)&&(!t||function(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}(i,t)))return n;i.next(),i.skipTo(e.charAt(0))||i.skipToEnd()}}}e.defineOption("highlightSelectionMatches",!1,function(s,a,c){if(c&&c!=e.Init){var u=s.state.matchHighlighter.overlay;u&&s.removeOverlay(u),clearTimeout(s.state.matchHighlighter.timeout),s.state.matchHighlighter=null,s.off("cursorActivity",o)}a&&(s.state.matchHighlighter=new function(e){"object"==typeof e&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay,this.wordsOnly=e.wordsOnly),null==this.style&&(this.style=n),null==this.minChars&&(this.minChars=t),null==this.delay&&(this.delay=i),null==this.wordsOnly&&(this.wordsOnly=r),this.overlay=this.timeout=null}(a),l(s),s.on("cursorActivity",o))})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){var t={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},n=e.Pos;function i(e,n){return"pairs"==n&&"string"==typeof e?e:"object"==typeof e&&null!=e[n]?e[n]:t[n]}e.defineOption("autoCloseBrackets",!1,function(t,n,i){i&&i!=e.Init&&(t.removeKeyMap(o),t.state.closeBrackets=null),n&&(t.state.closeBrackets=n,t.addKeyMap(o))});for(var r=t.pairs+"`",o={Backspace:function(t){var r=a(t);if(!r||t.getOption("disableInput"))return e.Pass;for(var o=i(r,"pairs"),l=t.listSelections(),s=0;s<l.length;s++){if(!l[s].empty())return e.Pass;var c=u(t,l[s].head);if(!c||o.indexOf(c)%2!=0)return e.Pass}for(var s=l.length-1;s>=0;s--){var d=l[s].head;t.replaceRange("",n(d.line,d.ch-1),n(d.line,d.ch+1))}},Enter:function(t){var n=a(t),r=n&&i(n,"explode");if(!r||t.getOption("disableInput"))return e.Pass;for(var o=t.listSelections(),l=0;l<o.length;l++){if(!o[l].empty())return e.Pass;var s=u(t,o[l].head);if(!s||r.indexOf(s)%2!=0)return e.Pass}t.operation(function(){t.replaceSelection("\n\n",null),t.execCommand("goCharLeft"),o=t.listSelections();for(var e=0;e<o.length;e++){var n=o[e].head.line;t.indentLine(n,null,!0),t.indentLine(n+1,null,!0)}})}},l=0;l<r.length;l++)o["'"+r.charAt(l)+"'"]=s(r.charAt(l));function s(t){return function(r){return function(t,r){var o=a(t);if(!o||t.getOption("disableInput"))return e.Pass;var l=i(o,"pairs"),s=l.indexOf(r);if(-1==s)return e.Pass;for(var u,f=i(o,"triples"),h=l.charAt(s+1)==r,p=t.listSelections(),g=s%2==0,m=0;m<p.length;m++){var v,y=p[m],w=y.head,b=t.getRange(w,n(w.line,w.ch+1));if(g&&!y.empty())v="surround";else if(!h&&g||b!=r)if(h&&w.ch>1&&f.indexOf(r)>=0&&t.getRange(n(w.line,w.ch-2),w)==r+r&&(w.ch<=2||t.getRange(n(w.line,w.ch-3),n(w.line,w.ch-2))!=r))v="addFour";else if(h){if(e.isWordChar(b)||!d(t,w,r))return e.Pass;v="both"}else{if(!g||t.getLine(w.line).length!=w.ch&&!c(b,l)&&!/\s/.test(b))return e.Pass;v="both"}else v=f.indexOf(r)>=0&&t.getRange(w,n(w.line,w.ch+3))==r+r+r?"skipThree":"skip";if(u){if(u!=v)return e.Pass}else u=v}var x=s%2?l.charAt(s-1):r,L=s%2?r:l.charAt(s+1);t.operation(function(){if("skip"==u)t.execCommand("goCharRight");else if("skipThree"==u)for(var e=0;e<3;e++)t.execCommand("goCharRight");else if("surround"==u){for(var n=t.getSelections(),e=0;e<n.length;e++)n[e]=x+n[e]+L;t.replaceSelections(n,"around")}else"both"==u?(t.replaceSelection(x+L,null),t.execCommand("goCharLeft")):"addFour"==u&&(t.replaceSelection(x+x+x+x,"before"),t.execCommand("goCharRight"))})}(r,t)}}function a(e){var t=e.state.closeBrackets;return t?e.getModeAt(e.getCursor()).closeBrackets||t:null}function c(e,t){var n=t.lastIndexOf(e);return n>-1&&n%2==1}function u(e,t){var i=e.getRange(n(t.line,t.ch-1),n(t.line,t.ch+1));return 2==i.length?i:null}function d(t,n,i){var r=t.getLine(n.line),o=t.getTokenAt(n);if(/\bstring2?\b/.test(o.type))return!1;var l=new e.StringStream(r.slice(0,n.ch)+i+r.slice(n.ch),4);for(l.pos=l.start=o.start;;){var s=t.getMode().token(l,o.state);if(l.pos>=n.ch+1)return/\bstring2?\b/.test(s);l.start=l.pos}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){var t=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),n=e.Pos,i={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function r(e,t,r,l){var s=e.getLineHandle(t.line),a=t.ch-1,c=a>=0&&i[s.text.charAt(a)]||i[s.text.charAt(++a)];if(!c)return null;var u=">"==c.charAt(1)?1:-1;if(r&&u>0!=(a==t.ch))return null;var d=e.getTokenTypeAt(n(t.line,a+1)),f=o(e,n(t.line,a+(u>0?1:0)),u,d||null,l);return null==f?null:{from:n(t.line,a),to:f&&f.pos,match:f&&f.ch==c.charAt(0),forward:u>0}}function o(e,t,r,o,l){for(var s=l&&l.maxScanLineLength||1e4,a=l&&l.maxScanLines||1e3,c=[],u=l&&l.bracketRegex?l.bracketRegex:/[(){}[\]]/,d=r>0?Math.min(t.line+a,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-a),f=t.line;f!=d;f+=r){var h=e.getLine(f);if(h){var p=r>0?0:h.length-1,g=r>0?h.length:-1;if(!(h.length>s))for(f==t.line&&(p=t.ch-(r<0?1:0));p!=g;p+=r){var m=h.charAt(p);if(u.test(m)&&(void 0===o||e.getTokenTypeAt(n(f,p+1))==o))if(">"==i[m].charAt(1)==r>0)c.push(m);else{if(!c.length)return{pos:n(f,p),ch:m};c.pop()}}}}return f-r!=(r>0?e.lastLine():e.firstLine())&&null}function l(e,i,o){for(var l=e.state.matchBrackets.maxHighlightLineLength||1e3,s=[],a=e.listSelections(),c=0;c<a.length;c++){var u=a[c].empty()&&r(e,a[c].head,!1,o);if(u&&e.getLine(u.from.line).length<=l){var d=u.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";s.push(e.markText(u.from,n(u.from.line,u.from.ch+1),{className:d})),u.to&&e.getLine(u.to.line).length<=l&&s.push(e.markText(u.to,n(u.to.line,u.to.ch+1),{className:d}))}}if(s.length){t&&e.state.focused&&e.focus();var f=function(){e.operation(function(){for(var e=0;e<s.length;e++)s[e].clear()})};if(!i)return f;setTimeout(f,800)}}var s=null;function a(e){e.operation(function(){s&&(s(),s=null),s=l(e,!1,e.state.matchBrackets)})}e.defineOption("matchBrackets",!1,function(t,n,i){i&&i!=e.Init&&t.off("cursorActivity",a),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",a))}),e.defineExtension("matchBrackets",function(){l(this,!0)}),e.defineExtension("findMatchingBracket",function(e,t,n){return r(this,e,t,n)}),e.defineExtension("scanForBracket",function(e,t,n,i){return o(this,e,t,n,i)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";function t(t,n,i){this.orientation=n,this.scroll=i,this.screen=this.total=this.size=1,this.pos=0,this.node=document.createElement("div"),this.node.className=t+"-"+n,this.inner=this.node.appendChild(document.createElement("div"));var r=this;function o(t){var n=e.wheelEventPixels(t)["horizontal"==r.orientation?"x":"y"],i=r.pos;r.moveTo(r.pos+n),r.pos!=i&&e.e_preventDefault(t)}e.on(this.inner,"mousedown",function(t){if(1==t.which){e.e_preventDefault(t);var n="horizontal"==r.orientation?"pageX":"pageY",i=t[n],o=r.pos;e.on(document,"mousemove",s),e.on(document,"mouseup",l)}function l(){e.off(document,"mousemove",s),e.off(document,"mouseup",l)}function s(e){if(1!=e.which)return l();r.moveTo(o+(e[n]-i)*(r.total/r.size))}}),e.on(this.node,"click",function(t){e.e_preventDefault(t);var n,i=r.inner.getBoundingClientRect();n="horizontal"==r.orientation?t.clientX<i.left?-1:t.clientX>i.right?1:0:t.clientY<i.top?-1:t.clientY>i.bottom?1:0,r.moveTo(r.pos+n*r.screen)}),e.on(this.node,"mousewheel",o),e.on(this.node,"DOMMouseScroll",o)}t.prototype.moveTo=function(e,t){e<0&&(e=0),e>this.total-this.screen&&(e=this.total-this.screen),e!=this.pos&&(this.pos=e,this.inner.style["horizontal"==this.orientation?"left":"top"]=e*(this.size/this.total)+"px",!1!==t&&this.scroll(e,this.orientation))};function n(e,n,i){this.addClass=e,this.horiz=new t(e,"horizontal",i),n(this.horiz.node),this.vert=new t(e,"vertical",i),n(this.vert.node),this.width=null}t.prototype.update=function(e,t,n){this.screen=t,this.total=e,this.size=n;var i=this.screen*(this.size/this.total);i<10&&(this.size-=10-i,i=10),this.inner.style["horizontal"==this.orientation?"width":"height"]=i+"px",this.inner.style["horizontal"==this.orientation?"left":"top"]=this.pos*(this.size/this.total)+"px"},n.prototype.update=function(e){if(null==this.width){var t=window.getComputedStyle?window.getComputedStyle(this.horiz.node):this.horiz.node.currentStyle;t&&(this.width=parseInt(t.height))}var n=this.width||0,i=e.scrollWidth>e.clientWidth+1,r=e.scrollHeight>e.clientHeight+1;return this.vert.node.style.display=r?"block":"none",this.horiz.node.style.display=i?"block":"none",r&&(this.vert.update(e.scrollHeight,e.clientHeight,e.viewHeight-(i?n:0)),this.vert.node.style.display="block",this.vert.node.style.bottom=i?n+"px":"0"),i&&(this.horiz.update(e.scrollWidth,e.clientWidth,e.viewWidth-(r?n:0)-e.barLeft),this.horiz.node.style.right=r?n+"px":"0",this.horiz.node.style.left=e.barLeft+"px"),{right:r?n:0,bottom:i?n:0}},n.prototype.setScrollTop=function(e){this.vert.moveTo(e,!1)},n.prototype.setScrollLeft=function(e){this.horiz.moveTo(e,!1)},n.prototype.clear=function(){var e=this.horiz.node.parentNode;e.removeChild(this.horiz.node),e.removeChild(this.vert.node)},e.scrollbarModel.simple=function(e,t){return new n("CodeMirror-simplescroll",e,t)},e.scrollbarModel.overlay=function(e,t){return new n("CodeMirror-overlayscroll",e,t)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var t="CodeMirror-activeline",n="CodeMirror-activeline-background";function i(e){for(var i=0;i<e.state.activeLines.length;i++)e.removeLineClass(e.state.activeLines[i],"wrap",t),e.removeLineClass(e.state.activeLines[i],"background",n)}function r(e,r){for(var o=[],l=0;l<r.length;l++){var s=r[l];if(s.empty()){var a=e.getLineHandleVisualStart(s.head.line);o[o.length-1]!=a&&o.push(a)}}(function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0})(e.state.activeLines,o)||e.operation(function(){i(e);for(var r=0;r<o.length;r++)e.addLineClass(o[r],"wrap",t),e.addLineClass(o[r],"background",n);e.state.activeLines=o})}function o(e,t){r(e,t.ranges)}e.defineOption("styleActiveLine",!1,function(t,n,l){var s=l&&l!=e.Init;n&&!s?(t.state.activeLines=[],r(t,t.listSelections()),t.on("beforeSelectionChange",o)):!n&&s&&(t.off("beforeSelectionChange",o),i(t),delete t.state.activeLines)})}),CodeMirror.defineMode("glsl",function(e,t){var n,i=e.indentUnit,r=t.keywords||{},o=t.builtins||{},l=t.blockKeywords||{},s=t.atoms||{},a=t.hooks||{},c=t.multiLineStrings,u=/[+\-*&%=<>!?|\/]/;function d(e,t){var i,h=e.next();if(a[h]){var p=a[h](e,t);if(!1!==p)return p}if('"'==h||"'"==h)return t.tokenize=(i=h,function(e,t){for(var n,r=!1,o=!1;null!=(n=e.next());){if(n==i&&!r){o=!0;break}r=!r&&"\\"==n}return(o||!r&&!c)&&(t.tokenize=d),"string"}),t.tokenize(e,t);if(/[\[\]{}\(\),;\:\.]/.test(h))return n=h,"bracket";if(/\d/.test(h))return e.eatWhile(/[\w\.]/),"number";if("/"==h){if(e.eat("*"))return t.tokenize=f,f(e,t);if(e.eat("/"))return e.skipToEnd(),"comment"}if(u.test(h))return e.eatWhile(u),"operator";e.eatWhile(/[\w\$_]/);var g=e.current();return r.propertyIsEnumerable(g)?(l.propertyIsEnumerable(g)&&(n="newstatement"),"keyword"):o.propertyIsEnumerable(g)?"builtin":s.propertyIsEnumerable(g)?"atom":"word"}function f(e,t){for(var n,i=!1;n=e.next();){if("/"==n&&i){t.tokenize=d;break}i="*"==n}return"comment"}function h(e,t,n,i,r){this.indented=e,this.column=t,this.type=n,this.align=i,this.prev=r}function p(e,t,n){return e.context=new h(e.indented,t,n,null,e.context)}function g(e){var t=e.context.type;return")"!=t&&"]"!=t&&"}"!=t||(e.indented=e.context.indented),e.context=e.context.prev}return{startState:function(e){return{tokenize:null,context:new h((e||0)-i,0,"top",!1),indented:0,startOfLine:!0}},token:function(e,t){var i=t.context;if(e.sol()&&(null==i.align&&(i.align=!1),t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace())return null;n=null;var r=(t.tokenize||d)(e,t);if("comment"==r||"meta"==r)return r;if(null==i.align&&(i.align=!0),";"!=n&&":"!=n||"statement"!=i.type)if("{"==n)p(t,e.column(),"}");else if("["==n)p(t,e.column(),"]");else if("("==n)p(t,e.column(),")");else if("}"==n){for(;"statement"==i.type;)i=g(t);for("}"==i.type&&(i=g(t));"statement"==i.type;)i=g(t)}else n==i.type?g(t):("}"==i.type||"top"==i.type||"statement"==i.type&&"newstatement"==n)&&p(t,e.column(),"statement");else g(t);return t.startOfLine=!1,r},indent:function(e,t){if(e.tokenize!=d&&null!=e.tokenize)return 0;var n=t&&t.charAt(0),r=e.context,o=n==r.type;return"statement"==r.type?r.indented+("{"==n?0:i):r.align?r.column+(o?0:1):r.indented+(o?0:i)},electricChars:"{}"}}),function(){function e(e){for(var t={},n=e.split(" "),i=0;i<n.length;++i)t[n[i]]=!0;return t}CodeMirror.defineMIME("text/x-glsl",{name:"glsl",keywords:e("attribute const uniform varying break continue do for while if else in out inout float int void bool true false lowp mediump highp precision invariant discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler2D samplerCube struct gl_FragCoord gl_FragColor"),builtins:e("radians degrees sin cos tan asin acos atan pow exp log exp2 log2 sqrt inversesqrt abs sign floor ceil fract mod min max clamp mix step smoothstep length distance dot cross normalize faceforward reflect refract matrixCompMult lessThan lessThanEqual greaterThan greaterThanEqual equal notEqual any all not dFdx dFdy fwidth texture2D texture2DProj texture2DLod texture2DProjLod textureCube textureCubeLod"),blockKeywords:e("case do else for if switch while struct"),atoms:e("null"),hooks:{"#":function(e,t){return!!t.startOfLine&&(e.skipToEnd(),"meta")}}})}();var FragmentSynth=new function(){"use strict";if(window.performance=window.performance||{},performance.now=performance.now||performance.mozNow||performance.msNow||performance.oNow||performance.webkitNow||function(){return(new Date).getTime()},window.AudioContext=window.AudioContext||window.webkitAudioContext||!1,window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame,window.AudioContext){var e,t,n,i,r,o,l,s,a,c,u,d,f,h,p,g,m,v=document.getElementById("canvas_container"),y=window.innerWidth,w=Math.round(window.innerHeight/2),b=y-1,x=4*w,L=y,C=w,S=[],k=document.getElementById("fail"),E={preserveDrawingBuffer:!0},T=performance.now(),_=document.getElementById("fs_load_indicator"),M=null,A=0,N=.005,W=!0,D=function(e){var t=new Float32Array(4096),n=0,i=2*Math.PI/4096,r=0;for(r=0;r<4096;r+=1)t[r]=Math.sin(n),n+=i;return t}(),O=0,I=0,H=0,z=[],P=[],B=[],R=[],F=[],U=!1,G=function(e,t,n){var i=0,r=0,o=0,l=e/n;for(a=[],i=e;i>=0;i-=1){o=(r=t*Math.pow(2,i/l))/M.sampleRate*4096;var s={freq:r,phase_index:4096*Math.random(),phase_step:o};a.push(s)}},V=function(){var e=0;for(e=0;e<P.length;e+=1)if(!P[e].available)return!1;return!0},j=function(){var e;P.push({worker:new Worker("js/worker/notes_buffer.js"),available:!0}),(e=P[P.length-1]).worker.addEventListener("message",function(t){var n;R.push(new Float32Array(t.data.d)),z.length>0?(n=z.pop(),e.worker.postMessage({score_height:w,data:n.arr.buffer,prev_data:n.prev_arr.buffer},[n.arr.buffer,n.prev_arr.buffer])):(e.available=!0,V()&&(F=R,R=[],U=!0))},!1)},X=function(e,t){var n,i=0;for(i=0;i<P.length;i+=1)if((n=P[i]).available)return n.worker.postMessage({score_height:w,data:e.buffer,prev_data:t.buffer},[e.buffer,t.buffer]),void(n.available=!1);z.push({arr:e,prev_arr:t})},Y=function(e){var t,n,i,r,o,l,s,c=e.outputBuffer,u=c.getChannelData(0),d=c.getChannelData(1),f=u.length,h=0,p=0,g=D,m=B.length,v=1/O;for(r=0;r<f;r+=1){for(h=0,p=0,s=0;s<m;s+=1)for(n=(t=B[s]).length,l=0;l<n;l+=5){var y=t[l],w=t[l+1],b=t[l+2],x=t[l+3],L=t[l+4];o=g[4095&(i=a[y]).phase_index],h+=(w+x*H)*o,p+=(b+L*H)*o,i.phase_index+=i.phase_step,i.phase_index>=4096&&(i.phase_index-=4096)}u[r]=h,d[r]=p,H+=v,(I+=1)>=O&&(H=0,I=0,U&&(B=F,U=!1))}},K=function(){if(!W)return u.disconnect(c),void(W=!0);var e,t,n;(W=!1,M)?u.connect(c):(M=new window.AudioContext,A=M.sampleRate,O=Math.round(1/60*A),e=N,t=M.destination,(n=M.createGain()).gain.value=e,n.connect(t),c=n,G(w,16.34,10),(u=M.createScriptProcessor(0,0,2)).onaudioprocess=Y,u.connect(c),window._fs_sn=u)},q=function(e){k.innerHTML=e},$=function(e,t){if(e&&t){var n=l.createProgram();return l.attachShader(n,e),l.attachShader(n,t),l.linkProgram(n),l.getProgramParameter(n,l.LINK_STATUS)||q("Failed to link program: "+l.getProgramInfoLog(n)),l.deleteShader(e),l.deleteShader(t),n}},Z=function(e,t){var n=l.createShader(e);return l.shaderSource(n,t),l.compileShader(n),l.getShaderParameter(n,l.COMPILE_STATUS)||(q("Failed to compile shader: "+l.getShaderInfoLog(n)),l.deleteShader(n),n=!1),n},Q=function(){_.classList.remove("fs-hide"),l.deleteProgram(s);var n=Z(l.FRAGMENT_SHADER,t.getValue());if(s=$(Z(l.VERTEX_SHADER,document.getElementById("vertex-shader").text),n)){c&&(c.gain.value=N),k.innerHTML="",l.useProgram(s),l.uniform2f(l.getUniformLocation(s,"resolution"),e.width,e.height);var i=l.getAttribLocation(s,"position");l.enableVertexAttribArray(i),l.vertexAttribPointer(i,2,l.FLOAT,!1,0,0),window.cancelAnimationFrame(o),o=window.requestAnimationFrame(J)}else window.cancelAnimationFrame(o),c.gain.value=0;_.classList.add("fs-hide")},J=function(e){var t,n,a=0,c=0;if(l.useProgram(s),l.uniform1f(l.getUniformLocation(s,"globalTime"),(performance.now()-T)/1e3),l.uniform2f(l.getUniformLocation(s,"iMouse"),i,r),l.drawArrays(l.TRIANGLE_STRIP,0,4),V())for(a=0;a<S.length;a+=1)c=(t=S[a]).position,t.prev_data=new Uint8Array(t.data),t.data=new Uint8Array(x),l.readPixels(c,0,1,w,l.RGBA,l.UNSIGNED_BYTE,t.data),n=new Uint8Array(t.data),X(t.data,t.prev_data),t.data=n;o=window.requestAnimationFrame(J)},ee=function(e,t){var n=S[e],i=b*t;n.position_percent=t,n.position=i,n.element.style.left=i+"px"};if(document.addEventListener("mousemove",function(e){e=e||window.event;i=e.pageX/window.innerWidth,r=e.pageY/window.innerHeight}),(e=document.createElement("canvas")).width=L,e.height=C,e.style.width=y+"px",e.style.height=w+"px",v.appendChild(e),!(l=e.getContext("webgl",E)||e.getContext("experimental-webgl",E)))return q("Your browser do not support the WebGL API, needed to run this app."),void document.body.removeChild(e);s=$(Z(l.VERTEX_SHADER,document.getElementById("vertex-shader").text),Z(l.FRAGMENT_SHADER,document.getElementById("fragment-shader").text)),l.viewport(0,0,e.width,e.height),l.useProgram(s),function(){l.bindBuffer(l.ARRAY_BUFFER,l.createBuffer()),l.bufferData(l.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),l.STATIC_DRAW);var e=l.getAttribLocation(s,"position");l.enableVertexAttribArray(e),l.vertexAttribPointer(e,2,l.FLOAT,!1,0,0)}(),l.uniform1f(l.getUniformLocation(s,"globalTime"),T),l.uniform2f(l.getUniformLocation(s,"resolution"),e.width,e.height),WUI_RangeSlider.create("mst_slider",{width:180,height:8,min:0,max:1,step:.005,default_value:N,title:"Gain",title_min_width:80,value_min_width:48,on_change:function(e){N=e,c.gain.value=e}}),d=50,h=e,p=document.createElement("div"),g=document.createElement("div"),p.className="play-position-marker",g.className="play-position-triangle",p.appendChild(g),h.parentElement.insertBefore(p,h),m=p,S.push({element:m,data:new Uint8Array(x),prev_data:new Uint8Array(x),position_percent:d/100,position:b*(d/100)}),f=S.length-1,ee(f,S[f].position_percent),WUI.draggable(m,!0,function(e,t){ee(f,t/window.innerWidth)}),WUI.lockDraggable(m,"y"),j(),j(),WUI_ToolBar.create("toolbar",{allow_groups_minimize:!1},{toolbar:[{text:"convert from Shadertoy",type:"buton",toggle_state:!1,on_click:function(){var e=t.getValue();e=(e=(e=(e=(e=e.replace(/iGlobalTime/g,"globalTime")).replace(/iResolution/g,"resolution")).replace(/void\s+mainImage\s*\(\s*out\s+vec4\s+fragColor\s*,\s*in\s+vec2\s+fragCoord\s*\)/,"void main ()")).replace(/fragCoord/g,"gl_FragCoord")).replace(/fragColor/g,"gl_FragColor"),t.setValue("precision mediump float;\n\nuniform float globalTime;\nuniform vec2 iMouse;\nuniform vec2 resolution;\n\n"+e),Q()}},{text:"play/pause",type:"button",toggle_state:!1,on_click:function(){K()}}]}),t=new CodeMirror(document.getElementById("code"),{value:document.getElementById("fragment-shader").text,theme:"ambiance",matchBrackets:!0,highlightSelectionMatches:{},autoCloseBrackets:!0,lineNumbers:!0,styleActiveLine:!0,scrollbarStyle:"overlay",mode:"text/x-glsl"}),CodeMirror.on(t,"change",function(){clearTimeout(n),n=setTimeout(Q,500)}),o=window.requestAnimationFrame(J),window.addEventListener("resize",function(){y=window.innerWidth,w=Math.round(window.innerHeight/2),b=y-1,x=4*w,G(w,16.34,10)})}else q("Your browser do not support the Web Audio API, needed to run this app.")};